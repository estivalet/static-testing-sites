!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={exports:{},id:i,loaded:!1};return t[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,n.c=e,n.p="",n(0)}([function(t,e,n){(function(t,e,i){function a(t,e,n){try{"object"==typeof _gaq&&_gaq.push(["_trackEvent","JS Exception Error",t,e+" ("+n+")",0,!0]),"function"==typeof window.ga&&ga("send","exception",{exDescription:t,exFatal:!1,nonInteraction:!0})}catch(t){}return!1}n(4),window.onerror=a,n(5);var o=n(6),s=n(7),d=n(10),r=n(11),u=n(12),l=n(13),c=n(14),h=n(15),f=n(27),p=n(29),m=n(35),_=n(38),g=n(39),v=n(42),b=n(53),y=n(59),w=n(63),x=n(21),L=n(64),P=t.View.extend({el:"body",events:{"click .add-to-wishlist":"addToWishlist","click .create-wishlist":"createWishlist","click .wishlist-note":"editNote","click .basket-page button[type=submit], .checkout-page button[type=submit], .checkout-page input[type=submit]":"throttleSubmit","click .item-img-content":"zoomInJacketImage"},$window:null,_components:[],initialize:function(){this.$window=e(window),this.$el.hasClass("js")||this.$el.addClass("js"),this.polyfillStartsWithForIE11(),this.stringLocalizer=window.firstLoadApp.stringLocalizer,this.tags=new d({isMobile:this.isMobile(),stringLocalizer:this.stringLocalizer}),this.basket=new h({el:this.el,app:this,stringLocalizer:this.stringLocalizer}),this.quickViewBookDetails=new f({el:this.el,app:this,stringLocalizer:this.stringLocalizer}),this.wishlist=new p({stringLocalizer:this.stringLocalizer}),this.mode=this.$(".main-content").hasClass("full-width")&&0===this.$(".custom-page").length?"full-width":"two-column",this.initComponents({".carousel-wrap":o,".map-block":s,".block-selector":r,".ratings-credit-wrap":u,".show-more-categories-wrap":l,".checkout-homer":v,".address-validation":b,".tabbed-block-wrap":c,".newsletter-form":m,".address-form":_,".search-wrap":g,".tech-test":y,".tech-help":w}),this.tags.loadAll(),this.processUrlActionParameter(),new L(e(".book-img"))},initComponents:function(t){var e=this;this._components=i.map(t,function(t,n){var i=this.$(n);return i.length?i.map(function(n,i){return new t({el:i,app:e,stringLocalizer:e.stringLocalizer})}):null},this)},polyfillStartsWithForIE11:function(){String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t})},addToWishlist:function(t){t.preventDefault();var n=e(t.currentTarget),i=n.data("isbn");e(t.currentTarget).data("current-wishlist")&&(this.wishlist.current_wishlist=e(t.currentTarget).data("current-wishlist")),this.wishlist.addItem(i,n)},processUrlActionParameter:function(){"addToWishlist"===getUrlParameter("action")&&e(".add-to-wishlist").click()},createWishlist:function(t){t.preventDefault(),this.wishlist.newWishlist()},editNote:function(t){var n=e(t.currentTarget);this.wishlist.editNote(n)},throttleSubmit:function(t){var n=e(t.currentTarget);return!0===n.hasClass("submitted")?(t.preventDefault(),!1):(n.addClass("submitted"),setTimeout(function(){n.removeClass("submitted")},5e3),!0)},scrollTop:function(t){this.isMobile&&(t-=this.headerHeight()),this.$window.scrollTop(t)},headerHeight:function(){return this._headerHeight||(this._headerHeight=this.$(".primary-wrap").height()),this._headerHeight},isMobile:function(){return this.$window.width()<x.sizes.md},zoomInJacketImage:function(){this.isMobile()&&(e("body").hasClass("lightbox-show")||e("body").addClass("lightbox-show"),window.firstLoadApp.counter&&window.firstLoadApp.counter.logMobileJacketLightboxClick())}});try{window.app=new P}catch(t){a(t.stack||t.message,"Bootstrap error",0)}}).call(e,n(1),n(2),n(3))},function(t,e){t.exports=Backbone},function(t,e){t.exports=$},function(t,e,n){(function(e){var n;n=function(){var t="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||Function("return this")()||{},n=Array.prototype,i=Object.prototype,a="undefined"!=typeof Symbol?Symbol.prototype:null,o=n.push,s=n.slice,d=i.toString,r=i.hasOwnProperty,u="undefined"!=typeof ArrayBuffer,l=Array.isArray,c=Object.keys,h=Object.create,f=u&&ArrayBuffer.isView,p=isNaN,m=isFinite,_=!{toString:null}.propertyIsEnumerable("toString"),g=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],v=Math.pow(2,53)-1;function b(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),i=Array(n),a=0;a<n;a++)i[a]=arguments[a+e];switch(e){case 0:return t.call(this,i);case 1:return t.call(this,arguments[0],i);case 2:return t.call(this,arguments[0],arguments[1],i)}var o=Array(e+1);for(a=0;a<e;a++)o[a]=arguments[a];return o[e]=i,t.apply(this,o)}}function y(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function w(t){return!0===t||!1===t||"[object Boolean]"===d.call(t)}function x(t){return function(e){return d.call(e)==="[object "+t+"]"}}var L=x("String"),P=x("Number"),C=x("Date"),S=x("RegExp"),E=x("Error"),k=x("Symbol"),T=x("Map"),I=x("WeakMap"),M=x("Set"),D=x("WeakSet"),A=x("ArrayBuffer"),z=x("DataView"),O=l||x("Array"),B=x("Function"),U=t.document&&t.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof U&&(B=function(t){return"function"==typeof t||!1});var R=B;function N(t,e){return null!=t&&r.call(t,e)}var j=x("Arguments");!function(){j(arguments)||(j=function(t){return N(t,"callee")})}();var $=j;function F(t){return P(t)&&p(t)}function Z(t){return function(){return t}}function W(t){return function(e){var n=t(e);return"number"==typeof n&&n>=0&&n<=v}}function H(t){return function(e){return null==e?void 0:e[t]}}var V=H("byteLength"),G=W(V),q=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var J=u?function(t){return f?f(t)&&!z(t):G(t)&&q.test(d.call(t))}:Z(!1),K=H("length"),Y=W(K);function X(t,e){e=function(t){for(var e={},n=t.length,i=0;i<n;++i)e[t[i]]=!0;return{contains:function(t){return e[t]},push:function(n){return e[n]=!0,t.push(n)}}}(e);var n=g.length,a=t.constructor,o=R(a)&&a.prototype||i,s="constructor";for(N(t,s)&&!e.contains(s)&&e.push(s);n--;)(s=g[n])in t&&t[s]!==o[s]&&!e.contains(s)&&e.push(s)}function Q(t){if(!y(t))return[];if(c)return c(t);var e=[];for(var n in t)N(t,n)&&e.push(n);return _&&X(t,e),e}function tt(t,e){var n=Q(e),i=n.length;if(null==t)return!i;for(var a=Object(t),o=0;o<i;o++){var s=n[o];if(e[s]!==a[s]||!(s in a))return!1}return!0}function et(t){return t instanceof et?t:this instanceof et?void(this._wrapped=t):new et(t)}function nt(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=typeof t;return("function"===o||"object"===o||"object"==typeof e)&&function t(e,n,i,o){e instanceof et&&(e=e._wrapped);n instanceof et&&(n=n._wrapped);var s=d.call(e);if(s!==d.call(n))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!=+e?+n!=+n:0==+e?1/+e==1/n:+e==+n;case"[object Date]":case"[object Boolean]":return+e==+n;case"[object Symbol]":return a.valueOf.call(e)===a.valueOf.call(n);case"[object ArrayBuffer]":return t(new DataView(e),new DataView(n),i,o);case"[object DataView]":var r=V(e);if(r!==V(n))return!1;for(;r--;)if(e.getUint8(r)!==n.getUint8(r))return!1;return!0}if(J(e))return t(new DataView(e.buffer),new DataView(n.buffer),i,o);var u="[object Array]"===s;if(!u){if("object"!=typeof e||"object"!=typeof n)return!1;var l=e.constructor,c=n.constructor;if(l!==c&&!(R(l)&&l instanceof l&&R(c)&&c instanceof c)&&"constructor"in e&&"constructor"in n)return!1}i=i||[];o=o||[];var h=i.length;for(;h--;)if(i[h]===e)return o[h]===n;i.push(e);o.push(n);if(u){if((h=e.length)!==n.length)return!1;for(;h--;)if(!nt(e[h],n[h],i,o))return!1}else{var f,p=Q(e);if(h=p.length,Q(n).length!==h)return!1;for(;h--;)if(f=p[h],!N(n,f)||!nt(e[f],n[f],i,o))return!1}i.pop();o.pop();return!0}(t,e,n,i)}function it(t){if(!y(t))return[];var e=[];for(var n in t)e.push(n);return _&&X(t,e),e}function at(t){for(var e=Q(t),n=e.length,i=Array(n),a=0;a<n;a++)i[a]=t[e[a]];return i}function ot(t){for(var e={},n=Q(t),i=0,a=n.length;i<a;i++)e[t[n[i]]]=n[i];return e}function st(t){var e=[];for(var n in t)R(t[n])&&e.push(n);return e.sort()}function dt(t,e){return function(n){var i=arguments.length;if(e&&(n=Object(n)),i<2||null==n)return n;for(var a=1;a<i;a++)for(var o=arguments[a],s=t(o),d=s.length,r=0;r<d;r++){var u=s[r];e&&void 0!==n[u]||(n[u]=o[u])}return n}}et.VERSION="1.11.0",et.prototype.value=function(){return this._wrapped},et.prototype.valueOf=et.prototype.toJSON=et.prototype.value,et.prototype.toString=function(){return String(this._wrapped)};var rt=dt(it),ut=dt(Q),lt=dt(it,!0);function ct(t){if(!y(t))return{};if(h)return h(t);var e=function(){};e.prototype=t;var n=new e;return e.prototype=null,n}function ht(t){return y(t)?O(t)?t.slice():rt({},t):t}function ft(t){return t}function pt(t){return t=ut({},t),function(e){return tt(e,t)}}function mt(t,e){for(var n=e.length,i=0;i<n;i++){if(null==t)return;t=t[e[i]]}return n?t:void 0}function _t(t){return O(t)?function(e){return mt(e,t)}:H(t)}function gt(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,i,a){return t.call(e,n,i,a)};case 4:return function(n,i,a,o){return t.call(e,n,i,a,o)}}return function(){return t.apply(e,arguments)}}function vt(t,e,n){return null==t?ft:R(t)?gt(t,e,n):y(t)&&!O(t)?pt(t):_t(t)}function bt(t,e){return vt(t,e,1/0)}function yt(t,e,n){return et.iteratee!==bt?et.iteratee(t,e):vt(t,e,n)}function wt(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))}et.iteratee=bt;var xt=Date.now||function(){return(new Date).getTime()};function Lt(t){var e=function(e){return t[e]},n="(?:"+Q(t).join("|")+")",i=RegExp(n),a=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(a,e):t}}var Pt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Ct=Lt(Pt),St=Lt(ot(Pt)),Et=et.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},kt=/(.)^/,Tt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},It=/\\|'|\r|\n|\u2028|\u2029/g;function Mt(t){return"\\"+Tt[t]}var Dt=0;function At(t,e,n,i,a){if(!(i instanceof e))return t.apply(n,a);var o=ct(t.prototype),s=t.apply(o,a);return y(s)?s:o}var zt=b(function(t,e){var n=zt.placeholder,i=function(){for(var a=0,o=e.length,s=Array(o),d=0;d<o;d++)s[d]=e[d]===n?arguments[a++]:e[d];for(;a<arguments.length;)s.push(arguments[a++]);return At(t,i,this,this,s)};return i});zt.placeholder=et;var Ot=b(function(t,e,n){if(!R(t))throw new TypeError("Bind must be called on a function");var i=b(function(a){return At(t,i,e,this,n.concat(a))});return i});function Bt(t,e,n,i){if(i=i||[],e||0===e){if(e<=0)return i.concat(t)}else e=1/0;for(var a=i.length,o=0,s=K(t);o<s;o++){var d=t[o];if(Y(d)&&(O(d)||$(d)))if(e>1)Bt(d,e-1,n,i),a=i.length;else for(var r=0,u=d.length;r<u;)i[a++]=d[r++];else n||(i[a++]=d)}return i}var Ut=b(function(t,e){var n=(e=Bt(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var i=e[n];t[i]=Ot(t[i],t)}return t});var Rt=b(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),Nt=zt(Rt,et,1);function jt(t){return function(){return!t.apply(this,arguments)}}function $t(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}}var Ft=zt($t,2);function Zt(t,e,n){e=yt(e,n);for(var i,a=Q(t),o=0,s=a.length;o<s;o++)if(e(t[i=a[o]],i,t))return i}function Wt(t){return function(e,n,i){n=yt(n,i);for(var a=K(e),o=t>0?0:a-1;o>=0&&o<a;o+=t)if(n(e[o],o,e))return o;return-1}}var Ht=Wt(1),Vt=Wt(-1);function Gt(t,e,n,i){for(var a=(n=yt(n,i,1))(e),o=0,s=K(t);o<s;){var d=Math.floor((o+s)/2);n(t[d])<a?o=d+1:s=d}return o}function qt(t,e,n){return function(i,a,o){var d=0,r=K(i);if("number"==typeof o)t>0?d=o>=0?o:Math.max(o+r,d):r=o>=0?Math.min(o+1,r):o+r+1;else if(n&&o&&r)return i[o=n(i,a)]===a?o:-1;if(a!=a)return(o=e(s.call(i,d,r),F))>=0?o+d:-1;for(o=t>0?d:r-1;o>=0&&o<r;o+=t)if(i[o]===a)return o;return-1}}var Jt=qt(1,Ht,Gt),Kt=qt(-1,Vt);function Yt(t,e,n){var i=(Y(t)?Ht:Zt)(t,e,n);if(void 0!==i&&-1!==i)return t[i]}function Xt(t,e,n){var i,a;if(e=gt(e,n),Y(t))for(i=0,a=t.length;i<a;i++)e(t[i],i,t);else{var o=Q(t);for(i=0,a=o.length;i<a;i++)e(t[o[i]],o[i],t)}return t}function Qt(t,e,n){e=yt(e,n);for(var i=!Y(t)&&Q(t),a=(i||t).length,o=Array(a),s=0;s<a;s++){var d=i?i[s]:s;o[s]=e(t[d],d,t)}return o}function te(t){return function(e,n,i,a){var o=arguments.length>=3;return function(e,n,i,a){var o=!Y(e)&&Q(e),s=(o||e).length,d=t>0?0:s-1;for(a||(i=e[o?o[d]:d],d+=t);d>=0&&d<s;d+=t){var r=o?o[d]:d;i=n(i,e[r],r,e)}return i}(e,gt(n,a,4),i,o)}}var ee=te(1),ne=te(-1);function ie(t,e,n){var i=[];return e=yt(e,n),Xt(t,function(t,n,a){e(t,n,a)&&i.push(t)}),i}function ae(t,e,n){e=yt(e,n);for(var i=!Y(t)&&Q(t),a=(i||t).length,o=0;o<a;o++){var s=i?i[o]:o;if(!e(t[s],s,t))return!1}return!0}function oe(t,e,n){e=yt(e,n);for(var i=!Y(t)&&Q(t),a=(i||t).length,o=0;o<a;o++){var s=i?i[o]:o;if(e(t[s],s,t))return!0}return!1}function se(t,e,n,i){return Y(t)||(t=at(t)),("number"!=typeof n||i)&&(n=0),Jt(t,e,n)>=0}var de=b(function(t,e,n){var i,a;return R(e)?a=e:O(e)&&(i=e.slice(0,-1),e=e[e.length-1]),Qt(t,function(t){var o=a;if(!o){if(i&&i.length&&(t=mt(t,i)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)})});function re(t,e){return Qt(t,_t(e))}function ue(t,e,n){var i,a,o=-1/0,s=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var d=0,r=(t=Y(t)?t:at(t)).length;d<r;d++)null!=(i=t[d])&&i>o&&(o=i);else e=yt(e,n),Xt(t,function(t,n,i){((a=e(t,n,i))>s||a===-1/0&&o===-1/0)&&(o=t,s=a)});return o}function le(t,e,n){if(null==e||n)return Y(t)||(t=at(t)),t[wt(t.length-1)];var i=Y(t)?ht(t):at(t),a=K(i);e=Math.max(Math.min(e,a),0);for(var o=a-1,s=0;s<e;s++){var d=wt(s,o),r=i[s];i[s]=i[d],i[d]=r}return i.slice(0,e)}function ce(t,e){return function(n,i,a){var o=e?[[],[]]:{};return i=yt(i,a),Xt(n,function(e,a){var s=i(e,a,n);t(o,e,s)}),o}}var he=ce(function(t,e,n){N(t,n)?t[n].push(e):t[n]=[e]}),fe=ce(function(t,e,n){t[n]=e}),pe=ce(function(t,e,n){N(t,n)?t[n]++:t[n]=1}),me=ce(function(t,e,n){t[n?0:1].push(e)},!0),_e=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function ge(t,e,n){return e in n}var ve=b(function(t,e){var n={},i=e[0];if(null==t)return n;R(i)?(e.length>1&&(i=gt(i,e[1])),e=it(t)):(i=ge,e=Bt(e,!1,!1),t=Object(t));for(var a=0,o=e.length;a<o;a++){var s=e[a],d=t[s];i(d,s,t)&&(n[s]=d)}return n}),be=b(function(t,e){var n,i=e[0];return R(i)?(i=jt(i),e.length>1&&(n=e[1])):(e=Qt(Bt(e,!1,!1),String),i=function(t,n){return!se(e,n)}),ve(t,i,n)});function ye(t,e,n){return s.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))}function we(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[0]:ye(t,t.length-e)}function xe(t,e,n){return s.call(t,null==e||n?1:e)}var Le=b(function(t,e){return e=Bt(e,!0,!0),ie(t,function(t){return!se(e,t)})}),Pe=b(function(t,e){return Le(t,e)});function Ce(t,e,n,i){w(e)||(i=n,n=e,e=!1),null!=n&&(n=yt(n,i));for(var a=[],o=[],s=0,d=K(t);s<d;s++){var r=t[s],u=n?n(r,s,t):r;e&&!n?(s&&o===u||a.push(r),o=u):n?se(o,u)||(o.push(u),a.push(r)):se(a,r)||a.push(r)}return a}var Se=b(function(t){return Ce(Bt(t,!0,!0))});function Ee(t){for(var e=t&&ue(t,K).length||0,n=Array(e),i=0;i<e;i++)n[i]=re(t,i);return n}var ke=b(Ee);function Te(t,e){return t._chain?et(e).chain():e}function Ie(t){return Xt(st(t),function(e){var n=et[e]=t[e];et.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),Te(this,n.apply(et,t))}}),et}Xt(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];et.prototype[t]=function(){var n=this._wrapped;return null!=n&&(e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0]),Te(this,n)}}),Xt(["concat","join","slice"],function(t){var e=n[t];et.prototype[t]=function(){var t=this._wrapped;return null!=t&&(t=e.apply(t,arguments)),Te(this,t)}});var Me=Ie({__proto__:null,VERSION:"1.11.0",restArguments:b,isObject:y,isNull:function(t){return null===t},isUndefined:function(t){return void 0===t},isBoolean:w,isElement:function(t){return!(!t||1!==t.nodeType)},isString:L,isNumber:P,isDate:C,isRegExp:S,isError:E,isSymbol:k,isMap:T,isWeakMap:I,isSet:M,isWeakSet:D,isArrayBuffer:A,isDataView:z,isArray:O,isFunction:R,isArguments:$,isFinite:function(t){return!k(t)&&m(t)&&!isNaN(parseFloat(t))},isNaN:F,isTypedArray:J,isEmpty:function(t){return null==t||(Y(t)&&(O(t)||L(t)||$(t))?0===t.length:0===Q(t).length)},isMatch:tt,isEqual:function(t,e){return nt(t,e)},keys:Q,allKeys:it,values:at,pairs:function(t){for(var e=Q(t),n=e.length,i=Array(n),a=0;a<n;a++)i[a]=[e[a],t[e[a]]];return i},invert:ot,functions:st,methods:st,extend:rt,extendOwn:ut,assign:ut,defaults:lt,create:function(t,e){var n=ct(t);return e&&ut(n,e),n},clone:ht,tap:function(t,e){return e(t),t},has:function(t,e){if(!O(e))return N(t,e);for(var n=e.length,i=0;i<n;i++){var a=e[i];if(null==t||!r.call(t,a))return!1;t=t[a]}return!!n},mapObject:function(t,e,n){e=yt(e,n);for(var i=Q(t),a=i.length,o={},s=0;s<a;s++){var d=i[s];o[d]=e(t[d],d,t)}return o},identity:ft,constant:Z,noop:function(){},property:_t,propertyOf:function(t){return null==t?function(){}:function(e){return O(e)?mt(t,e):t[e]}},matcher:pt,matches:pt,times:function(t,e,n){var i=Array(Math.max(0,t));e=gt(e,n,1);for(var a=0;a<t;a++)i[a]=e(a);return i},random:wt,now:xt,escape:Ct,unescape:St,templateSettings:Et,template:function(t,e,n){!e&&n&&(e=n),e=lt({},e,et.templateSettings);var i,a=RegExp([(e.escape||kt).source,(e.interpolate||kt).source,(e.evaluate||kt).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(a,function(e,n,i,a,d){return s+=t.slice(o,d).replace(It,Mt),o=d+e.length,n?s+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?s+="'+\n((__t=("+i+"))==null?'':__t)+\n'":a&&(s+="';\n"+a+"\n__p+='"),e}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{i=new Function(e.variable||"obj","_",s)}catch(t){throw t.source=s,t}var d=function(t){return i.call(this,t,et)},r=e.variable||"obj";return d.source="function("+r+"){\n"+s+"}",d},result:function(t,e,n){O(e)||(e=[e]);var i=e.length;if(!i)return R(n)?n.call(t):n;for(var a=0;a<i;a++){var o=null==t?void 0:t[e[a]];void 0===o&&(o=n,a=i),t=R(o)?o.call(t):o}return t},uniqueId:function(t){var e=++Dt+"";return t?t+e:e},chain:function(t){var e=et(t);return e._chain=!0,e},iteratee:bt,partial:zt,bind:Ot,bindAll:Ut,memoize:function(t,e){var n=function(i){var a=n.cache,o=""+(e?e.apply(this,arguments):i);return N(a,o)||(a[o]=t.apply(this,arguments)),a[o]};return n.cache={},n},delay:Rt,defer:Nt,throttle:function(t,e,n){var i,a,o,s,d=0;n||(n={});var r=function(){d=!1===n.leading?0:xt(),i=null,s=t.apply(a,o),i||(a=o=null)},u=function(){var u=xt();d||!1!==n.leading||(d=u);var l=e-(u-d);return a=this,o=arguments,l<=0||l>e?(i&&(clearTimeout(i),i=null),d=u,s=t.apply(a,o),i||(a=o=null)):i||!1===n.trailing||(i=setTimeout(r,l)),s};return u.cancel=function(){clearTimeout(i),d=0,i=a=o=null},u},debounce:function(t,e,n){var i,a,o=function(e,n){i=null,n&&(a=t.apply(e,n))},s=b(function(s){if(i&&clearTimeout(i),n){var d=!i;i=setTimeout(o,e),d&&(a=t.apply(this,s))}else i=Rt(o,e,this,s);return a});return s.cancel=function(){clearTimeout(i),i=null},s},wrap:function(t,e){return zt(e,t)},negate:jt,compose:function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},after:function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},before:$t,once:Ft,findKey:Zt,findIndex:Ht,findLastIndex:Vt,sortedIndex:Gt,indexOf:Jt,lastIndexOf:Kt,find:Yt,detect:Yt,findWhere:function(t,e){return Yt(t,pt(e))},each:Xt,forEach:Xt,map:Qt,collect:Qt,reduce:ee,foldl:ee,inject:ee,reduceRight:ne,foldr:ne,filter:ie,select:ie,reject:function(t,e,n){return ie(t,jt(yt(e)),n)},every:ae,all:ae,some:oe,any:oe,contains:se,includes:se,include:se,invoke:de,pluck:re,where:function(t,e){return ie(t,pt(e))},max:ue,min:function(t,e,n){var i,a,o=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var d=0,r=(t=Y(t)?t:at(t)).length;d<r;d++)null!=(i=t[d])&&i<o&&(o=i);else e=yt(e,n),Xt(t,function(t,n,i){((a=e(t,n,i))<s||a===1/0&&o===1/0)&&(o=t,s=a)});return o},shuffle:function(t){return le(t,1/0)},sample:le,sortBy:function(t,e,n){var i=0;return e=yt(e,n),re(Qt(t,function(t,n,a){return{value:t,index:i++,criteria:e(t,n,a)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return t.index-e.index}),"value")},groupBy:he,indexBy:fe,countBy:pe,partition:me,toArray:function(t){return t?O(t)?s.call(t):L(t)?t.match(_e):Y(t)?Qt(t,ft):at(t):[]},size:function(t){return null==t?0:Y(t)?t.length:Q(t).length},pick:ve,omit:be,first:we,head:we,take:we,initial:ye,last:function(t,e,n){return null==t||t.length<1?null==e||n?void 0:[]:null==e||n?t[t.length-1]:xe(t,Math.max(0,t.length-e))},rest:xe,tail:xe,drop:xe,compact:function(t){return ie(t,Boolean)},flatten:function(t,e){return Bt(t,e,!1)},without:Pe,uniq:Ce,unique:Ce,union:Se,intersection:function(t){for(var e=[],n=arguments.length,i=0,a=K(t);i<a;i++){var o=t[i];if(!se(e,o)){var s;for(s=1;s<n&&se(arguments[s],o);s++);s===n&&e.push(o)}}return e},difference:Le,unzip:Ee,transpose:Ee,zip:ke,object:function(t,e){for(var n={},i=0,a=K(t);i<a;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},range:function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var i=Math.max(Math.ceil((e-t)/n),0),a=Array(i),o=0;o<i;o++,t+=n)a[o]=t;return a},chunk:function(t,e){if(null==e||e<1)return[];for(var n=[],i=0,a=t.length;i<a;)n.push(s.call(t,i,i+=e));return n},mixin:Ie,default:et});return Me._=Me,Me},t.exports=n()}).call(e,function(){return this}())},function(t,e){Array.prototype.map=function(t){if(void 0===this||null===this)throw new TypeError(this+"is not an object");if(!(t instanceof Function))throw new TypeError(t+" is not a function");for(var e=Object(this),n=arguments[1],i=e instanceof String?e.split(""):e,a=Math.max(Math.min(i.length,9007199254740991),0)||0,o=-1,s=[];++o<a;)o in i&&(s[o]=t.call(n,i[o],o,e));return s}},function(t,e,n){var i,a,o,s;
/*!
	 * jQuery-ajaxTransport-XDomainRequest - v1.0.4 - 2015-03-05
	 * https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest
	 * Copyright (c) 2015 Jason Moon (@JSONMOON)
	 * Licensed MIT (/blob/master/LICENSE.txt)
	 */
/*!
	 * jQuery-ajaxTransport-XDomainRequest - v1.0.4 - 2015-03-05
	 * https://github.com/MoonScript/jQuery-ajaxTransport-XDomainRequest
	 * Copyright (c) 2015 Jason Moon (@JSONMOON)
	 * Licensed MIT (/blob/master/LICENSE.txt)
	 */
s=function(t){if(t.support.cors||!t.ajaxTransport||!window.XDomainRequest)return t;var e=/^(https?:)?\/\//i,n=/^get|post$/i,i=new RegExp("^(//|"+location.protocol+")","i");return t.ajaxTransport("* text html xml json",function(a,o,s){if(a.crossDomain&&a.async&&n.test(a.type)&&e.test(a.url)&&i.test(a.url)){var d=null;return{send:function(e,n){var i="",s=(o.dataType||"").toLowerCase();d=new XDomainRequest,/^\d+$/.test(o.timeout)&&(d.timeout=o.timeout),d.ontimeout=function(){n(500,"timeout")},d.onload=function(){var e="Content-Length: "+d.responseText.length+"\r\nContent-Type: "+d.contentType,i={code:200,message:"success"},a={text:d.responseText};try{if("html"===s||/text\/html/i.test(d.contentType))a.html=d.responseText;else if("json"===s||"text"!==s&&/\/json/i.test(d.contentType))try{a.json=t.parseJSON(d.responseText)}catch(t){i.code=500,i.message="parseerror"}else if("xml"===s||"text"!==s&&/\/xml/i.test(d.contentType)){var o=new ActiveXObject("Microsoft.XMLDOM");o.async=!1;try{o.loadXML(d.responseText)}catch(t){o=void 0}if(!o||!o.documentElement||o.getElementsByTagName("parsererror").length)throw i.code=500,i.message="parseerror","Invalid XML: "+d.responseText;a.xml=o}}catch(t){throw t}finally{n(i.code,i.message,a,e)}},d.onprogress=function(){},d.onerror=function(){n(500,"error",{text:d.responseText})},o.data&&(i="string"===t.type(o.data)?o.data:t.param(o.data)),d.open(a.type,a.url),d.send(i)},abort:function(){d&&d.abort()}}}}),t},a=[n(2)],void 0===(o="function"==typeof(i=s)?i.apply(e,a):i)||(t.exports=o)},function(t,e,n){(function(e,n){var i=e.View.extend({events:{"click .next-btn":"slideNext","click .prev-btn":"slidePrev"},initialize:function(){var t=this;this.$(".tab-wrap").is(":hidden")?n(window).on("refresh",function(){t.$(".tab-wrap").is(":hidden")||t.setPos.apply(t)}):this.setPos(),this.on("updated:carousel",function(){t.setPos()})},setPos:function(){var t=this;this.tab=this.$(".tab"),this.wrap=this.$(".tab-wrap"),this.wrap.addClass("carousel-active"),this.maxScroll=this.tab.outerWidth()-this.wrap.width(),this.wrap.on("scroll",function(e){t.scrolled.apply(t,[e.target.scrollLeft])}),n(window).on("resize",function(){t.resetPos.apply(t)}),this.pos=this.pos?this.pos:0,this.checkForBoundary()},slideNext:function(){this.pos<this.maxScroll&&(this.pos+=Math.round(.9*this.wrap.width()),this.updatePos())},slidePrev:function(){this.pos>0&&(this.pos-=Math.round(.9*this.wrap.width()),this.updatePos())},updatePos:function(){var t=this;this.wrap.animate({scrollLeft:this.pos},function(){t.checkForBoundary.apply(t)})},checkForBoundary:function(){this.maxScroll<=0?(this.maxScroll=0,this.$el.addClass("carousel-begin"),this.$el.addClass("carousel-end")):0===this.pos?(this.$el.removeClass("carousel-end"),this.$el.addClass("carousel-begin")):this.pos==this.maxScroll?(this.$el.removeClass("carousel-begin"),this.$el.addClass("carousel-end")):(this.$el.removeClass("carousel-begin"),this.$el.removeClass("carousel-end"))},scrolled:function(t){var e=this;null!==this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){e.pos=t,e.checkForBoundary.apply(e),e.timeout=null},100)},resetPos:function(){this.pos=this.wrap.scrollLeft(),this.maxScroll=this.tab.outerWidth()-this.wrap.width(),this.checkForBoundary()}});t.exports=i}).call(e,n(1),n(2))},function(t,e,n){(function(e,i){n(4);var a=n(8),o="/map/data.json",s="",d="",r=1,u=n(9),l=e.Model.extend({url:function(){return o},startPolling:function(){var t=this;this.on("sync",function(){setTimeout(function(){t.fetch()},5e3)}),this.fetch()}}),c=e.View.extend({_started:!1,_booksRendered:0,initialize:function(t){this.stringLocalizer=t.stringLocalizer,this.$el.data("endpoint")&&(o=this.$el.data("endpoint")),s=this.$el.data("asset-cdn")||"https://d3ogvdx946i4sr.cloudfront.net/",d=this.$el.data("img-cdn")||"https://d1w7fb2mkkr3kw.cloudfront.net/",r=this.$el.parents(".map-live-page").length?5:1,this.$el.is(":visible")&&this.start();var e=this;i(window).on("resize",function(){e._started||e.start()})},start:function(){this.render(),this.model=new l({imgCdn:d}),this.listenTo(this.model,"change:bookUrl",this.renderBook),this.model.startPolling(),this._started=!0,this.logRender();var t=this;setTimeout(function(){t._booksRendered<2&&t.logFailure()},15e3)},logFailure:function(){window.ue&&window.ue.count("MapUpdateFailed",1)},logRender:function(){"function"==typeof uex&&uex("ld","mapRenderStart",{wb:1})},hide:function(){this.$el.parentsUntil(".block-wrap").parent().hide()},render:function(){this.map=a.map(this.el,{minZoom:3,maxZoom:6,attributionControl:!1,zoomControl:!1,keepInView:!0,closePopupOnClick:!1}).setView([51.505,-.09],13),this.popups=new Array;var t=this.map;a.tileLayer(s+"map/{z}/{x}/{y}.jpg").addTo(t);var e=L.latLngBounds([[80,-300],[-80,300]]);t.setMaxBounds(e),t.on("drag",function(){t.panInsideBounds(e,{animate:!1})}),t.setZoom(3)},renderBook:function(t){var e=u(t.attributes),n=this.stringLocalizer.localizeTemplate(e);this.map.panTo([t.get("Latitude"),t.get("Longitude")]);var i=a.popup({maxHeight:180,className:"map-popup"}).setContent(n).setLatLng([t.get("Latitude"),t.get("Longitude")]).addTo(this.map);this.popups.push(i),this.popups.length>r&&this.map.closePopup(this.popups.shift()),this._booksRendered++}});t.exports=c}).call(e,n(1),n(2))},function(t,e,n){var i,a;!function(o,s,d){var r,u,l=o.L,c={};c.version="0.7.7","object"==typeof t&&"object"==typeof t.exports?t.exports=c:void 0===(a="function"==typeof(i=c)?i.call(e,n,e,t):i)||(t.exports=a),c.noConflict=function(){return o.L=l,this},o.L=c,c.Util={extend:function(t){var e,n,i,a,o=Array.prototype.slice.call(arguments,1);for(n=0,i=o.length;n<i;n++)for(e in a=o[n]||{})a.hasOwnProperty(e)&&(t[e]=a[e]);return t},bind:function(t,e){var n=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,n||arguments)}},stamp:(r=0,u="_leaflet_id",function(t){return t[u]=t[u]||++r,t[u]}),invokeEach:function(t,e,n){var i,a;if("object"==typeof t){for(i in a=Array.prototype.slice.call(arguments,3),t)e.apply(n,[i,t[i]].concat(a));return!0}return!1},limitExecByInterval:function(t,e,n){var i,a;return function o(){var s=arguments;i?a=!0:(i=!0,setTimeout(function(){i=!1,a&&(o.apply(n,s),a=!1)},e),t.apply(n,s))}},falseFn:function(){return!1},formatNum:function(t,e){var n=Math.pow(10,e||5);return Math.round(t*n)/n},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return c.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=c.extend({},t.options,e),t.options},getParamString:function(t,e,n){var i=[];for(var a in t)i.push(encodeURIComponent(n?a.toUpperCase():a)+"="+encodeURIComponent(t[a]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,n){var i=e[n];if(void 0===i)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){var e,n,i=["webkit","moz","o","ms"];for(e=0;e<i.length&&!n;e++)n=o[i[e]+t];return n}var e=0;function n(t){var n=+new Date,i=Math.max(0,16-(n-e));return e=n+i,o.setTimeout(t,i)}var i=o.requestAnimationFrame||t("RequestAnimationFrame")||n,a=o.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){o.clearTimeout(t)};c.Util.requestAnimFrame=function(t,e,a,s){if(t=c.bind(t,e),!a||i!==n)return i.call(o,t,s);t()},c.Util.cancelAnimFrame=function(t){t&&a.call(o,t)}}(),c.extend=c.Util.extend,c.bind=c.Util.bind,c.stamp=c.Util.stamp,c.setOptions=c.Util.setOptions,c.Class=function(){},c.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},n=function(){};n.prototype=this.prototype;var i=new n;for(var a in i.constructor=e,e.prototype=i,this)this.hasOwnProperty(a)&&"prototype"!==a&&(e[a]=this[a]);t.statics&&(c.extend(e,t.statics),delete t.statics),t.includes&&(c.Util.extend.apply(null,[i].concat(t.includes)),delete t.includes),t.options&&i.options&&(t.options=c.extend({},i.options,t.options)),c.extend(i,t),i._initHooks=[];var o=this;return e.__super__=o.prototype,i.callInitHooks=function(){if(!this._initHooksCalled){o.prototype.callInitHooks&&o.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;t<e;t++)i._initHooks[t].call(this)}},e},c.Class.include=function(t){c.extend(this.prototype,t)},c.Class.mergeOptions=function(t){c.extend(this.prototype.options,t)},c.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n)};var h,f,p,m,_,g,v,b,y,w,x,L,P,C,S,E,k,T,I,M,D,A,z,O="_leaflet_events";c.Mixin={},c.Mixin.Events={addEventListener:function(t,e,n){if(c.Util.invokeEach(t,this.addEventListener,this,e,n))return this;var i,a,o,s,d,r,u,l=this[O]=this[O]||{},h=n&&n!==this&&c.stamp(n);for(i=0,a=(t=c.Util.splitWords(t)).length;i<a;i++)o={action:e,context:n||this},s=t[i],h?(r=(d=s+"_idx")+"_len",(u=l[d]=l[d]||{})[h]||(u[h]=[],l[r]=(l[r]||0)+1),u[h].push(o)):(l[s]=l[s]||[],l[s].push(o));return this},hasEventListeners:function(t){var e=this[O];return!!e&&(t in e&&e[t].length>0||t+"_idx"in e&&e[t+"_idx_len"]>0)},removeEventListener:function(t,e,n){if(!this[O])return this;if(!t)return this.clearAllEventListeners();if(c.Util.invokeEach(t,this.removeEventListener,this,e,n))return this;var i,a,o,s,d,r,u,l,h=this[O],f=n&&n!==this&&c.stamp(n);for(i=0,a=(t=c.Util.splitWords(t)).length;i<a;i++)if(u=(r=(o=t[i])+"_idx")+"_len",l=h[r],e){if(s=f&&l?l[f]:h[o]){for(d=s.length-1;d>=0;d--)s[d].action!==e||n&&s[d].context!==n||(s.splice(d,1)[0].action=c.Util.falseFn);n&&l&&0===s.length&&(delete l[f],h[u]--)}}else delete h[o],delete h[r],delete h[u];return this},clearAllEventListeners:function(){return delete this[O],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var n,i,a,o,s,d=c.Util.extend({},e,{type:t,target:this}),r=this[O];if(r[t])for(i=0,a=(n=r[t].slice()).length;i<a;i++)n[i].action.call(n[i].context,d);for(s in o=r[t+"_idx"])if(n=o[s].slice())for(i=0,a=n.length;i<a;i++)n[i].action.call(n[i].context,d);return this},addOneTimeEventListener:function(t,e,n){if(c.Util.invokeEach(t,this.addOneTimeEventListener,this,e,n))return this;var i=c.bind(function(){this.removeEventListener(t,e,n).removeEventListener(t,i,n)},this);return this.addEventListener(t,e,n).addEventListener(t,i,n)}},c.Mixin.Events.on=c.Mixin.Events.addEventListener,c.Mixin.Events.off=c.Mixin.Events.removeEventListener,c.Mixin.Events.once=c.Mixin.Events.addOneTimeEventListener,c.Mixin.Events.fire=c.Mixin.Events.fireEvent,f=(h="ActiveXObject"in o)&&!s.addEventListener,p=navigator.userAgent.toLowerCase(),m=-1!==p.indexOf("webkit"),_=-1!==p.indexOf("chrome"),g=-1!==p.indexOf("phantom"),v=-1!==p.indexOf("android"),b=-1!==p.search("android [23]"),y=-1!==p.indexOf("gecko"),w=typeof orientation!=void 0+"",x=!o.PointerEvent&&o.MSPointerEvent,L=o.PointerEvent&&o.navigator.pointerEnabled||x,P="devicePixelRatio"in o&&o.devicePixelRatio>1||"matchMedia"in o&&o.matchMedia("(min-resolution:144dpi)")&&o.matchMedia("(min-resolution:144dpi)").matches,C=s.documentElement,S=h&&"transition"in C.style,E="WebKitCSSMatrix"in o&&"m11"in new o.WebKitCSSMatrix&&!b,k="MozPerspective"in C.style,T="OTransition"in C.style,I=!o.L_DISABLE_3D&&(S||E||k||T)&&!g,M=!o.L_NO_TOUCH&&!g&&(L||"ontouchstart"in o||o.DocumentTouch&&s instanceof o.DocumentTouch),c.Browser={ie:h,ielt9:f,webkit:m,gecko:y&&!m&&!o.opera&&!h,android:v,android23:b,chrome:_,ie3d:S,webkit3d:E,gecko3d:k,opera3d:T,any3d:I,mobile:w,mobileWebkit:w&&m,mobileWebkit3d:w&&E,mobileOpera:w&&o.opera,touch:M,msPointer:x,pointer:L,retina:P},c.Point=function(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e},c.Point.prototype={clone:function(){return new c.Point(this.x,this.y)},add:function(t){return this.clone()._add(c.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(c.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){var e=(t=c.point(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=c.point(t)).x===this.x&&t.y===this.y},contains:function(t){return t=c.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+c.Util.formatNum(this.x)+", "+c.Util.formatNum(this.y)+")"}},c.point=function(t,e,n){return t instanceof c.Point?t:c.Util.isArray(t)?new c.Point(t[0],t[1]):void 0===t||null===t?t:new c.Point(t,e,n)},c.Bounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,a=n.length;i<a;i++)this.extend(n[i])},c.Bounds.prototype={extend:function(t){return t=c.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new c.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new c.Point(this.min.x,this.max.y)},getTopRight:function(){return new c.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof c.Point?c.point(t):c.bounds(t))instanceof c.Bounds?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=c.bounds(t);var e=this.min,n=this.max,i=t.min,a=t.max,o=a.x>=e.x&&i.x<=n.x,s=a.y>=e.y&&i.y<=n.y;return o&&s},isValid:function(){return!(!this.min||!this.max)}},c.bounds=function(t,e){return!t||t instanceof c.Bounds?t:new c.Bounds(t,e)},c.Transformation=function(t,e,n,i){this._a=t,this._b=e,this._c=n,this._d=i},c.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new c.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},c.DomUtil={get:function(t){return"string"==typeof t?s.getElementById(t):t},getStyle:function(t,e){var n=t.style[e];if(!n&&t.currentStyle&&(n=t.currentStyle[e]),(!n||"auto"===n)&&s.defaultView){var i=s.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return"auto"===n?null:n},getViewportOffset:function(t){var e,n=0,i=0,a=t,o=s.body,d=s.documentElement;do{if(n+=a.offsetTop||0,i+=a.offsetLeft||0,n+=parseInt(c.DomUtil.getStyle(a,"borderTopWidth"),10)||0,i+=parseInt(c.DomUtil.getStyle(a,"borderLeftWidth"),10)||0,e=c.DomUtil.getStyle(a,"position"),a.offsetParent===o&&"absolute"===e)break;if("fixed"===e){n+=o.scrollTop||d.scrollTop||0,i+=o.scrollLeft||d.scrollLeft||0;break}if("relative"===e&&!a.offsetLeft){var r=c.DomUtil.getStyle(a,"width"),u=c.DomUtil.getStyle(a,"max-width"),l=a.getBoundingClientRect();"none"===r&&"none"===u||(i+=l.left+a.clientLeft),n+=l.top+(o.scrollTop||d.scrollTop||0);break}a=a.offsetParent}while(a);a=t;do{if(a===o)break;n-=a.scrollTop||0,i-=a.scrollLeft||0,a=a.parentNode}while(a);return new c.Point(i,n)},documentIsLtr:function(){return c.DomUtil._docIsLtrCached||(c.DomUtil._docIsLtrCached=!0,c.DomUtil._docIsLtr="ltr"===c.DomUtil.getStyle(s.body,"direction")),c.DomUtil._docIsLtr},create:function(t,e,n){var i=s.createElement(t);return i.className=e,n&&n.appendChild(i),i},hasClass:function(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=c.DomUtil._getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(void 0!==t.classList)for(var n=c.Util.splitWords(e),i=0,a=n.length;i<a;i++)t.classList.add(n[i]);else if(!c.DomUtil.hasClass(t,e)){var o=c.DomUtil._getClass(t);c.DomUtil._setClass(t,(o?o+" ":"")+e)}},removeClass:function(t,e){void 0!==t.classList?t.classList.remove(e):c.DomUtil._setClass(t,c.Util.trim((" "+c.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e},_getClass:function(t){return void 0===t.className.baseVal?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}},testProp:function(t){for(var e=s.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1},getTranslateString:function(t){var e=c.Browser.webkit3d,n=(e?",0":"")+")";return"translate"+(e?"3d":"")+"("+t.x+"px,"+t.y+"px"+n},getScaleString:function(t,e){return c.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t)))+(" scale("+t+") ")},setPosition:function(t,e,n){t._leaflet_pos=e,!n&&c.Browser.any3d?t.style[c.DomUtil.TRANSFORM]=c.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},c.DomUtil.TRANSFORM=c.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),c.DomUtil.TRANSITION=c.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),c.DomUtil.TRANSITION_END="webkitTransition"===c.DomUtil.TRANSITION||"OTransition"===c.DomUtil.TRANSITION?c.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in s)c.extend(c.DomUtil,{disableTextSelection:function(){c.DomEvent.on(o,"selectstart",c.DomEvent.preventDefault)},enableTextSelection:function(){c.DomEvent.off(o,"selectstart",c.DomEvent.preventDefault)}});else{var t=c.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);c.extend(c.DomUtil,{disableTextSelection:function(){if(t){var e=s.documentElement.style;this._userSelect=e[t],e[t]="none"}},enableTextSelection:function(){t&&(s.documentElement.style[t]=this._userSelect,delete this._userSelect)}})}c.extend(c.DomUtil,{disableImageDrag:function(){c.DomEvent.on(o,"dragstart",c.DomEvent.preventDefault)},enableImageDrag:function(){c.DomEvent.off(o,"dragstart",c.DomEvent.preventDefault)}})}(),c.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,void 0!==n&&(this.alt=parseFloat(n))},c.extend(c.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),c.LatLng.prototype={equals:function(t){return!!t&&(t=c.latLng(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=c.LatLng.MAX_MARGIN)},toString:function(t){return"LatLng("+c.Util.formatNum(this.lat,t)+", "+c.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=c.latLng(t);var e=c.LatLng.DEG_TO_RAD,n=(t.lat-this.lat)*e,i=(t.lng-this.lng)*e,a=this.lat*e,o=t.lat*e,s=Math.sin(n/2),d=Math.sin(i/2),r=s*s+d*d*Math.cos(a)*Math.cos(o);return 12756274*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))},wrap:function(t,e){var n=this.lng;return t=t||-180,n=(n+(e=e||180))%(e-t)+(n<t||n===e?e:t),new c.LatLng(this.lat,n)}},c.latLng=function(t,e){return t instanceof c.LatLng?t:c.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new c.LatLng(t[0],t[1],t[2]):null:void 0===t||null===t?t:"object"==typeof t&&"lat"in t?new c.LatLng(t.lat,"lng"in t?t.lng:t.lon):void 0===e?null:new c.LatLng(t,e)},c.LatLngBounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,a=n.length;i<a;i++)this.extend(n[i])},c.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=c.latLng(t);return(t=null!==e?e:c.latLngBounds(t))instanceof c.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new c.LatLng(t.lat,t.lng),this._northEast=new c.LatLng(t.lat,t.lng)):t instanceof c.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,a=Math.abs(e.lng-n.lng)*t;return new c.LatLngBounds(new c.LatLng(e.lat-i,e.lng-a),new c.LatLng(n.lat+i,n.lng+a))},getCenter:function(){return new c.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new c.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new c.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof c.LatLng?c.latLng(t):c.latLngBounds(t);var e,n,i=this._southWest,a=this._northEast;return t instanceof c.LatLngBounds?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=a.lat&&e.lng>=i.lng&&n.lng<=a.lng},intersects:function(t){t=c.latLngBounds(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),a=t.getNorthEast(),o=a.lat>=e.lat&&i.lat<=n.lat,s=a.lng>=e.lng&&i.lng<=n.lng;return o&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return!!t&&(t=c.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast()))},isValid:function(){return!(!this._southWest||!this._northEast)}},c.latLngBounds=function(t,e){return!t||t instanceof c.LatLngBounds?t:new c.LatLngBounds(t,e)},c.Projection={},c.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=c.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),a=t.lng*e,o=i*e;return o=Math.log(Math.tan(Math.PI/4+o/2)),new c.Point(a,o)},unproject:function(t){var e=c.LatLng.RAD_TO_DEG,n=t.x*e,i=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new c.LatLng(i,n)}},c.Projection.LonLat={project:function(t){return new c.Point(t.lng,t.lat)},unproject:function(t){return new c.LatLng(t.y,t.x)}},c.CRS={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return c.point(e,e)}},c.CRS.Simple=c.extend({},c.CRS,{projection:c.Projection.LonLat,transformation:new c.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),c.CRS.EPSG3857=c.extend({},c.CRS,{code:"EPSG:3857",projection:c.Projection.SphericalMercator,transformation:new c.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){return this.projection.project(t).multiplyBy(6378137)}}),c.CRS.EPSG900913=c.extend({},c.CRS.EPSG3857,{code:"EPSG:900913"}),c.CRS.EPSG4326=c.extend({},c.CRS,{code:"EPSG:4326",projection:c.Projection.LonLat,transformation:new c.Transformation(1/360,.5,-1/360,.5)}),c.Map=c.Class.extend({includes:c.Mixin.Events,options:{crs:c.CRS.EPSG3857,fadeAnimation:c.DomUtil.TRANSITION&&!c.Browser.android23,trackResize:!0,markerZoomAnimation:c.DomUtil.TRANSITION&&c.Browser.any3d},initialize:function(t,e){e=c.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=c.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&void 0!==e.zoom&&this.setView(c.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=void 0===e?this.getZoom():e,this._resetView(c.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),a=this.getSize().divideBy(2),o=(t instanceof c.Point?t:this.latLngToContainerPoint(t)).subtract(a).multiplyBy(1-1/i),s=this.containerPointToLatLng(a.add(o));return this.setView(s,e,{zoom:n})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():c.latLngBounds(t);var n=c.point(e.paddingTopLeft||e.padding||[0,0]),i=c.point(e.paddingBottomRight||e.padding||[0,0]),a=this.getBoundsZoom(t,!1,n.add(i));a=e.maxZoom?Math.min(e.maxZoom,a):a;var o=i.subtract(n).divideBy(2),s=this.project(t.getSouthWest(),a),d=this.project(t.getNorthEast(),a),r=this.unproject(s.add(d).divideBy(2).add(o),a);return this.setView(r,a,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(c.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=c.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var n=this.getCenter(),i=this._limitCenter(n,this._zoom,t);return n.equals(i)?this:this.panTo(i,e)},addLayer:function(t){var e=c.stamp(t);return this._layers[e]?this:(this._layers[e]=t,!t.options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&c.TileLayer&&t instanceof c.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t),this)},removeLayer:function(t){var e=c.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&c.TileLayer&&t instanceof c.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(t){return!!t&&c.stamp(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=c.extend({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var n=this.getSize(),i=e.divideBy(2).round(),a=n.divideBy(2).round(),o=i.subtract(a);return o.x||o.y?(t.animate&&t.pan?this.panBy(o):(t.pan&&this._rawPanBy(o),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=void 0}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),n=this.unproject(t.getTopRight());return new c.LatLngBounds(e,n)},getMinZoom:function(){return void 0===this.options.minZoom?void 0===this._layersMinZoom?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=c.latLngBounds(t);var i,a=this.getMinZoom()-(e?1:0),o=this.getMaxZoom(),s=this.getSize(),d=t.getNorthWest(),r=t.getSouthEast(),u=!0;n=c.point(n||[0,0]);do{a++,i=this.project(r,a).subtract(this.project(d,a)).add(n),u=e?i.x<s.x||i.y<s.y:s.contains(i)}while(u&&a<=o);return u&&e?null:e?a:a-1},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new c.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new c.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(c.latLng(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(c.point(t),e)},layerPointToLatLng:function(t){var e=c.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(c.latLng(t))._round()._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return c.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return c.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(c.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(c.latLng(t)))},mouseEventToContainerPoint:function(t){return c.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=c.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;c.DomUtil.addClass(t,"leaflet-container"+(c.Browser.touch?" leaflet-touch":"")+(c.Browser.retina?" leaflet-retina":"")+(c.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=c.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(c.DomUtil.addClass(t.markerPane,e),c.DomUtil.addClass(t.shadowPane,e),c.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return c.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){for(var e=0,n=(t=t?c.Util.isArray(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_resetView:function(t,e,n,i){var a=this._zoom!==e;i||(this.fire("movestart"),a&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),n?this._initialTopLeftPoint._add(this._getMapPanePos()):c.DomUtil.setPosition(this._mapPane,new c.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var o=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!n}),o&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(a||i)&&this.fire("zoomend"),this.fire("moveend",{hard:!n})},_rawPanBy:function(t){c.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-1/0,i=this._getZoomSpan();for(t in this._zoomBoundLayers){var a=this._zoomBoundLayers[t];isNaN(a.options.minZoom)||(e=Math.min(e,a.options.minZoom)),isNaN(a.options.maxZoom)||(n=Math.max(n,a.options.maxZoom))}void 0===t?this._layersMaxZoom=this._layersMinZoom=void 0:(this._layersMaxZoom=n,this._layersMinZoom=e),i!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){if(c.DomEvent){t=t||"on",c.DomEvent[t](this._container,"click",this._onMouseClick,this);var e,n,i=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(e=0,n=i.length;e<n;e++)c.DomEvent[t](this._container,i[e],this._fireMouseEvent,this);this.options.trackResize&&c.DomEvent[t](o,"resize",this._onResize,this)}},_onResize:function(){c.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=c.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||c.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!c.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&c.DomEvent.preventDefault(t);var n=this.mouseEventToContainerPoint(t),i=this.containerPointToLayerPoint(n),a=this.layerPointToLatLng(i);this.fire(e,{latlng:a,layerPoint:i,containerPoint:n,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return c.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewTopLeftPoint(n,e).add(this._getMapPanePos());return this.project(t,e)._subtract(i)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),a=this.getSize().divideBy(2),o=new c.Bounds(i.subtract(a),i.add(a)),s=this._getBoundsOffset(o,n,e);return this.unproject(i.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new c.Bounds(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=this.project(e.getNorthWest(),n).subtract(t.min),a=this.project(e.getSouthEast(),n).subtract(t.max),o=this._rebound(i.x,-a.x),s=this._rebound(i.y,-a.y);return new c.Point(o,s)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom();return Math.max(e,Math.min(n,t))}}),c.map=function(t,e){return new c.Map(t,e)},c.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=c.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),a=this.R_MAJOR,o=this.R_MINOR,s=t.lng*e*a,d=i*e,r=o/a,u=Math.sqrt(1-r*r),l=u*Math.sin(d);l=Math.pow((1-l)/(1+l),.5*u);var h=Math.tan(.5*(.5*Math.PI-d))/l;return d=-a*Math.log(h),new c.Point(s,d)},unproject:function(t){for(var e,n=c.LatLng.RAD_TO_DEG,i=this.R_MAJOR,a=this.R_MINOR,o=t.x*n/i,s=a/i,d=Math.sqrt(1-s*s),r=Math.exp(-t.y/i),u=Math.PI/2-2*Math.atan(r),l=15,h=.1;Math.abs(h)>1e-7&&--l>0;)e=d*Math.sin(u),u+=h=Math.PI/2-2*Math.atan(r*Math.pow((1-e)/(1+e),.5*d))-u;return new c.LatLng(u*n,o)}},c.CRS.EPSG3395=c.extend({},c.CRS,{code:"EPSG:3395",projection:c.Projection.Mercator,transformation:(D=c.Projection.Mercator.R_MAJOR,A=.5/(Math.PI*D),new c.Transformation(A,.5,-A,.5))}),c.TileLayer=c.Class.extend({includes:c.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:c.Browser.mobile,updateWhenIdle:c.Browser.mobile},initialize:function(t,e){(e=c.setOptions(this,e)).detectRetina&&c.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=c.latLngBounds(e.bounds)),this._url=t;var n=this.options.subdomains;"string"==typeof n&&(this.options.subdomains=n.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=c.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var n,i,a,o=t.children,s=-e(1/0,-1/0);for(i=0,a=o.length;i<a;i++)o[i]!==this._container&&(n=parseInt(o[i].style.zIndex,10),isNaN(n)||(s=e(s,n)));this.options.zIndex=this._container.style.zIndex=(isFinite(s)?s:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(c.Browser.ielt9)for(t in e)c.DomUtil.setOpacity(e[t],this.options.opacity);else c.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=c.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){this._bgBuffer=c.DomUtil.create("div","leaflet-tile-container",this._container),this._tileContainer=c.DomUtil.create("div","leaflet-tile-container",this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,n=this.options.maxNativeZoom,i=this.options.tileSize;return n&&e>n&&(i=Math.round(t.getZoomScale(e)/t.getZoomScale(n)*i)),i},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),n=t.getZoom(),i=this._getTileSize();if(!(n>this.options.maxZoom||n<this.options.minZoom)){var a=c.bounds(e.min.divideBy(i)._floor(),e.max.divideBy(i)._floor());this._addTilesFromCenterOut(a),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(a)}}},_addTilesFromCenterOut:function(t){var e,n,i,a=[],o=t.getCenter();for(e=t.min.y;e<=t.max.y;e++)for(n=t.min.x;n<=t.max.x;n++)i=new c.Point(n,e),this._tileShouldBeLoaded(i)&&a.push(i);var d=a.length;if(0!==d){a.sort(function(t,e){return t.distanceTo(o)-e.distanceTo(o)});var r=s.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=d,n=0;n<d;n++)this._addTile(a[n],r);this._tileContainer.appendChild(r)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var n=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=n.x)||t.y<0||t.y>=n.y)return!1}if(e.bounds){var i=this._getTileSize(),a=t.multiplyBy(i),o=a.add([i,i]),s=this._map.unproject(a),d=this._map.unproject(o);if(e.continuousWorld||e.noWrap||(s=s.wrap(),d=d.wrap()),!e.bounds.intersects([s,d]))return!1}return!0},_removeOtherTiles:function(t){var e,n,i,a;for(a in this._tiles)e=a.split(":"),n=parseInt(e[0],10),i=parseInt(e[1],10),(n<t.min.x||n>t.max.x||i<t.min.y||i>t.max.y)&&this._removeTile(a)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(c.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),c.Browser.android||(e.onload=null,e.src=c.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var n=this._getTilePos(t),i=this._getTile();c.DomUtil.setPosition(i,n,c.Browser.chrome),this._tiles[t.x+":"+t.y]=i,this._loadTile(i,t),i.parentNode!==this._tileContainer&&e.appendChild(i)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),n=this._getTileSize();return t.multiplyBy(n).subtract(e)},getTileUrl:function(t){return c.Util.template(this._url,c.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){return this._map.options.crs.getSize(this._map.getZoom()).divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=c.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=c.Util.falseFn,c.Browser.ielt9&&void 0!==this.options.opacity&&c.DomUtil.setOpacity(t,this.options.opacity),c.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&c.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(c.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==c.Util.emptyImageUrl&&(c.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),c.tileLayer=function(t,e){return new c.TileLayer(t,e)},c.TileLayer.WMS=c.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var n=c.extend({},this.defaultWmsParams),i=e.tileSize||this.options.tileSize;for(var a in e.detectRetina&&c.Browser.retina?n.width=n.height=2*i:n.width=n.height=i,e)this.options.hasOwnProperty(a)||"crs"===a||(n[a]=e[a]);this.wmsParams=n,c.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,c.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,n=this.options.tileSize,i=t.multiplyBy(n),a=i.add([n,n]),o=this._crs.project(e.unproject(i,t.z)),s=this._crs.project(e.unproject(a,t.z)),d=this._wmsVersion>=1.3&&this._crs===c.CRS.EPSG4326?[s.y,o.x,o.y,s.x].join(","):[o.x,s.y,s.x,o.y].join(","),r=c.Util.template(this._url,{s:this._getSubdomain(t)});return r+c.Util.getParamString(this.wmsParams,r,!0)+"&BBOX="+d},setParams:function(t,e){return c.extend(this.wmsParams,t),e||this.redraw(),this}}),c.tileLayer.wms=function(t,e){return new c.TileLayer.WMS(t,e)},c.TileLayer.Canvas=c.TileLayer.extend({options:{async:!1},initialize:function(t){c.setOptions(this,t)},redraw:function(){for(var t in this._map&&(this._reset({hard:!0}),this._update()),this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=c.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=c.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),c.tileLayer.canvas=function(t){return new c.TileLayer.Canvas(t)},c.ImageOverlay=c.Class.extend({includes:c.Mixin.Events,options:{opacity:1},initialize:function(t,e,n){this._url=t,this._bounds=c.latLngBounds(e),c.setOptions(this,n)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&c.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=c.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&c.Browser.any3d?c.DomUtil.addClass(this._image,"leaflet-zoom-animated"):c.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),c.extend(this._image,{galleryimg:"no",onselectstart:c.Util.falseFn,onmousemove:c.Util.falseFn,onload:c.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,n=this._image,i=e.getZoomScale(t.zoom),a=this._bounds.getNorthWest(),o=this._bounds.getSouthEast(),s=e._latLngToNewLayerPoint(a,t.zoom,t.center),d=e._latLngToNewLayerPoint(o,t.zoom,t.center)._subtract(s),r=s._add(d._multiplyBy(.5*(1-1/i)));n.style[c.DomUtil.TRANSFORM]=c.DomUtil.getTranslateString(r)+" scale("+i+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);c.DomUtil.setPosition(t,e),t.style.width=n.x+"px",t.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){c.DomUtil.setOpacity(this._image,this.options.opacity)}}),c.imageOverlay=function(t,e,n){return new c.ImageOverlay(t,e,n)},c.Icon=c.Class.extend({options:{className:""},initialize:function(t){c.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n,i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}return n=e&&"IMG"===e.tagName?this._createImg(i,e):this._createImg(i),this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var n,i=this.options,a=c.point(i[e+"Size"]);!(n="shadow"===e?c.point(i.shadowAnchor||i.iconAnchor):c.point(i.iconAnchor))&&a&&(n=a.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+i.className,n&&(t.style.marginLeft=-n.x+"px",t.style.marginTop=-n.y+"px"),a&&(t.style.width=a.x+"px",t.style.height=a.y+"px")},_createImg:function(t,e){return(e=e||s.createElement("img")).src=t,e},_getIconUrl:function(t){return c.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),c.icon=function(t){return new c.Icon(t)},c.Icon.Default=c.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];c.Browser.retina&&"icon"===t&&(t+="-2x");var n=c.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+t+".png"}}),c.Icon.Default.imagePath=function(){var t,e,n,i,a=s.getElementsByTagName("script"),o=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=a.length;t<e;t++)if((n=a[t].src).match(o))return((i=n.split(o)[0])?i+"/":"")+"images"}(),c.Marker=c.Class.extend({includes:c.Mixin.Events,options:{icon:new c.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){c.setOptions(this,e),this._latlng=c.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=c.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var t=this.options,e=this._map,n=e.options.zoomAnimation&&e.options.markerZoomAnimation?"leaflet-zoom-animated":"leaflet-zoom-hide",i=t.icon.createIcon(this._icon),a=!1;i!==this._icon&&(this._icon&&this._removeIcon(),a=!0,t.title&&(i.title=t.title),t.alt&&(i.alt=t.alt)),c.DomUtil.addClass(i,n),t.keyboard&&(i.tabIndex="0"),this._icon=i,this._initInteraction(),t.riseOnHover&&c.DomEvent.on(i,"mouseover",this._bringToFront,this).on(i,"mouseout",this._resetZIndex,this);var o=t.icon.createShadow(this._shadow),s=!1;o!==this._shadow&&(this._removeShadow(),s=!0),o&&c.DomUtil.addClass(o,n),this._shadow=o,t.opacity<1&&this._updateOpacity();var d=this._map._panes;a&&d.markerPane.appendChild(this._icon),o&&s&&d.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&c.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){c.DomUtil.setPosition(this._icon,t),this._shadow&&c.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];c.DomUtil.addClass(t,"leaflet-clickable"),c.DomEvent.on(t,"click",this._onMouseClick,this),c.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var n=0;n<e.length;n++)c.DomEvent.on(t,e[n],this._fireMouseEvent,this);c.Handler.MarkerDrag&&(this.dragging=new c.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&c.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&c.DomEvent.preventDefault(t),"mousedown"!==t.type?c.DomEvent.stopPropagation(t):c.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){c.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&c.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),c.marker=function(t,e){return new c.Marker(t,e)},c.DivIcon=c.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:s.createElement("div"),n=this.options;return!1!==n.html?e.innerHTML=n.html:e.innerHTML="",n.bgPos&&(e.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),c.divIcon=function(t){return new c.DivIcon(t)},c.Map.mergeOptions({closePopupOnClick:!0}),c.Popup=c.Class.extend({includes:c.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){c.setOptions(this,t),this._source=e,this._animated=c.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&c.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&c.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),c.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&c.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=c.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",n=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),i=this._container=c.DomUtil.create("div",n);this.options.closeButton&&((t=this._closeButton=c.DomUtil.create("a",e+"-close-button",i)).href="#close",t.innerHTML="&#215;",c.DomEvent.disableClickPropagation(t),c.DomEvent.on(t,"click",this._onCloseButtonClick,this));var a=this._wrapper=c.DomUtil.create("div",e+"-content-wrapper",i);c.DomEvent.disableClickPropagation(a),this._contentNode=c.DomUtil.create("div",e+"-content",a),c.DomEvent.disableScrollPropagation(this._contentNode),c.DomEvent.on(a,"contextmenu",c.DomEvent.stopPropagation),this._tipContainer=c.DomUtil.create("div",e+"-tip-container",i),this._tip=c.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,a=this.options.maxHeight;a&&i>a?(e.height=a+"px",c.DomUtil.addClass(t,"leaflet-popup-scrolled")):c.DomUtil.removeClass(t,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,n=c.point(this.options.offset);e&&c.DomUtil.setPosition(this._container,t),this._containerBottom=-n.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);c.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,n=this._containerWidth,i=new c.Point(this._containerLeft,-e-this._containerBottom);this._animated&&i._add(c.DomUtil.getPosition(this._container));var a=t.layerPointToContainerPoint(i),o=c.point(this.options.autoPanPadding),s=c.point(this.options.autoPanPaddingTopLeft||o),d=c.point(this.options.autoPanPaddingBottomRight||o),r=t.getSize(),u=0,l=0;a.x+n+d.x>r.x&&(u=a.x+n-r.x+d.x),a.x-u-s.x<0&&(u=a.x-s.x),a.y+e+d.y>r.y&&(l=a.y+e-r.y+d.y),a.y-l-s.y<0&&(l=a.y-s.y),(u||l)&&t.fire("autopanstart").panBy([u,l])}},_onCloseButtonClick:function(t){this._close(),c.DomEvent.stop(t)}}),c.popup=function(t,e){return new c.Popup(t,e)},c.Map.include({openPopup:function(t,e,n){if(this.closePopup(),!(t instanceof c.Popup)){var i=t;t=new c.Popup(n).setLatLng(e).setContent(i)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),c.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var n=c.point(this.options.icon.options.popupAnchor||[0,0]);return n=n.add(c.Popup.prototype.options.offset),e&&e.offset&&(n=n.add(e.offset)),e=c.extend({offset:n},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof c.Popup?(c.setOptions(t,e),this._popup=t,t._source=this):this._popup=new c.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),c.LayerGroup=c.Class.extend({initialize:function(t){var e,n;if(this._layers={},t)for(e=0,n=t.length;e<n;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,i);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return c.stamp(t)}}),c.layerGroup=function(t){return new c.LayerGroup(t)},c.FeatureGroup=c.LayerGroup.extend({includes:c.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(c.FeatureGroup.EVENTS,this._propagateEvent,this),c.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),"off"in t&&t.off(c.FeatureGroup.EVENTS,this._propagateEvent,this),c.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new c.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof c.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=c.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),c.featureGroup=function(t){return new c.FeatureGroup(t)},c.Path=c.Class.extend({includes:[c.Mixin.Events],statics:{CLIP_PADDING:(z=((c.Browser.mobile?1280:2e3)/Math.max(o.outerWidth,o.outerHeight)-1)/2,Math.max(0,Math.min(.5,z)))},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){c.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,c.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return c.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),c.Map.include({_updatePathViewport:function(){var t=c.Path.CLIP_PADDING,e=this.getSize(),n=c.DomUtil.getPosition(this._mapPane).multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),i=n.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new c.Bounds(n,i)}}),c.Path.SVG_NS="http://www.w3.org/2000/svg",c.Browser.svg=!(!s.createElementNS||!s.createElementNS(c.Path.SVG_NS,"svg").createSVGRect),c.Path=c.Path.extend({statics:{SVG:c.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,n=t.firstChild;return e&&n!==e&&t.insertBefore(e,n),this},getPathString:function(){},_createElement:function(t){return s.createElementNS(c.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&c.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){!c.Browser.svg&&c.Browser.vml||c.DomUtil.addClass(this._path,"leaflet-clickable"),c.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)c.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this._map&&this.hasEventListeners(t.type)){var e=this._map,n=e.mouseEventToContainerPoint(t),i=e.containerPointToLayerPoint(n),a=e.layerPointToLatLng(i);this.fire(t.type,{latlng:a,layerPoint:i,containerPoint:n,originalEvent:t}),"contextmenu"===t.type&&c.DomEvent.preventDefault(t),"mousemove"!==t.type&&c.DomEvent.stopPropagation(t)}}}),c.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=c.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&c.Browser.any3d?(c.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):c.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),n=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[c.DomUtil.TRANSFORM]=c.DomUtil.getTranslateString(n)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max,i=n.x-e.x,a=n.y-e.y,o=this._pathRoot,s=this._panes.overlayPane;c.Browser.mobileWebkit&&s.removeChild(o),c.DomUtil.setPosition(o,e),o.setAttribute("width",i),o.setAttribute("height",a),o.setAttribute("viewBox",[e.x,e.y,i,a].join(" ")),c.Browser.mobileWebkit&&s.appendChild(o)}}}),c.Path.include({bindPopup:function(t,e){return t instanceof c.Popup?this._popup=t:(this._popup&&!e||(this._popup=new c.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),c.Browser.vml=!c.Browser.svg&&function(){try{var t=s.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}(),c.Path=c.Browser.svg||!c.Browser.vml?c.Path:c.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return s.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return s.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return s.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");c.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&c.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,n=this.options,i=this._container;i.stroked=n.stroke,i.filled=n.fill,n.stroke?(t||((t=this._stroke=this._createElement("stroke")).endcap="round",i.appendChild(t)),t.weight=n.weight+"px",t.color=n.color,t.opacity=n.opacity,n.dashArray?t.dashStyle=c.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):t.dashStyle="",n.lineCap&&(t.endcap=n.lineCap.replace("butt","flat")),n.lineJoin&&(t.joinstyle=n.lineJoin)):t&&(i.removeChild(t),this._stroke=null),n.fill?(e||(e=this._fill=this._createElement("fill"),i.appendChild(e)),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(i.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),c.Map.include(c.Browser.svg||!c.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=s.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),c.Browser.canvas=!!s.createElement("canvas").getContext,c.Path=c.Path.SVG&&!o.L_PREFER_CANVAS||!c.Browser.canvas?c.Path:c.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return c.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!c.Path._updateRequest&&(c.Path._updateRequest=c.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){c.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color),t.lineCap&&(this._ctx.lineCap=t.lineCap),t.lineJoin&&(this._ctx.lineJoin=t.lineJoin)},_drawPath:function(){var t,e,n,i,a,o;for(this._ctx.beginPath(),t=0,n=this._parts.length;t<n;t++){for(e=0,i=this._parts[t].length;e<i;e++)a=this._parts[t][e],o=(0===e?"move":"line")+"To",this._ctx[o](a.x,a.y);this instanceof c.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill(e.fillRule||"evenodd")),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(t){this._containsPoint(t.layerPoint)&&this.fire(t.type,t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),c.Map.include(c.Path.SVG&&!o.L_PREFER_CANVAS||!c.Browser.canvas?{}:{_initPathRoot:function(){var t,e=this._pathRoot;e||((e=this._pathRoot=s.createElement("canvas")).style.position="absolute",(t=this._canvasCtx=e.getContext("2d")).lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(e),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max.subtract(e),i=this._pathRoot;c.DomUtil.setPosition(i,e),i.width=n.x,i.height=n.y,i.getContext("2d").translate(-e.x,-e.y)}}}),c.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=this._reducePoints(t,n),t=this._simplifyDP(t,n)},pointToSegmentDistance:function(t,e,n){return Math.sqrt(this._sqClosestPointOnSegment(t,e,n,!0))},closestPointOnSegment:function(t,e,n){return this._sqClosestPointOnSegment(t,e,n)},_simplifyDP:function(t,e){var n=t.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,this._simplifyDPStep(t,i,e,0,n-1);var a,o=[];for(a=0;a<n;a++)i[a]&&o.push(t[a]);return o},_simplifyDPStep:function(t,e,n,i,a){var o,s,d,r=0;for(s=i+1;s<=a-1;s++)(d=this._sqClosestPointOnSegment(t[s],t[i],t[a],!0))>r&&(o=s,r=d);r>n&&(e[o]=1,this._simplifyDPStep(t,e,n,i,o),this._simplifyDPStep(t,e,n,o,a))},_reducePoints:function(t,e){for(var n=[t[0]],i=1,a=0,o=t.length;i<o;i++)this._sqDist(t[i],t[a])>e&&(n.push(t[i]),a=i);return a<o-1&&n.push(t[o-1]),n},clipSegment:function(t,e,n,i){var a,o,s,d=i?this._lastCode:this._getBitCode(t,n),r=this._getBitCode(e,n);for(this._lastCode=r;;){if(!(d|r))return[t,e];if(d&r)return!1;a=d||r,o=this._getEdgeIntersection(t,e,a,n),s=this._getBitCode(o,n),a===d?(t=o,d=s):(e=o,r=s)}},_getEdgeIntersection:function(t,e,n,i){var a=e.x-t.x,o=e.y-t.y,s=i.min,d=i.max;return 8&n?new c.Point(t.x+a*(d.y-t.y)/o,d.y):4&n?new c.Point(t.x+a*(s.y-t.y)/o,s.y):2&n?new c.Point(d.x,t.y+o*(d.x-t.x)/a):1&n?new c.Point(s.x,t.y+o*(s.x-t.x)/a):void 0},_getBitCode:function(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i},_sqClosestPointOnSegment:function(t,e,n,i){var a,o=e.x,s=e.y,d=n.x-o,r=n.y-s,u=d*d+r*r;return u>0&&((a=((t.x-o)*d+(t.y-s)*r)/u)>1?(o=n.x,s=n.y):a>0&&(o+=d*a,s+=r*a)),d=t.x-o,r=t.y-s,i?d*d+r*r:new c.Point(o,s)}},c.Polyline=c.Path.extend({initialize:function(t,e){c.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;t<e;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,n="";t<e;t++)n+=this._getPathPartStr(this._parts[t]);return n},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(c.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,n,i=1/0,a=this._parts,o=null,s=0,d=a.length;s<d;s++)for(var r=a[s],u=1,l=r.length;u<l;u++){e=r[u-1],n=r[u];var h=c.LineUtil._sqClosestPointOnSegment(t,e,n,!0);h<i&&(i=h,o=c.LineUtil._sqClosestPointOnSegment(t,e,n))}return o&&(o.distance=Math.sqrt(i)),o},getBounds:function(){return new c.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var n,i,a=e?t:[];for(n=0,i=t.length;n<i;n++){if(c.Util.isArray(t[n])&&"number"!=typeof t[n][0])return;a[n]=c.latLng(t[n])}return a},_initEvents:function(){c.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,n=c.Path.VML,i=0,a=t.length,o="";i<a;i++)e=t[i],n&&e._round(),o+=(i?"L":"M")+e.x+" "+e.y;return o},_clipPoints:function(){var t,e,n,i=this._originalPoints,a=i.length;if(this.options.noClip)this._parts=[i];else{this._parts=[];var o=this._parts,s=this._map._pathViewport,d=c.LineUtil;for(t=0,e=0;t<a-1;t++)(n=d.clipSegment(i[t],i[t+1],s,t))&&(o[e]=o[e]||[],o[e].push(n[0]),n[1]===i[t+1]&&t!==a-2||(o[e].push(n[1]),e++))}},_simplifyPoints:function(){for(var t=this._parts,e=c.LineUtil,n=0,i=t.length;n<i;n++)t[n]=e.simplify(t[n],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),c.Path.prototype._updatePath.call(this))}}),c.polyline=function(t,e){return new c.Polyline(t,e)},c.PolyUtil={},c.PolyUtil.clipPolygon=function(t,e){var n,i,a,o,s,d,r,u,l,h=[1,4,2,8],f=c.LineUtil;for(i=0,r=t.length;i<r;i++)t[i]._code=f._getBitCode(t[i],e);for(o=0;o<4;o++){for(u=h[o],n=[],i=0,a=(r=t.length)-1;i<r;a=i++)s=t[i],d=t[a],s._code&u?d._code&u||((l=f._getEdgeIntersection(d,s,u,e))._code=f._getBitCode(l,e),n.push(l)):(d._code&u&&((l=f._getEdgeIntersection(d,s,u,e))._code=f._getBitCode(l,e),n.push(l)),n.push(s));t=n}return t},c.Polygon=c.Polyline.extend({options:{fill:!0},initialize:function(t,e){c.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,n,i;if(t&&c.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,n=this._holes.length;e<n;e++)(i=this._holes[e]=this._convertLatLngs(this._holes[e]))[0].equals(i[i.length-1])&&i.pop();(t=this._latlngs).length>=2&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){var t,e,n,i;if(c.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes)for(t=0,n=this._holes.length;t<n;t++)for(this._holePoints[t]=[],e=0,i=this._holes[t].length;e<i;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])},setLatLngs:function(t){return t&&c.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):c.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var n=0,i=this._parts.length;n<i;n++){var a=c.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);a.length&&e.push(a)}this._parts=e}},_getPathPartStr:function(t){return c.Polyline.prototype._getPathPartStr.call(this,t)+(c.Browser.svg?"z":"x")}}),c.polygon=function(t,e){return new c.Polygon(t,e)},function(){function t(t){return c.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var n=0,i=e.length;for(this.eachLayer(function(t){n<i?t.setLatLngs(e[n++]):this.removeLayer(t)},this);n<i;)this.addLayer(new t(e[n++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}c.MultiPolyline=t(c.Polyline),c.MultiPolygon=t(c.Polygon),c.multiPolyline=function(t,e){return new c.MultiPolyline(t,e)},c.multiPolygon=function(t,e){return new c.MultiPolygon(t,e)}}(),c.Rectangle=c.Polygon.extend({initialize:function(t,e){c.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=c.latLngBounds(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),c.rectangle=function(t,e){return new c.Rectangle(t,e)},c.Circle=c.Path.extend({initialize:function(t,e,n){c.Path.prototype.initialize.call(this,n),this._latlng=c.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=c.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,n=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-n.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,n=this._latlng;return new c.LatLngBounds([n.lat-e,n.lng-t],[n.lat+e,n.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":c.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(c.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,n=this._point;return n.x-e>t.max.x||n.y-e>t.max.y||n.x+e<t.min.x||n.y+e<t.min.y}}),c.circle=function(t,e,n){return new c.Circle(t,e,n)},c.CircleMarker=c.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){c.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){c.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return c.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),c.circleMarker=function(t,e){return new c.CircleMarker(t,e)},c.Polyline.include(c.Path.CANVAS?{_containsPoint:function(t,e){var n,i,a,o,s,d,r=this.options.weight/2;for(c.Browser.touch&&(r+=10),n=0,o=this._parts.length;n<o;n++)for(i=0,a=(s=(d=this._parts[n]).length)-1;i<s;a=i++)if((e||0!==i)&&c.LineUtil.pointToSegmentDistance(t,d[a],d[i])<=r)return!0;return!1}}:{}),c.Polygon.include(c.Path.CANVAS?{_containsPoint:function(t){var e,n,i,a,o,s,d,r,u=!1;if(c.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(a=0,d=this._parts.length;a<d;a++)for(o=0,s=(r=(e=this._parts[a]).length)-1;o<r;s=o++)n=e[o],i=e[s],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(u=!u);return u}}:{}),c.Circle.include(c.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,n=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+n}}:{}),c.CircleMarker.include(c.Path.CANVAS?{_updateStyle:function(){c.Path.prototype._updateStyle.call(this)}}:{}),c.GeoJSON=c.FeatureGroup.extend({initialize:function(t,e){c.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,a=c.Util.isArray(t)?t:t.features;if(a){for(e=0,n=a.length;e<n;e++)((i=a[e]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(a[e]);return this}var o=this.options;if(!o.filter||o.filter(t)){var s=c.GeoJSON.geometryToLayer(t,o.pointToLayer,o.coordsToLatLng,o);return s.feature=c.GeoJSON.asFeature(t),s.defaultOptions=s.options,this.resetStyle(s),o.onEachFeature&&o.onEachFeature(t,s),this.addLayer(s)}},resetStyle:function(t){var e=this.options.style;e&&(c.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),c.extend(c.GeoJSON,{geometryToLayer:function(t,e,n,i){var a,o,s,d,r="Feature"===t.type?t.geometry:t,u=r.coordinates,l=[];switch(n=n||this.coordsToLatLng,r.type){case"Point":return a=n(u),e?e(t,a):new c.Marker(a);case"MultiPoint":for(s=0,d=u.length;s<d;s++)a=n(u[s]),l.push(e?e(t,a):new c.Marker(a));return new c.FeatureGroup(l);case"LineString":return o=this.coordsToLatLngs(u,0,n),new c.Polyline(o,i);case"Polygon":if(2===u.length&&!u[1].length)throw new Error("Invalid GeoJSON object.");return o=this.coordsToLatLngs(u,1,n),new c.Polygon(o,i);case"MultiLineString":return o=this.coordsToLatLngs(u,1,n),new c.MultiPolyline(o,i);case"MultiPolygon":return o=this.coordsToLatLngs(u,2,n),new c.MultiPolygon(o,i);case"GeometryCollection":for(s=0,d=r.geometries.length;s<d;s++)l.push(this.geometryToLayer({geometry:r.geometries[s],type:"Feature",properties:t.properties},e,n,i));return new c.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new c.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,n){var i,a,o,s=[];for(a=0,o=t.length;a<o;a++)i=e?this.coordsToLatLngs(t[a],e-1,n):(n||this.coordsToLatLng)(t[a]),s.push(i);return s},latLngToCoords:function(t){var e=[t.lng,t.lat];return void 0!==t.alt&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],n=0,i=t.length;n<i;n++)e.push(c.GeoJSON.latLngToCoords(t[n]));return e},getFeature:function(t,e){return t.feature?c.extend({},t.feature,{geometry:e}):c.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var B={toGeoJSON:function(){return c.GeoJSON.getFeature(this,{type:"Point",coordinates:c.GeoJSON.latLngToCoords(this.getLatLng())})}};c.Marker.include(B),c.Circle.include(B),c.CircleMarker.include(B),c.Polyline.include({toGeoJSON:function(){return c.GeoJSON.getFeature(this,{type:"LineString",coordinates:c.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),c.Polygon.include({toGeoJSON:function(){var t,e,n,i=[c.GeoJSON.latLngsToCoords(this.getLatLngs())];if(i[0].push(i[0][0]),this._holes)for(t=0,e=this._holes.length;t<e;t++)(n=c.GeoJSON.latLngsToCoords(this._holes[t])).push(n[0]),i.push(n);return c.GeoJSON.getFeature(this,{type:"Polygon",coordinates:i})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),c.GeoJSON.getFeature(this,{type:t,coordinates:e})}}c.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),c.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),c.LayerGroup.include({toGeoJSON:function(){var e,n=this.feature&&this.feature.geometry,i=[];if(n&&"MultiPoint"===n.type)return t("MultiPoint").call(this);var a=n&&"GeometryCollection"===n.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),i.push(a?e.geometry:c.GeoJSON.asFeature(e)))}),a?c.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}})}(),c.geoJson=function(t,e){return new c.GeoJSON(t,e)},c.DomEvent={addListener:function(t,e,n,i){var a,o,s,d=c.stamp(n),r="_leaflet_"+e+d;return t[r]?this:(a=function(e){return n.call(i||t,e||c.DomEvent._getEvent())},c.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,a,d):(c.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,a,d),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",a,!1),t.addEventListener(e,a,!1)):"mouseenter"===e||"mouseleave"===e?(o=a,s="mouseenter"===e?"mouseover":"mouseout",a=function(e){if(c.DomEvent._checkMouse(t,e))return o(e)},t.addEventListener(s,a,!1)):"click"===e&&c.Browser.android?(o=a,a=function(t){return c.DomEvent._filterClick(t,o)},t.addEventListener(e,a,!1)):t.addEventListener(e,a,!1):"attachEvent"in t&&t.attachEvent("on"+e,a),t[r]=a,this))},removeListener:function(t,e,n){var i=c.stamp(n),a="_leaflet_"+e+i,o=t[a];return o?(c.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,i):c.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,i):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",o,!1),t.removeEventListener(e,o,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",o,!1):t.removeEventListener(e,o,!1):"detachEvent"in t&&t.detachEvent("on"+e,o),t[a]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,c.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=c.DomEvent.stopPropagation;return c.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=c.DomEvent.stopPropagation,n=c.Draggable.START.length-1;n>=0;n--)c.DomEvent.on(t,c.Draggable.START[n],e);return c.DomEvent.on(t,"click",c.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return c.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new c.Point(t.clientX,t.clientY);var n=e.getBoundingClientRect();return new c.Point(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){c.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t},_getEvent:function(){var t=o.event;if(!t)for(var e=arguments.callee.caller;e&&(!(t=e.arguments[0])||o.Event!==t.constructor);)e=e.caller;return t},_filterClick:function(t,e){var n=t.timeStamp||t.originalEvent.timeStamp,i=c.DomEvent._lastClick&&n-c.DomEvent._lastClick;if(!(i&&i>100&&i<500||t.target._simulatedClick&&!t._simulated))return c.DomEvent._lastClick=n,e(t);c.DomEvent.stop(t)}},c.DomEvent.on=c.DomEvent.addListener,c.DomEvent.off=c.DomEvent.removeListener,c.Draggable=c.Class.extend({includes:c.Mixin.Events,statics:{START:c.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=c.Draggable.START.length-1;t>=0;t--)c.DomEvent.on(this._dragStartTarget,c.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=c.Draggable.START.length-1;t>=0;t--)c.DomEvent.off(this._dragStartTarget,c.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!t.shiftKey&&(1===t.which||1===t.button||t.touches)&&(c.DomEvent.stopPropagation(t),!c.Draggable._disabled&&(c.DomUtil.disableImageDrag(),c.DomUtil.disableTextSelection(),!this._moving))){var e=t.touches?t.touches[0]:t;this._startPoint=new c.Point(e.clientX,e.clientY),this._startPos=this._newPos=c.DomUtil.getPosition(this._element),c.DomEvent.on(s,c.Draggable.MOVE[t.type],this._onMove,this).on(s,c.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new c.Point(e.clientX,e.clientY).subtract(this._startPoint);(n.x||n.y)&&(c.Browser.touch&&Math.abs(n.x)+Math.abs(n.y)<3||(c.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=c.DomUtil.getPosition(this._element).subtract(n),c.DomUtil.addClass(s.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,c.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,c.Util.cancelAnimFrame(this._animRequest),this._animRequest=c.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))}},_updatePosition:function(){this.fire("predrag"),c.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){for(var t in c.DomUtil.removeClass(s.body,"leaflet-dragging"),this._lastTarget&&(c.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),c.Draggable.MOVE)c.DomEvent.off(s,c.Draggable.MOVE[t],this._onMove).off(s,c.Draggable.END[t],this._onUp);c.DomUtil.enableImageDrag(),c.DomUtil.enableTextSelection(),this._moved&&this._moving&&(c.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),c.Handler=c.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),c.Map.mergeOptions({dragging:!0,inertia:!c.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:c.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),c.Map.Drag=c.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new c.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,a=(i-e+n)%t+e-n,o=(i+e+n)%t-e-n,s=Math.abs(a+n)<Math.abs(o+n)?a:o;this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,n=e.options,i=+new Date-this._lastTime,a=!n.inertia||i>n.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),a)e.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),s=(this._lastTime+i-this._times[0])/1e3,d=n.easeLinearity,r=o.multiplyBy(d/s),u=r.distanceTo([0,0]),l=Math.min(n.inertiaMaxSpeed,u),h=r.multiplyBy(l/u),f=l/(n.inertiaDeceleration*d),p=h.multiplyBy(-f/2).round();p.x&&p.y?(p=e._limitOffset(p,e.options.maxBounds),c.Util.requestAnimFrame(function(){e.panBy(p,{duration:f,easeLinearity:d,noMoveStart:!0})})):e.fire("moveend")}}}),c.Map.addInitHook("addHandler","dragging",c.Map.Drag),c.Map.mergeOptions({doubleClickZoom:!0}),c.Map.DoubleClickZoom=c.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}}),c.Map.addInitHook("addHandler","doubleClickZoom",c.Map.DoubleClickZoom),c.Map.mergeOptions({scrollWheelZoom:!0}),c.Map.ScrollWheelZoom=c.Handler.extend({addHooks:function(){c.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),c.DomEvent.on(this._map._container,"MozMousePixelScroll",c.DomEvent.preventDefault),this._delta=0},removeHooks:function(){c.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),c.DomEvent.off(this._map._container,"MozMousePixelScroll",c.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=c.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c.bind(this._performZoom,this),n),c.DomEvent.preventDefault(t),c.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,n=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(n+e)-n,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(n+e):t.setZoomAround(this._lastMousePos,n+e))}}),c.Map.addInitHook("addHandler","scrollWheelZoom",c.Map.ScrollWheelZoom),c.extend(c.DomEvent,{_touchstart:c.Browser.msPointer?"MSPointerDown":c.Browser.pointer?"pointerdown":"touchstart",_touchend:c.Browser.msPointer?"MSPointerUp":c.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,n){var i,a,o=!1,d=250,r=this._touchstart,u=this._touchend,l=[];function h(t){var e;if(c.Browser.pointer?(l.push(t.pointerId),e=l.length):e=t.touches.length,!(e>1)){var n=Date.now(),s=n-(i||n);a=t.touches?t.touches[0]:t,o=s>0&&s<=d,i=n}}function f(t){if(c.Browser.pointer){var n=l.indexOf(t.pointerId);if(-1===n)return;l.splice(n,1)}if(o){if(c.Browser.pointer){var s,d={};for(var r in a)s=a[r],d[r]="function"==typeof s?s.bind(a):s;a=d}a.type="dblclick",e(a),i=null}}t["_leaflet_"+r+n]=h,t["_leaflet_"+u+n]=f;var p=c.Browser.pointer?s.documentElement:t;return t.addEventListener(r,h,!1),p.addEventListener(u,f,!1),c.Browser.pointer&&p.addEventListener(c.DomEvent.POINTER_CANCEL,f,!1),this},removeDoubleTapListener:function(t,e){var n="_leaflet_";return t.removeEventListener(this._touchstart,t[n+this._touchstart+e],!1),(c.Browser.pointer?s.documentElement:t).removeEventListener(this._touchend,t[n+this._touchend+e],!1),c.Browser.pointer&&s.documentElement.removeEventListener(c.DomEvent.POINTER_CANCEL,t[n+this._touchend+e],!1),this}}),c.extend(c.DomEvent,{POINTER_DOWN:c.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:c.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:c.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:c.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,n,i){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,n,i);case"touchend":return this.addPointerListenerEnd(t,e,n,i);case"touchmove":return this.addPointerListenerMove(t,e,n,i);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,e,n,i){var a=this._pointers,o=function(t){"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&c.DomEvent.preventDefault(t);for(var e=!1,i=0;i<a.length;i++)if(a[i].pointerId===t.pointerId){e=!0;break}e||a.push(t),t.touches=a.slice(),t.changedTouches=[t],n(t)};if(t["_leaflet_touchstart"+i]=o,t.addEventListener(this.POINTER_DOWN,o,!1),!this._pointerDocumentListener){var d=function(t){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a.splice(e,1);break}};s.documentElement.addEventListener(this.POINTER_UP,d,!1),s.documentElement.addEventListener(this.POINTER_CANCEL,d,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,n,i){var a=this._pointers;function o(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a[e]=t;break}t.touches=a.slice(),t.changedTouches=[t],n(t)}}return t["_leaflet_touchmove"+i]=o,t.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(t,e,n,i){var a=this._pointers,o=function(t){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a.splice(e,1);break}t.touches=a.slice(),t.changedTouches=[t],n(t)};return t["_leaflet_touchend"+i]=o,t.addEventListener(this.POINTER_UP,o,!1),t.addEventListener(this.POINTER_CANCEL,o,!1),this},removePointerListener:function(t,e,n){var i=t["_leaflet_"+e+n];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,i,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,i,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,i,!1),t.removeEventListener(this.POINTER_CANCEL,i,!1)}return this}}),c.Map.mergeOptions({touchZoom:c.Browser.touch&&!c.Browser.android23,bounceAtZoomLimits:!0}),c.Map.TouchZoom=c.Handler.extend({addHooks:function(){c.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){c.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),i=e.mouseEventToLayerPoint(t.touches[1]),a=e._getCenterLayerPoint();this._startCenter=n.add(i)._divideBy(2),this._startDist=n.distanceTo(i),this._moved=!1,this._zooming=!0,this._centerOffset=a.subtract(this._startCenter),e._panAnim&&e._panAnim.stop(),c.DomEvent.on(s,"touchmove",this._onTouchMove,this).on(s,"touchend",this._onTouchEnd,this),c.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),i=e.mouseEventToLayerPoint(t.touches[1]);this._scale=n.distanceTo(i)/this._startDist,this._delta=n._add(i)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(!e.options.bounceAtZoomLimits&&(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1)||(this._moved||(c.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),c.Util.cancelAnimFrame(this._animRequest),this._animRequest=c.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),c.DomEvent.preventDefault(t)))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),i=t.getScaleZoom(this._scale);t._animateZoom(n,i,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(this._moved&&this._zooming){var t=this._map;this._zooming=!1,c.DomUtil.removeClass(t._mapPane,"leaflet-touching"),c.Util.cancelAnimFrame(this._animRequest),c.DomEvent.off(s,"touchmove",this._onTouchMove).off(s,"touchend",this._onTouchEnd);var e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),i=t.getZoom(),a=t.getScaleZoom(this._scale)-i,o=a>0?Math.ceil(a):Math.floor(a),d=t._limitZoom(i+o),r=t.getZoomScale(d)/this._scale;t._animateZoom(n,d,e,r)}else this._zooming=!1},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),c.Map.addInitHook("addHandler","touchZoom",c.Map.TouchZoom),c.Map.mergeOptions({tap:!0,tapTolerance:15}),c.Map.Tap=c.Handler.extend({addHooks:function(){c.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){c.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(c.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new c.Point(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&c.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(c.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),c.DomEvent.on(s,"touchmove",this._onMove,this).on(s,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),c.DomEvent.off(s,"touchmove",this._onMove,this).off(s,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&c.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new c.Point(e.clientX,e.clientY)},_simulateEvent:function(t,e){var n=s.createEvent("MouseEvents");n._simulated=!0,e.target._simulatedClick=!0,n.initMouseEvent(t,!0,!0,o,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}}),c.Browser.touch&&!c.Browser.pointer&&c.Map.addInitHook("addHandler","tap",c.Map.Tap),c.Map.mergeOptions({boxZoom:!0}),c.Map.BoxZoom=c.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){c.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){c.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){if(this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button)return!1;c.DomUtil.disableTextSelection(),c.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),c.DomEvent.on(s,"mousemove",this._onMouseMove,this).on(s,"mouseup",this._onMouseUp,this).on(s,"keydown",this._onKeyDown,this)},_onMouseMove:function(t){this._moved||(this._box=c.DomUtil.create("div","leaflet-zoom-box",this._pane),c.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,n=this._box,i=this._map.mouseEventToLayerPoint(t),a=i.subtract(e),o=new c.Point(Math.min(i.x,e.x),Math.min(i.y,e.y));c.DomUtil.setPosition(n,o),this._moved=!0,n.style.width=Math.max(0,Math.abs(a.x)-4)+"px",n.style.height=Math.max(0,Math.abs(a.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),c.DomUtil.enableTextSelection(),c.DomUtil.enableImageDrag(),c.DomEvent.off(s,"mousemove",this._onMouseMove).off(s,"mouseup",this._onMouseUp).off(s,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,n=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(n)){var i=new c.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(n));e.fitBounds(i),e.fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),c.Map.addInitHook("addHandler","boxZoom",c.Map.BoxZoom),c.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),c.Map.Keyboard=c.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),c.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;c.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var t=s.body,e=s.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),o.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,n,i=this._panKeys={},a=this.keyCodes;for(e=0,n=a.left.length;e<n;e++)i[a.left[e]]=[-1*t,0];for(e=0,n=a.right.length;e<n;e++)i[a.right[e]]=[t,0];for(e=0,n=a.down.length;e<n;e++)i[a.down[e]]=[0,t];for(e=0,n=a.up.length;e<n;e++)i[a.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,n,i=this._zoomKeys={},a=this.keyCodes;for(e=0,n=a.zoomIn.length;e<n;e++)i[a.zoomIn[e]]=t;for(e=0,n=a.zoomOut.length;e<n;e++)i[a.zoomOut[e]]=-t},_addHooks:function(){c.DomEvent.on(s,"keydown",this._onKeyDown,this)},_removeHooks:function(){c.DomEvent.off(s,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,n=this._map;if(e in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;n.panBy(this._panKeys[e]),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else{if(!(e in this._zoomKeys))return;n.setZoom(n.getZoom()+this._zoomKeys[e])}c.DomEvent.stop(t)}}),c.Map.addInitHook("addHandler","keyboard",c.Map.Keyboard),c.Handler.MarkerDrag=c.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new c.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),c.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),c.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,n=c.DomUtil.getPosition(t._icon),i=t._map.layerPointToLatLng(n);e&&c.DomUtil.setPosition(e,n),t._latlng=i,t.fire("move",{latlng:i}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),c.Control=c.Class.extend({options:{position:"topright"},initialize:function(t){c.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return c.DomUtil.addClass(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this},removeFrom:function(t){var e=this.getPosition();return t._controlCorners[e].removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),c.control=function(t){return new c.Control(t)},c.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=c.DomUtil.create("div",e+"control-container",this._container);function i(i,a){var o=e+i+" "+e+a;t[i+a]=c.DomUtil.create("div",o,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),c.Control.Zoom=c.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=c.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",n,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,n,i,a,o){var s=c.DomUtil.create("a",n,i);s.innerHTML=t,s.href="#",s.title=e;var d=c.DomEvent.stopPropagation;return c.DomEvent.on(s,"click",d).on(s,"mousedown",d).on(s,"dblclick",d).on(s,"click",c.DomEvent.preventDefault).on(s,"click",a,o).on(s,"click",this._refocusOnMap,o),s},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";c.DomUtil.removeClass(this._zoomInButton,e),c.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&c.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&c.DomUtil.addClass(this._zoomInButton,e)}}),c.Map.mergeOptions({zoomControl:!0}),c.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new c.Control.Zoom,this.addControl(this.zoomControl))}),c.control.zoom=function(t){return new c.Control.Zoom(t)},c.Control.Attribution=c.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){c.setOptions(this,t),this._attributions={}},onAdd:function(t){for(var e in this._container=c.DomUtil.create("div","leaflet-control-attribution"),c.DomEvent.disableClickPropagation(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){if(t)return this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this},removeAttribution:function(t){if(t)return this._attributions[t]&&(this._attributions[t]--,this._update()),this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),c.Map.mergeOptions({attributionControl:!0}),c.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new c.Control.Attribution).addTo(this))}),c.control.attribution=function(t){return new c.Control.Attribution(t)},c.Control.Scale=c.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e=c.DomUtil.create("div","leaflet-control-scale"),n=this.options;return this._addScales(n,"leaflet-control-scale",e),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),e},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=c.DomUtil.create("div",e+"-line",n)),t.imperial&&(this._iScale=c.DomUtil.create("div",e+"-line",n))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,n=6378137*Math.PI*Math.cos(e*Math.PI/180)*(t.getNorthEast().lng-t.getSouthWest().lng)/180,i=this._map.getSize(),a=this.options,o=0;i.x>0&&(o=n*(a.maxWidth/i.x)),this._updateScales(a,o)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=e<1e3?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,n,i,a=3.2808399*t,o=this._iScale;a>5280?(e=a/5280,n=this._getRoundNum(e),o.style.width=this._getScaleWidth(n/e)+"px",o.innerHTML=n+" mi"):(i=this._getRoundNum(a),o.style.width=this._getScaleWidth(i/a)+"px",o.innerHTML=i+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),c.control.scale=function(t){return new c.Control.Scale(t)},c.Control.Layers=c.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,n){for(var i in c.setOptions(this,n),this._layers={},this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=c.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=c.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),c.Browser.touch?c.DomEvent.on(e,"click",c.DomEvent.stopPropagation):c.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var n=this._form=c.DomUtil.create("form",t+"-list");if(this.options.collapsed){c.Browser.android||c.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var i=this._layersLink=c.DomUtil.create("a",t+"-toggle",e);i.href="#",i.title="Layers",c.Browser.touch?c.DomEvent.on(i,"click",c.DomEvent.stop).on(i,"click",this._expand,this):c.DomEvent.on(i,"focus",this._expand,this),c.DomEvent.on(n,"click",function(){setTimeout(c.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=c.DomUtil.create("div",t+"-base",n),this._separator=c.DomUtil.create("div",t+"-separator",n),this._overlaysList=c.DomUtil.create("div",t+"-overlays",n),e.appendChild(n)},_addLayer:function(t,e,n){var i=c.stamp(t);this._layers[i]={layer:t,name:e,overlay:n},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,n=!1,i=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),i=i||e.overlay,n=n||!e.overlay;this._separator.style.display=i&&n?"":"none"}},_onLayerChange:function(t){var e=this._layers[c.stamp(t.layer)];if(e){this._handlingClick||this._update();var n=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)}},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';e&&(n+=' checked="checked"'),n+="/>";var i=s.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(t){var e,n=s.createElement("label"),i=this._map.hasLayer(t.layer);t.overlay?((e=s.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=i):e=this._createRadioElement("leaflet-base-layers",i),e.layerId=c.stamp(t.layer),c.DomEvent.on(e,"click",this._onInputClick,this);var a=s.createElement("span");return a.innerHTML=" "+t.name,n.appendChild(e),n.appendChild(a),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),n},_onInputClick:function(){var t,e,n,i=this._form.getElementsByTagName("input"),a=i.length;for(this._handlingClick=!0,t=0;t<a;t++)e=i[t],n=this._layers[e.layerId],e.checked&&!this._map.hasLayer(n.layer)?this._map.addLayer(n.layer):!e.checked&&this._map.hasLayer(n.layer)&&this._map.removeLayer(n.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){c.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),c.control.layers=function(t,e,n){return new c.Control.Layers(t,e,n)},c.PosAnimation=c.Class.extend({includes:c.Mixin.Events,run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[c.DomUtil.TRANSITION]="all "+(n||.25)+"s cubic-bezier(0,0,"+(i||.5)+",1)",c.DomEvent.on(t,c.DomUtil.TRANSITION_END,this._onTransitionEnd,this),c.DomUtil.setPosition(t,e),c.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(c.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(c.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),c.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();t?(this._el._leaflet_pos=t,this.fire("step")):this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,e,n,i=this._el,a=o.getComputedStyle(i);if(c.Browser.any3d){if(!(n=a[c.DomUtil.TRANSFORM].match(this._transformRe)))return;t=parseFloat(n[1]),e=parseFloat(n[2])}else t=parseFloat(a.left),e=parseFloat(a.top);return new c.Point(t,e,!0)},_onTransitionEnd:function(){c.DomEvent.off(this._el,c.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[c.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),c.Map.include({setView:function(t,e,n){if((e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(c.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&!0!==n)&&(void 0!==n.animate&&(n.zoom=c.extend({animate:n.animate},n.zoom),n.pan=c.extend({animate:n.animate},n.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan)))return clearTimeout(this._sizeTimer),this;return this._resetView(t,e),this},panBy:function(t,e){if(t=c.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new c.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){c.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){c.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._floor();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n))&&(this.panBy(n,e),!0)}}),c.PosAnimation=c.DomUtil.TRANSITION?c.PosAnimation:c.PosAnimation.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=c.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=c.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;t<e?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));c.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){c.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),c.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),c.DomUtil.TRANSITION&&c.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&c.DomUtil.TRANSITION&&c.Browser.any3d&&!c.Browser.android23&&!c.Browser.mobileOpera,this._zoomAnimated&&c.DomEvent.on(this._mapPane,c.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),c.Map.include(c.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),a=this._getCenterOffset(t)._divideBy(1-1/i),o=this._getCenterLayerPoint()._add(a);return!(!0!==n.animate&&!this.getSize().contains(a))&&(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,o,i,null,!0),!0)},_animateZoom:function(t,e,n,i,a,o,s){s||(this._animatingZoom=!0),c.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,c.Draggable&&(c.Draggable._disabled=!0),c.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:n,scale:i,delta:a,backwards:o}),setTimeout(c.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,c.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),c.Util.requestAnimFrame(function(){this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),c.Draggable&&(c.Draggable._disabled=!1)},this))}}:{}),c.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,n=c.DomUtil.TRANSFORM,i=t.delta?c.DomUtil.getTranslateString(t.delta):e.style[n],a=c.DomUtil.getScaleString(t.scale,t.origin);e.style[n]=t.backwards?a+" "+i:i+" "+a},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),c.Util.falseFn(e.offsetWidth);var n=this._map.getZoom();(n>this.options.maxZoom||n<this.options.minZoom)&&this._clearBgBuffer(),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[c.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,n=this._getLoadedTilesPercentage(e),i=this._getLoadedTilesPercentage(t);if(e&&n>.5&&i<.5)return t.style.visibility="hidden",void this._stopLoadingImages(t);e.style.visibility="hidden",e.style[c.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),clearTimeout(this._clearBgBufferTimer)},_getLoadedTilesPercentage:function(t){var e,n,i=t.getElementsByTagName("img"),a=0;for(e=0,n=i.length;e<n;e++)i[e].complete&&a++;return a/n},_stopLoadingImages:function(t){var e,n,i,a=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,n=a.length;e<n;e++)(i=a[e]).complete||(i.onload=c.Util.falseFn,i.onerror=c.Util.falseFn,i.src=c.Util.emptyImageUrl,i.parentNode.removeChild(i))}}),c.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=c.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=c.bind(this._handleGeolocationResponse,this),n=c.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,n=t.coords.longitude,i=new c.LatLng(e,n),a=180*t.coords.accuracy/40075017,o=a/Math.cos(c.LatLng.DEG_TO_RAD*e),s=c.latLngBounds([e-a,n-o],[e+a,n+o]),d=this._locateOptions;if(d.setView){var r=Math.min(this.getBoundsZoom(s),d.maxZoom);this.setView(i,r)}var u={latlng:i,bounds:s,timestamp:t.timestamp};for(var l in t.coords)"number"==typeof t.coords[l]&&(u[l]=t.coords[l]);this.fire("locationfound",u)}})}(window,document)},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="map-book-item">\n\t<div class="img-wrap">\n\t\t<a href="'+__e(bookUrl)+'" class="link-to-localize">\n\t\t\t<img src="'+__e(imgCdn)+"assets/images/"+__e(coverUrl)+'">\n\t\t</a>\n\t</div>\n\t<div class="info-wrap">\n\t\t<p class="item-loc">\n\t\t\tSomeone in <span class="item-bold">'+(null==(__t=displayName)?"":__t)+'</span> bought\n\t\t</p>\n\t\t<p class="item-title">\n\t\t\t<a href="'+__e(bookUrl)+'" class="link-to-localize">'+(null==(__t=title)?"":__t)+'</a>\n\t\t</p>\n\t\t<p class="item-time">\n\t\t    with <span class="item-bold">free delivery</span> <br>\n\t\t    '+(null==(__t=timeDiff)?"":__t)+"\n\t\t</p>\n\t</div>\n</div>";return __p}}).call(exports,__webpack_require__(3))},function(t,e,n){(function(e,n){t.exports=e.View.extend({el:"body",initialize:function(t){this.$window=n(window),this.isMobile=t.isMobile,this.stringLocalizer=t.stringLocalizer},loadAll:function(){var t=location.pathname;this.isMobile||loadZopim(t,this)}})}).call(e,n(1),n(2))},function(t,e,n){(function(e,n){var i=e.View.extend({events:{"change [data-block-selector-class]":"blockSelector"},initialize:function(){var t=".selector-default";this.$("[data-block-selector-class]").each(function(){(n(this).is(":checked")||n(this).is(":selected"))&&(t=n(this).data("block-selector-class"))}),this._blockSelector(t)},blockSelector:function(t){var e=n(t.target).data("block-selector-class");this._blockSelector(e)},_blockSelector:function(t){var e=this.$(t);n(".selector-default").hide(),this.$("[data-block-selector-class]").each(function(){classAffected=n(this).data("block-selector-class"),n(classAffected).hide()}),e.show()}});t.exports=i}).call(e,n(1),n(2))},function(t,e,n){(function(e,n){var i=e(".ratings-credit-wrap .goodreads-credit-extended"),a=n.View.extend({events:{"click #goodreads-credit":"showGoodreadsExtended","click .goodreads-credit-extended .exit-to-goodreads":"exitToGoodreads","click .goodreads-credit-extended":"hideGoodreadsExtended"},showGoodreadsExtended:function(){this.logCounter("goodreadsCreditClick"),i.slideToggle()},hideGoodreadsExtended:function(){i.slideUp()},exitToGoodreads:function(t){this.logCounter("exitToGoodreads"),t.stopPropagation()},logCounter:function(t){window.ue&&window.ue.count(t,1)}});t.exports=a}).call(e,n(2),n(1))},function(t,e,n){(function(e,n){var i=e.View.extend({events:{"click .show-more":"showMoreCategories"},showMoreCategories:function(t){var e=n(t.currentTarget),i="See more",a="+";e.hasClass("more")&&(a="-",i="See less"),e.toggleClass("more"),e.find(".show-more-sign").html(a),e.find(".show-more-text").html(i),n(".hidden-categories").slideToggle()}});t.exports=i}).call(e,n(1),n(2))},function(t,e,n){(function(e,n){var i=e.View.extend({events:{"click .tab-triggers a":"switchTab"},initialize:function(t){this.app=t.app||window.app,this.$window=n(window),n(".tab-triggers-wrap").length||this.$(".tab-triggers").wrap('<div class="tab-triggers-wrap"></div>');var e=window.location.hash;if(e&&e.startsWith("#tab-")){e=e.substring("tab-".length+1);var i=this.$(".tab-triggers-wrap #"+e);i.length&&(this._switchTab(i),this.app.scrollTop(i.offset().top))}this.$(".tab-triggers").css({flexWrap:"nowrap"})},switchTab:function(t){var e=n(t.currentTarget);this._switchTab(e)},_switchTab:function(t){selectClass=t.data("target"),this.$(".tab-wrap.tab-active").removeClass("tab-active"),this.$(selectClass).addClass("tab-active"),this.$(".carousel-wrap").removeClass("carousel-active"),this.$(".tab-triggers .tab-active").removeClass("tab-active"),t.addClass("tab-active"),this.$(selectClass).parent().addClass("carousel-active"),this.$window.trigger("scroll"),this.$window.trigger("refresh"),window.location.hash="tab-"+t.attr("id")}});t.exports=i}).call(e,n(1),n(2))},function(t,e,n){(function(e,i){var a=n(16),o=n(18),s=(n(21),n(23)),d=n(26),r=e.Model.extend({}),u=e.Collection.extend({model:r,comparator:"modified"}),l=e.Model.extend({}),c=e.View.extend({el:".basket-wrap",initialize:function(){this.listenTo(this.model,"change:totalCostWithSymbol",this.costChange),this.listenTo(this.model,"change:numItems",this.itemChange)},costChange:function(t){t.get("totalCostWithSymbol")&&this.$(".total").html(t.get("totalCostWithSymbol"))},itemChange:function(t){var e="items";1==t.get("numItems")&&(e="item"),this.$(".item-count").attr("data-item-count",t.get("numItems")),this.$(".item-count").html(t.get("numItems")),this.$(".item-text").html(e)}}),h=e.View.extend({className:"basket-popup-wrap",initialize:function(t){this.items=t.items,this.stringLocalizer=t.stringLocalizer,this.listenTo(this.model,"change:totalCostWithSymbol",this.costChange),this.listenTo(this.model,"change:numItems",this.itemChange)},costChange:function(t){t.get("totalCostWithSymbol")&&this.$(".total").html(t.get("totalCostWithSymbol"))},itemChange:function(t){var e="items";1==t.get("numItems")&&(e="item"),this.$(".item-count").attr("data-item-count",t.get("numItems")),this.$(".item-count").html(t.get("numItems")),this.$(".item-text").html(e)},renderBasketInfo:function(){var t=this.stringLocalizer.localizeTemplate(d(this.model.attributes));this.$(".basket-info").html(t)},renderRelated:function(){var t=new o({params:{isbns:this.items.pluck("isbn13").reverse().join(","),type:i("body").hasClass("page-type-home")>0?"home":"detail"},url:this.stringLocalizer.localizedLink("/json/p13n/atc"),currency:this.model.get("currencySmall"),stringLocalizer:this.stringLocalizer,isOmnibusApplicable:i("#isOmnibusApplicable").length});this.$(".basket-related-items").append(t.render().el)},render:function(){return this.$el.empty()&&this.$el.html("<div class='basket-info'></div><div class='basket-related-items'></div>"),this.renderBasketInfo(),!0===this.model.get("showRelated")&&this.renderRelated(),this}}),f=e.View.extend({events:{"click .content-wrap > div:not(.basket-page) .add-to-basket, .modal .add-to-basket":"addToBasket","click .basket-recommendation-carousel .add-to-basket":"logBasketCarouselClick"},initialize:function(t){this.app=t.app,this.stringLocalizer=t.stringLocalizer,this.basketModel=new l,this.basketItems=new u,this.basketWrap=new c({model:this.basketModel}),this.listenTo(this.basketModel,"announce",this.popup)},addToBasket:function(t){t.preventDefault();var e=i(t.currentTarget);window.firstLoadApp.trackingEvents.addToBasketEvent(e);var n=e.data("isbn"),a=e.data("show-related")&&!app.isMobile();this.addItem(n,a,e)},logBasketCarouselClick:function(){window.ue&&window.ue.count("ClickBasketPageCarouselCount",1)},popup:function(t){if(!this.basketPopup){var e=this,n=this.stringLocalizer.localizeString("bd_js_item_added_to_your_basket","Item added to your basket");!0===t.get("error")&&(n=t.get("errorTitle")),this.basketPopup=new h({model:this.basketModel,items:this.basketItems,stringLocalizer:this.stringLocalizer});var i=new s({title:n,child:this.basketPopup.render().el,size:"md",status:!0===t.get("error")?"error":"success"});i.on("hidden",function(){e.basketPopup.el.remove(),e.basketPopup=null}),i.open()}this.trackCartContents()},trackCartContents:function(){var t=[];this.basketItems.each(function(e){var n={};n.item=e.get("isbn13"),n.quantity=e.get("quantity"),n.price=e.get("totalCostGBP"),n.unique_id=e.get("isbn13"),t.push(n)}),window.firstLoadApp.trackingEvents.salesforceAPI&&window.firstLoadApp.trackingEvents.salesforceAPI.push(["trackCart",{cart:a(t)}])},addItem:function(t,e,n){var a=this;n.addClass("loading"),this.basketModel.clear(),this.basketModel.set({showRelated:e}),i.ajax({url:this.stringLocalizer.localizedLink("/basket/addisbn"),data:{isbn13:t,call:"ajax",time:(new Date).getTime()},success:function(t){t.info.currency=t.currency,t.info.currencySmall=t.currencySmall,a.basketModel.set(t.info),!0===t.error&&(a.basketModel.set("error",t.error),a.basketModel.set("errorMessage",t.errorMessage),a.basketModel.set("errorTitle",t.errorTitle)),a.basketItems.set(t.items),a.basketModel.trigger("announce",a.basketModel),n.removeClass("loading")}})}});t.exports=f}).call(e,n(1),n(2))},function(t,e,n){"use strict";t.exports=a;var i=n(17);function a(t,e,n,a){a||(a={});var s=i(t,e,n,a.decycler);if(!n)return s;var d=a.offset||0,r=o(d);return s=s.replace(/^|\n/g,function(t){return t?t+r:r}).slice(d)}function o(t){for(var e="";t--;)e+=" ";return e}a._space=o},function(t,e){function n(t,e){var n=[],i=[];return null==e&&(e=function(t,e){return n[0]===e?"[Circular ~]":"[Circular ~."+i.slice(0,n.indexOf(e)).join(".")+"]"}),function(a,o){if(n.length>0){var s=n.indexOf(this);~s?n.splice(s+1):n.push(this),~s?i.splice(s,1/0,a):i.push(a),~n.indexOf(o)&&(o=e.call(this,a,o))}else n.push(o);return null==t?o:t.call(this,a,o)}}(t.exports=function(t,e,i,a){return JSON.stringify(t,n(e,a),i)}).getSerialize=n},function(t,e,n){(function(e,i){n(19),n(20);var a=n(6),o=["NOT_AVAILABLE","NOTIFY_ABE","ABE"],s=n(21).cdns,d=n(22),r=e.Model.extend({defaults:{title:null,fallback:null,reference:null},getReference:function(){return this.get("reference")}}),u=e.Model.extend({getUrl:function(){return"/"+this.get("url")},getTitle:function(){return this.get("title")},getAuthorName:function(){return this.get("author")?this.get("author").name:null},getRatingStars:function(){var t=i("<div>").addClass("stars");if(this.get("rating")){var e=parseInt(this.get("rating").starCount);if(e)for(var n=1;n<=5;n++)e>=n?t.append(i("<span>").addClass("star full-star")):e>n-1&&e<n?t.append(i("<span>").addClass("star half-star")):t.append(i("<span>").addClass("star"))}return t.html()},getPrice:function(){return this.get("price")?this.get("price").formattedPrice:null},getHistoricalPrice:function(){return this.get("price")?this.get("price").formattedHistoricalPrice:null},getRrp:function(){var t=this.get("price");return t&&t.rrp>t.price?t.formattedRrp:null},getSavings:function(){return this.get("price")?this.get("price").formattedSaving:null},getSavingsPercent:function(){return this.get("price")&&this.get("price").savingPercent&&this.get("price").savingPercent>10?Math.floor(this.get("price").savingPercent):null},getFormat:function(){return this.get("format")},getIsbn:function(){return this.get("isbn")},getImgUrl:function(){return"//"+s[0]+".cloudfront.net/assets/images/book/mid/"+this.get("image")}}),l=e.Collection.extend({model:u,initialize:function(t){this.params=t.params,this.baseUrl=t.baseUrl,this.meta=new r},url:function(){return this.baseUrl+"?"+i.param(this.params)},parse:function(t){return this.meta.set(t.recommendation),t.data},removeUnavailableItems:function(){for(var t=this.models.length-1;t>=0;t--){var e=this.models[t].attributes.price.availability;"undefined"!=e&&-1==o.indexOf(e)||this.models[t].destroy()}},checkUpperLimit:function(){this.models.length>20&&(this.models=this.models.slice(0,20))},hasEnoughRecommendations:function(){return!(this.models.length<3)}}),c=e.View.extend({className:"related-items-wrap",initialize:function(t){this.params=t.params,this.url=t.url,this.stringLocalizer=t.stringLocalizer,this.isOmnibusApplicable=t.isOmnibusApplicable;var e=new l({baseUrl:this.url,params:this.params});this.meta=e.meta,this.listenTo(this.meta,"change:title",this.renderTitle),this.listenTo(this.meta,"change:fallback",this.checkFallback),this.listenTo(e,"update",this.notifyCarousel),this.$el.html("<h3 class='carousel-title'></h3><div class='carousel-wrap'><a class='prev-btn'><i class='icon-chevron-left'></i></a><div class='carousel module tab-wrap'><div class='tab'></div></div><a class='next-btn'><i class='icon-chevron-right'></i></a></div>"),e.fetch({success:function(){e.removeUnavailableItems(),e.checkUpperLimit(),e.hasEnoughRecommendations()?this.renderItems(e.models):this.removeTitle()}.bind(this)})},checkFallback:function(t){!1===t.get("fallback")&&this.$el.addClass("active")},renderItem:function(t){var e=this.stringLocalizer.localizeTemplate(d({item:t,meta:this.meta,isOmnibusApplicable:this.isOmnibusApplicable,shouldShowDiscountWithOmnibus:this.shouldShowDiscountWithOmnibus(t)}));this.$(".carousel-wrap .tab").append(e),i(window).trigger("refresh")},renderItems:function(t){for(var e in t)this.renderItem(t[e])},renderTitle:function(t){this.$(".carousel-title").html(t.get("title"))},removeTitle:function(){this.$(".carousel-title").hide()},render:function(){return this.carousel=new a({el:this.$(".carousel-wrap"),mode:"modal"}),this},notifyCarousel:function(){this.carousel&&this.carousel.trigger("updated:carousel")},shouldShowDiscountWithOmnibus:function(t){return this.isOmnibusApplicable?t.getHistoricalPrice()&&t.getSavingsPercent():t.getSavingsPercent()}});t.exports=c}).call(e,n(1),n(2))},function(t,e){Array.prototype.indexOf=function(t){if(void 0===this||null===this)throw new TypeError(this+"is not an object");var e=this instanceof String?this.split(""):this,n=Math.max(Math.min(e.length,9007199254740991),0)||0,i=Number(arguments[1])||0;for(i=(i<0?Math.max(n+i,0):i)-1;++i<n;)if(i in e&&e[i]===t)return i;return-1}},function(t,e){Object.defineProperty(Function.prototype,"bind",{value:function(t){var e,n,i,a=this,o=function(){};if(!(e=Function.prototype.toString,n=Object.prototype.toString,i="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,function(t){if("function"!=typeof t)return!1;if(i)return function(t){try{return e.call(t),!0}catch(t){return!1}}(t);var a=n.call(t);return"[object Function]"===a||"[object GeneratorFunction]"===a})(a))throw new TypeError("Function.prototype.bind called on incompatible "+a);for(var s,d=Array.prototype.slice.call(arguments,1),r=Math.max(0,a.length-d.length),u=[],l=0;l<r;l++)u.push("$"+l);return s=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(this instanceof s){var e=a.apply(this,d.concat(array_slice.call(arguments)));return Object(e)===e?e:this}return a.apply(t,d.concat(Array.prototype.slice.call(arguments)))}),a.prototype&&(o.prototype=a.prototype,s.prototype=new o,o.prototype=null),s}})},function(t,e){t.exports={sizes:{sm:480,md:668,lg:1024,xl:1280,xxl:1440},cdns:["d1w7fb2mkkr3kw"],analytics_id:"UA-69165239-1"}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj){var url=item.getUrl()+"?ref="+meta.getReference(),img_url=item.getImgUrl();__p+='\n\n<div class="book-item">\n\t<div class="item-img">\n\t\t<a href="'+(null==(__t=url)?"":__t)+'" class="link-to-localize">\n\t\t\t<img src="'+(null==(__t=img_url)?"":__t)+'" alt="'+(null==(__t=item.getTitle())?"":__t)+'">\n            ',shouldShowDiscountWithOmnibus&&(__p+='\n                <div class="savings-splat string-to-localize" data-localizer-string-id="bd_saving_percent_off"\n                     data-parameters=\'{"0":"'+(null==(__t=item.getSavingsPercent())?"":__t)+'"}\'\n                     data-default-localized-pattern="{0}%&lt;br&gt; off"></div>\n            '),__p+='\n\t\t</a>\n\t</div>\n\n\t<div class="item-info">\n\t\t<h3 class="title">\n\t\t\t<a href="'+(null==(__t=url)?"":__t)+'" class="link-to-localize">\n\t\t\t\t'+(null==(__t=item.getTitle())?"":__t)+'\n\t\t\t</a>\n\t\t</h3>\n\t\t<p class="author">\n\t\t\t'+(null==(__t=item.getAuthorName())?"":__t)+'\n\t\t</p>\n\t\t<div class="rating-wrap">\n\t\t\t'+(null==(__t=item.getRatingStars())?"":__t)+'\n\t\t</div>\n\n\t\t<p class="format">\n\t\t\t'+(null==(__t=item.getFormat())?"":__t)+'\n\t\t</p>\n\n\t\t<div class="price-wrap">\n            <p class="price '+(null==(__t=isOmnibusApplicable?"omnibus":"")?"":__t)+'">\n                <span class="sale-price">'+(null==(__t=item.getPrice())?"":__t)+"</span>\n                ",shouldShowDiscountWithOmnibus&&(__p+="\n                    ",isOmnibusApplicable&&(__p+='\n                        <span class="rrp-label">\n                            <a href="/help/topic/HelpId/RRP#helpContent" class="string-to-localize"\n                            data-localizer-string-id="bd_rrp" data-default-localized-pattern="RRP">\n                            </a>:\n                        </span>\n                    '),__p+='\n                    &nbsp;<span class="rrp '+(null==(__t=isOmnibusApplicable?"omnibus":"")?"":__t)+'">'+(null==(__t=item.getRrp())?"":__t)+"</span>\n                "),__p+="\n            </p>\n            ",shouldShowDiscountWithOmnibus&&(__p+="\n               ",isOmnibusApplicable?__p+='\n                  <p class="price-save">\n                     <a href="/help/topic/HelpId/lowestprice#helpContent" class="price-save-link string-to-localize"\n                     data-localizer-string-id="bd_30_day_low_price_carousel" data-default-localized-pattern="30-day low price">\n                     </a>:\n                     <span class="price-save">\n                         '+(null==(__t=item.getHistoricalPrice())?"":__t)+"\n                     </span>\n                  </p>\n               ":__p+='\n                   <p class="price-save">\n                      <span class="string-to-localize" data-localizer-string-id="bd_price_save"\n                         data-parameters=\'{"0":"'+(null==(__t=item.getSavings())?"":__t)+'"}\'\n                         data-default-localized-pattern="Save {0}"></span>\n                   </p>\n               ',__p+="\n            "),__p+='\n        </div>\n\t</div>\n\n\t<div class="item-actions">\n\t\t<div class="btn-wrap">\n\t\t\t<a href="" class="btn btn-sm btn-primary add-to-basket string-to-localize link-to-localize" role="button"\n\t\t\t   data-localizer-string-id="bd_add_to_basket" data-default-localized-pattern="Add to basket"\n\t\t\t   data-ref="'+(null==(__t=meta.getReference())?"":__t)+'" data-isbn="'+(null==(__t=item.getIsbn())?"":__t)+'"></a>\n\t\t</div>\n\t</div>\n</div>'}return __p}},function(t,e,n){(function(e,i){var a=n(24),o=n(25);t.exports=e.View.extend({className:"modal fade",initialize:function(t){if(t.child)this.child=t.child;else{var n=new e.View;n.$el.html(t.template(t.model.attributes)),this.child=n.el}this.size=t.size||"",this.title=t.title||"",this.usePlain=t.usePlain||!1,this.status=t.status||"normal"},open:function(t){this.render().appendTo("body"),this.$el.addClass("status-"+this.status),this.size&&this.$(".modal-dialog").addClass("modal-"+this.size);var e=this;this.$el.on("hidden.bs.modal",function(){e.$el.remove(),e.trigger("hidden"),window.location.hash="",document.querySelector(".page-slide").setAttribute("aria-hidden",!1)}),this.$el.on("shown.bs.modal",function(){i(window).trigger("resize"),e.trigger("open"),e.trapFocus()}),t&&t.isAnnouncementPopup?this.$el.modal({show:!0,keyboard:!1,backdrop:"static"}):this.$el.modal({show:!0,keyboard:!0})},render:function(){return this.usePlain?this.$el.html(o({title:this.title})):this.$el.html(a({title:this.title})),this.$(".modal-body").append(this.child),this.$el},trapFocus:function(){var t=document.querySelector(".modal"),e=t.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]'),n=e[0],i=e[e.length-1];n.focus(),document.querySelector(".page-slide").setAttribute("aria-hidden",!0),t.addEventListener("keydown",function(t){("Tab"===t.key||9===t.keyCode)&&(t.shiftKey?document.activeElement===n&&(i.focus(),t.preventDefault()):document.activeElement===i&&(n.focus(),t.preventDefault()))})}})}).call(e,n(1),n(2))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="modal-dialog">\n  <div class="modal-content">\n    <div class="modal-header">\n      <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true" class="close-text">Close</span>\n          <span aria-hidden="true">&times;</span>\n      </button>\n      <h3 class="modal-title">'+(null==(__t=title)?"":__t)+'</h3>\n    </div>\n    <div class="modal-body">\n      \n    </div>\n  </div>\n</div>';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="modal-dialog">\n  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n  <div class="modal-content-plain">\n    <div class="modal-body">\n\n    </div>\n  </div>\n</div>';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)"undefined"!=typeof errorMessage&&(__p+='\n\t<div class="message-wrap">\n\t\t<div class="message-error">'+(null==(__t=errorMessage)?"":__t)+"</div>\n\t</div>\n"),__p+='\n<span id="basket-total-count" class="string-to-localize" data-parameters=\'{"0":"'+(null==(__t=numItems)?"":__t)+'"}\'\n\t  data-localizer-string-id="bd_js_total_basket_count"\n\t  data-default-localized-pattern="{0, plural,\n\t\t  one {You have &lt;b&gt;&lt;span class=\'item-count\'&gt;1&lt;/span&gt;\n\t\t\t\t&lt;span class=\'item-text\'&gt;item&lt;/span&gt;&lt;/b&gt; in your basket}\n\t\t  other {You have &lt;b&gt;&lt;span class=\'item-count\'&gt;{0}&lt;/span&gt;\n\t\t\t\t\t&lt;span class=\'item-text\'&gt;items&lt;/span&gt;&lt;/b&gt; in your basket}}"></span>\n<br>\n<span id="basket-total-cost" class="string-to-localize" data-parameters=\'{"0":"'+(null==(__t=totalCostWithSymbol)?"":__t)+'"}\'\n\t  data-localizer-string-id="bd_js_total_cost"\n\t  data-default-localized-pattern="Total cost: &lt;b class=\'pink-text big total\'&gt;{0}&lt;/b&gt;"></span>\n<br>\n<br>\n\n<a data-dismiss="modal" class="btn btn-secondary pull-left continue-shopping string-to-localize" role="button"\n   data-localizer-string-id="bd_js_continue_shopping" data-default-localized-pattern="Continue shopping"></a>\n<a href="/basket" class="btn btn-primary pull-right continue-to-basket string-to-localize link-to-localize" role="button"\n   data-localizer-string-id="bd_js_basket_checkout" data-default-localized-pattern="Basket / Checkout"></a>\n';return __p}},function(t,e,n){(function(e,i){n(20);var a=n(23),o=n(28),s=n(21).cdns,d=e.View.extend({events:{"click .content-wrap > div:not(.basket-page) .pop-up-test, .modal .pop-up-test":"showDetails","click .quickView":"showDetails"},initialize:function(t){this.app=t.app,this.stringLocalizer=t.stringLocalizer,this.bookDetailModel=new u,this.listenTo(this.bookDetailModel,"announce",this.popup)},showDetails:function(t){t.preventDefault(),$trigger=i(t.currentTarget);var e=$trigger.data("isbn");$trigger.addClass("loading");this.bookDetailModel.setIsbn(e),this.bookDetailModel.focusTrigger=document.activeElement,this.bookDetailModel.trigger("announce",this.bookDetailModel),$trigger.removeClass("loading")},popup:function(t){var e=this,n=!0===t.get("error")?t.get("errorTitle"):'<div class="quick-view-title">'+this.stringLocalizer.localizeString("bd_js_quick_view","Quick View")+"</div>";this.bookDetailPopup=new r({params:{isbn:t.getIsbn()},baseUrl:this.stringLocalizer.localizedLink("/json/quickView/details"),stringLocalizer:this.stringLocalizer});var i=new a({title:n,child:this.bookDetailPopup.render().el,size:"md",status:!0===t.get("error")?"error":"success",focusTrigger:t.focusTrigger});i.on("hidden",function(){e.bookDetailPopup.el.remove(),e.bookDetailPopup=null}),i.open()}}),r=e.View.extend({classname:"book-details-popup-wrap",initialize:function(t){this.params=t.params,this.url=t.baseUrl,this.stringLocalizer=t.stringLocalizer,this.collection=new c({baseUrl:this.url,params:this.params})},render:function(){return this.$el.empty()&&this.$el.html("<div class='quick-view-info'></div>"),this.collection.fetch({success:function(){this.renderDetails(this.collection.models)}.bind(this)}),this},renderDetails:function(t){var e=this.stringLocalizer.localizeTemplate(o({item:t[0],isOmnibusApplicable:i("#isOmnibusApplicable").length,shouldShowDiscountWithOmnibus:this.shouldShowDiscountWithOmnibus(t[0])}));this.$(".quick-view-info").html(e)},shouldShowDiscountWithOmnibus:function(t){return this.isOmnibusApplicable?t.getHistoricalPrice()&&t.getSavingsPercent():t.getSavingsPercent()}}),u=e.Model.extend({isbn:"",focusTrigger:null,getIsbn:function(){return this.isbn},setIsbn:function(t){this.isbn=t}}),l=e.Model.extend({getUrl:function(){return"/"+this.get("detailUri")},getTitle:function(){var t=this.get("title");return this.get("subTitle")&&(t+=" : "+this.get("subTitle")),t},getAuthorName:function(){return this.get("author")?this.get("author").name:null},getRatingStars:function(){var t=i("<div>").addClass("stars");if(this.get("rating")){var e=parseInt(this.get("rating").starCount);if(e)for(var n=1;n<=5;n++)e>=n?t.append(i("<span>").addClass("star full-star")):e>n-1&&e<n?t.append(i("<span>").addClass("star half-star")):t.append(i("<span>").addClass("star"))}return t.html()},getRatingAverage:function(){var t="";if(this.get("rating")){var e=parseFloat(this.get("rating").average);e&&(t=e.toFixed(2))}return t},getRatingCount:function(){var t="";if(this.get("rating")){var e=parseInt(this.get("rating").count);e&&(t=e)}return t},getRatingsLocalizerKey:function(){var t="";return this.get("rating")&&("GR"===this.get("rating").source?t="bd_ratings_by_goodreads":"AMZ"===this.get("rating").source&&(t="bd_ratings_by_amazon")),t},getRatingsLocalizerPattern:function(){var t="";return this.get("rating")&&("GR"===this.get("rating").source?t="({0, plural, one {{0} rating by Goodreads} other {{0} ratings by Goodreads}})":"AMZ"===this.get("rating").source&&(t="({0, plural, one {{0} rating by Goodreads} other {{0} ratings by Amazon}})")),t},getPrice:function(){return this.get("price")?this.get("price").formattedPrice:null},getHistoricalPrice:function(){return this.get("price")?this.get("price").formattedHistoricalPrice:null},getRrp:function(){var t=this.get("price");return t&&t.rrp>t.price?t.formattedRrp:null},getSavings:function(){return this.get("price")?this.get("price").formattedSaving:null},getSavingsPercent:function(){return this.get("price")&&this.get("price").savingPercent&&this.get("price").savingPercent>10?Math.floor(this.get("price").savingPercent):null},getBuyLocalizerKey:function(){var t="";return this.get("price")&&(t="AVAILABLE"===this.get("price").availability?"bd_add_to_basket":"PRE_ORDER"===this.get("price").availability?"bd_pre_order":"ABE"===this.get("price").availability?"bd_try_abe_books":"bd_notify_me"),t},getBuyLocalizerPattern:function(){var t="";return this.get("price")&&(t="AVAILABLE"===this.get("price").availability?"Add to basket":"PRE_ORDER"===this.get("price").availability?"Pre-order":"ABE"===this.get("price").availability?"Try AbeBooks":"Notify me"),t},getFormat:function(){return this.get("format")},getIsbn:function(){return this.get("isbn")},getImgUrl:function(){return"//"+s[0]+".cloudfront.net/assets/images/book/mid/"+this.get("imagePathSuffix")},getDescription:function(){return this.get("biblio").displayDescription}}),c=e.Collection.extend({model:l,initialize:function(t){this.params=t.params,this.baseUrl=t.baseUrl},url:function(){return this.baseUrl+"?"+i.param(this.params)},parse:function(t){return t.fullItem}});t.exports=d}).call(e,n(1),n(2))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj){var url=item.getUrl(),img_url=item.getImgUrl();__p+='\n\n<div class="item-wrap">\n    <div class="item-block">\n        <div class="item-img">\n            <div class="item-img-content">\n                <a href="'+(null==(__t=url)?"":__t)+'" class="link-to-localize">\n                    <img src="'+(null==(__t=img_url)?"":__t)+'" alt="'+(null==(__t=item.getTitle())?"":__t)+'" class="book-img">\n                    ',shouldShowDiscountWithOmnibus&&(__p+='\n                        <div class="savings-splat string-to-localize" data-localizer-string-id="bd_saving_percent_off"\n                             data-parameters=\'{"0":"'+(null==(__t=item.getSavingsPercent())?"":__t)+'"}\'\n                             data-default-localized-pattern="{0}%&lt;br&gt; off"></div>\n                    '),__p+='\n                </a>\n            </div>\n        </div>\n        <div class="item-info">\n            <h1 class="title">\n                <a href="'+(null==(__t=url)?"":__t)+'" class="link-to-localize">\n                    '+(null==(__t=item.getTitle())?"":__t)+'\n                </a>\n            </h1>\n            <div class="rating-wrap">\n                <span> '+(null==(__t=item.getRatingStars())?"":__t)+' </span>\n                <span type="number"> '+(null==(__t=item.getRatingAverage())?"":__t)+' </span>\n                <span class="string-to-localize" data-parameters=\'{"0":"'+(null==(__t=item.getRatingCount())?"":__t)+'"}\'\n                      data-localizer-string-id="'+(null==(__t=item.getRatingsLocalizerKey())?"":__t)+'>"\n                      data-default-localized-pattern="'+(null==(__t=item.getRatingsLocalizerPattern())?"":__t)+'">\n                </span>\n            </div>\n            <div class="author-info">\n                <span itemprop="author" itemtype="http://schema.org/Person" itemscope="'+(null==(__t=item.getAuthorName())?"":__t)+'">\n                    <a href="" itemprop="url">\n                        <span itemprop="name">\n                            '+(null==(__t=item.getAuthorName())?"":__t)+'\n                        </span>\n                    </a>\n                </span>\n            </div>\n\n        </div>\n        <div class="item-tools">\n            <div class="checkout-tools">\n                <div class="price-info-wrap">\n                    <div class="item-info-wrap">\n                        <div class="price-wrap">\n                            <p class="price item-price-wrap'+(null==(__t=isOmnibusApplicable?"omnibus":"")?"":__t)+'">\n                                <span class="sale-price">'+(null==(__t=item.getPrice())?"":__t)+"</span>\n                                ",shouldShowDiscountWithOmnibus&&(__p+="\n                                    ",isOmnibusApplicable&&(__p+='\n                                        <span class="rrp-label">\n                                            <a href="/help/topic/HelpId/RRP#helpContent" class="string-to-localize"\n                                               data-localizer-string-id="bd_rrp" data-default-localized-pattern="RRP">\n                                            </a>:\n                                        </span>\n                                    '),__p+='\n                                    <span class="list-price '+(null==(__t=isOmnibusApplicable?"omnibus":"")?"":__t)+'">'+(null==(__t=item.getRrp())?"":__t)+"</span>\n                                "),__p+='\n                                <span class="price-save">\n                                    ',shouldShowDiscountWithOmnibus&&(__p+="\n                                        ",isOmnibusApplicable?__p+='\n                                                <a href="/help/topic/HelpId/lowestprice#helpContent" class="price-save-link string-to-localize"\n                                                   data-localizer-string-id="bd_30_day_low_price_carousel" data-default-localized-pattern="30-day low price">\n                                                </a>:\n                                                <span class="price-save">\n                                                    '+(null==(__t=item.getHistoricalPrice())?"":__t)+"\n                                                </span>\n                                        ":__p+='\n                                               <span class="string-to-localize" data-localizer-string-id="bd_price_save"\n                                                      data-parameters=\'{"0":"'+(null==(__t=item.getSavings())?"":__t)+'"}\'\n                                                      data-default-localized-pattern="Save {0}">\n                                               </span>\n                                        ',__p+="\n                                    "),__p+='\n                                </span>\n                            </p>\n                        </div>\n                    </div>\n                </div>\n                <div class="free-delivery-text">\n                    <i class="icon-rocket"></i>\n                    <p class="string-to-localize" data-localizer-string-id="bd_free_delivery" data-default-localized-pattern="Free delivery worldwide"></p>\n                </div>\n\n                <div class="btn-wrap">\n                    <a href="" class="btn btn-sm btn-primary add-to-basket string-to-localize link-to-localize" role="button" type="button"\n                       data-localizer-string-id="'+(null==(__t=item.getBuyLocalizerKey())?"":__t)+'" data-default-localized-pattern="'+(null==(__t=item.getBuyLocalizerPattern())?"":__t)+'"\n                       data-ref="basket/addisbn/isbn13/'+(null==(__t=item.getIsbn())?"":__t)+'" data-dismiss="modal" data-isbn="'+(null==(__t=item.getIsbn())?"":__t)+'">\n                    </a>\n\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="item-description" >\n    <h2 class="string-to-localize" data-localizer-string-id="bd_description" data-default-localized-pattern="Description"></h2>\n    <div class="item-excerpt trunc" data-height="230">\n        '+(null==(__t=item.getDescription())?"":__t)+"\n    </div>\n</div>\n"}return __p}},function(t,e,n){(function(e,i){var a=n(23),o=n(30),s=n(31),d=n(32),r=n(33),u=n(34),l=e.Collection.extend({initialize:function(t){this.stringLocalizer=t.stringLocalizer},url:function(){return this.stringLocalizer.localizedLink("/account/wishlistlist")},parse:function(t){return t.error?(this.trigger("error",t),this.error=t,!1):(this.error=!1,t.items)}}),c=e.View.extend({current_wishlist:null,events:{"click .tab-trigger":"switchTab","submit form.item-form":"processItem"},processItem:function(t){t.preventDefault();var e=i(t.currentTarget).serialize(),n=this;return i.ajax({url:this.stringLocalizer.localizedLink("/account/wishlistItemupdate"),data:e,method:"GET",success:function(t){n.processItemResult.apply(n,[t])}}),!1},processItemResult:function(t){if(!1===t.status)this.addError(t.messageCode,t.message);else{var e=u({id:t.wishlistId,label:t.wishlistLabel}),n=this.stringLocalizer.localizeTemplate(e);this.$el.replaceWith(n)}},addError:function(t,e){var n=this.$(".error");n.length||(n=i('<div class="error-box error"></div>').prependTo(this.el)),n.html(e)},switchTab:function(t){t.preventDefault();var e=i(t.currentTarget),n=this.$(e.data("target"));this.$(".tab.active").removeClass("active"),n.addClass("active")},initialize:function(t){t.current_wishlist&&(this.current_wishlist=t.current_wishlist),this.stringLocalizer=t.stringLocalizer,this.list=new l({stringLocalizer:this.stringLocalizer}),this.listenTo(this.list,"error",this.showErrorModal)},showModal:function(){this.list.error||(this.render(),this.delegateEvents(this.events),this.modal=new a({title:"Add item to wishlist",size:"md",child:this.$el}),this.modal.open())},showErrorModal:function(t){if(400===t.error){var e=o(),n=this.stringLocalizer.localizeTemplate(e);this.modal=new a({title:"Not logged in",size:"sm",child:n}),this.modal.open()}},editNote:function(t){t.attr("disabled","disabled");var e=this,n=t.data("isbn"),i=t.data("wishlist");this.renderNote(n,i,t.html()),this.delegateEvents(this.events),this.modal=new a({title:"Notes",size:"md",child:this.$el}),this.modal.on("open",function(){var t=e.$("textarea");t.focus();var n=t.val();t.val(""),t.val(n)}),this.modal.on("hidden",function(){t.removeAttr("disabled")}),this.modal.open()},addItem:function(t,e){this.current_isbn=t,e.addClass("loading"),this.list.fetch(),this.listenToOnce(this.list,"sync",this.showModal),this.listenToOnce(this.list,"sync",function(){e.removeClass("loading")})},newWishlist:function(){this.renderCreate(),this.delegateEvents(this.events),this.modal=new a({title:"Create new wishlist",size:"md",child:this.$el}),this.modal.open()},renderCreate:function(){var t=d({items:this.list,isbn:this.current_isbn,current_wishlist:this.current_wishlist}),e=this.stringLocalizer.localizeTemplate(t);this.$el.html(e)},renderNote:function(t,e,n){var i=r({isbn:t,text:n,wishlist_id:e}),a=this.stringLocalizer.localizeTemplate(i);this.$el.html(a)},render:function(){var t=this.$el,e=s({items:this.list,isbn:this.current_isbn,current_wishlist:this.current_wishlist}),n=this.stringLocalizer.localizeTemplate(e);t.html(n),null!==t.find("#select-wishlists").val()&&""!==t.find("#select-wishlists").val()||(t.find(".select-wishlists-wrap").hide(),t.find(".btn-add").hide())}});t.exports=c}).call(e,n(1),n(2))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='Please <a href="/account/login?returnAction=addToWishlist" class="link-to-localize">sign in</a> to add item to your wishlists.';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)__p+='<div class="wishlist-wrap">\n\t<div class="tab new-wl ',0==items.length&&(__p+="active"),__p+='">\n\t\t<form class="item-form">\n\t\t\t<input type="hidden" name="isbn13" value="'+(null==(__t=isbn)?"":__t)+'">\n\t\t\t<input type="hidden" name="mainAction" value="createwishlist">\n\t\t\t<div class="form-group">\n\t\t\t\t<label for="">Create new wishlist</label>\n\t\t\t\t<input type="text" class="form-control" name="wishlistLabel" placeholder="Wishlist name">\n\t\t\t</div>\n\t\t\t<div class="form-group clearfix">\n\t\t\t\t',items.length>0&&(__p+='\n\t\t\t\t\t<a class="tab-trigger btn btn-dark-grey" data-target=".existing-wl">Select existing wishlist</a>\n\t\t\t\t'),__p+='\n\t\t\t\t<button type="submit" class="btn btn-primary pull-right">Add</button>\n\t\t\t</div>\n\t\t</form>\n\t</div>\n\n\t<div class="tab existing-wl ',items.length>0&&(__p+=" active"),__p+='">\n\t\t<form class="item-form">\n\t\t\t<input type="hidden" name="isbn13" value="'+(null==(__t=isbn)?"":__t)+'">\n\t\t\t<input type="hidden" name="mainAction" value="add">\n\t\t\t<div class="form-group select-wishlists-wrap">\n\t\t\t\t<label for="">Select wishlist</label>\n\t\t\t\t<select id="select-wishlists" name="wishlistId" class="wishlist-id form-control">\n\t\t\t\t\t',items.forEach(function(t){t.get("id")!=current_wishlist&&(__p+='\n\t\t\t\t\t<option value="'+(null==(__t=t.get("id"))?"":__t)+'" ',t.get("isDefault")&&(__p+=' selected="selected" '),__p+=">"+(null==(__t=t.get("label"))?"":__t)+"</option>\n\t\t\t\t\t")}),__p+='\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t\t<div class="form-group clearfix">\n\t\t\t\t<a class="tab-trigger btn btn-dark-grey" data-target=".new-wl">Create new wishlist</a>\n\t\t\t\t<button type="submit" class="btn btn-primary btn-add pull-right">Add</button>\n\t\t\t</div>\n\t\t</form>\n\t</div>\n</div>';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="wishlist-wrap">\n\t<form action="/account/wishlistupdate" method="post" class="link-to-localize">\n\t\t<input type="hidden" name="mainAction" value="create">\n\t\t<div class="form-group">\n\t\t\t<input type="text" class="form-control" name="label" placeholder="Wishlist name" required maxlength="250">\n\t\t</div>\n\t\t<div class="form-group clearfix">\n\t\t\t<button type="submit" class="btn btn-primary pull-right">Create</button>\n\t\t</div>\n\t</form>\n</div>';return __p}},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="wishlist-wrap">\n\t<div class="messages"></div>\n\t<form action="/account/wishlistItemupdate" method="post" class="link-to-localize">\n\t\t<input type="hidden" name="mainAction" value="update">\n\t\t<input type="hidden" name="isbn13" value="'+__e(isbn)+'">\n\t\t<input type="hidden" name="wishlistId" value="'+__e(wishlist_id)+'">\n\t\t<div class="form-group">\n\t\t\t<textarea name="notes" class="form-control">'+__e(text)+'</textarea>\n\t\t</div>\n\t\t<div class="form-group clearfix">\n\t\t\t<button type="submit" class="btn btn-primary pull-right">Save</button>\n\t\t</div>\n\t</form>\n</div>';return __p}}).call(exports,__webpack_require__(3))},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+="Item added to <b>"+(null==(__t=label)?"":__t)+'</b>\n<div class="clearfix">\n\t<a href="/account/wishlist?wishlistId='+__e(id)+'" class="btn btn-primary pull-right link-to-localize">Go to '+(null==(__t=label)?"":__t)+"</a>\n</div>\n\n";return __p}}).call(exports,__webpack_require__(3))},function(t,e,n){(function(e,i){var a=n(23),o=n(36),s=n(37),d=e.Model.extend({});function r(t){var e=i("<div/>").html(s(t.attributes)),n=e.find("div.modal-heading").html(),o=e.find("div.modal-text");new a({title:n,size:"sm",child:o}).open()}var u=e.View.extend({events:{"submit form":"signUp"},initialize:function(){this.form=this.$el.find("form"),this.endpointUrl=this.form.attr("action"),this.counter=new o},signUp:function(t){this.counter.count("newsletterSubmit"),t.preventDefault();var e=this;i.ajax({url:this.endpointUrl,method:"GET",data:this.form.serialize(),success:function(t){switch(r(new d(t)),t.outcome){case 0:e.counter.count("newsletterInvalidEmail");break;case 1:e.counter.count("newsletterSuccess");break;case 2:e.counter.count("newsletterAlreadySubscribed")}e.form[0].reset()},error:function(){r(new d({outcome:-1})),e.counter.count("newsletterUnsuccessfulRequest")}})}});t.exports=u}).call(e,n(1),n(2))},function(t,e,n){(function(e,n){var i=e.View.extend({el:"body",events:{"click .rating-wrap a":"logClickRatingStars","click .content-wrap .sidebar a":"logHomePageSideBarClick","click .tbd-dropdown-menu.dropdown-menu a":"logGlobalDropdownClick"},initialize:function(){var t=this;n("[data-counter]").each(function(){var e=n(this).data("counter");e.length>1&&t.count(e)})},logClickRatingStars:function(){this.count("clickRatingStars")},logHomePageSideBarClick:function(){n("body").hasClass("page-type-home")&&this.count("sideBarClick")},logGlobalDropdownClick:function(){this.count("clickGlobalDropdownClick")},logMobileJacketLightboxClick:function(){this.count("clickJacketLightbox")},count:function(t){window.ue&&window.ue.count(t,1)}});t.exports=i}).call(e,n(1),n(2))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)0==outcome&&(__p+='\n  <div class="modal-heading">\n\t\tError signing up to newsletter\n\t</div>\n\t<div class="modal-text red-text">\n\t\tSorry that isn\'t a valid e-mail address, please try again.\n\t</div>\n'),__p+="\n\n",1==outcome&&(__p+='\n  <div class="modal-heading">\n\t\tSigned up to newsletter\n\t</div>\n\t<div class="modal-text green-text">\n\t\tThank you - we\'ve added you to the newsletter.\n\t</div>\n'),__p+="\n\n",2==outcome&&(__p+='\n  <div class="modal-heading">\n\t\tYoure already signed up\n\t</div>\n\t<div class="modal-text red-text">\n\t\t If you\'d like to edit your contact preferences, please go to your account.\n\t</div>\n'),__p+="\n\n",-1==outcome&&(__p+='\n  <div class="modal-heading">\n\t\tError signing up to newsletter\n\t</div>\n\t<div class="modal-text red-text">\n\t\tIt looks like we can\'t process your request at the moment. Please try again later.\n\t</div>\n'),__p+="\n";return __p}},function(t,e,n){(function(e,n){var i=e.View.extend({events:{"click #captcha-refresh-button":"newCaptcha"},initialize:function(){var t=this;this.image=this.$el.find("#captcha-image"),this.imageParent=this.image.parent(),this.tokenField=this.$el.find("#captcha-token"),this.image.on("load",function(){t.removeLoadingSpinner()})},removeLoadingSpinner:function(){this.imageParent.removeClass("loading")},addLoadingSpinner:function(){this.imageParent.addClass("loading")},newCaptcha:function(t){t.preventDefault();var e=t.target.href,i=this;this.addLoadingSpinner(),n.ajax({url:e,method:"POST",success:function(t){i.image.attr("src",t.source),i.image.attr("width",t.width),i.image.attr("height",t.height),i.tokenField.val(t.token)}})}});t.exports=i}).call(e,n(1),n(2))},function(t,e,n){(function(e,i){n(40);var a=n(3),o=n(41);cdnList=n(21).cdns;var s=e.Model.extend({url:function(){return this.base_url+"?searchTerm="+d(this.get("keyword"))},parse:function(t){return t.content}}),d=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16)})},r=e.View.extend({events:{"keyup .text-input":"keypress","click .suggest-book-wrap":"bookClick","click .bg-screen":"reset"},bookClick:function(t){location.href=i(t.currentTarget).data("url")},initialize:function(t){this.stringLocalizer=t.stringLocalizer,this.$input=this.$(".text-input"),this.$("form").attr("autocomplete","off"),this.model=new s,this.model.base_url=this.$el.data("url"),this.listenTo(this.model,"change:keyword",this.textChange),this.listenTo(this.model,"change:suggestBooks",this.booksChange),this.listenTo(this.model,"change:suggestSearch",this.searchChange),this._screen=this.$el.append("<div class='bg-screen'></div>"),this.render()},showScreen:function(){this.$(".bg-screen").hasClass("active")||this.$(".bg-screen").addClass("active")},hideScreen:function(){this.$(".bg-screen").hasClass("active")&&(this.$(".bg-screen").removeClass("active"),this.$result.addClass("no-result"))},reset:function(){this.$bookresult.empty(),this.$suggestresult.empty(),this.$options&&this.$options.empty(),this.hideScreen(),this._clearSelectedOption()},render:function(){this.$bookresult=i("<div class='book-result'></div>"),this.$suggestresult=i("<div class='suggest-result'></div>"),this.$result=i("<div class='result-wrap no-result'></div>"),this.$suggestresult.appendTo(this.$result),this.$bookresult.appendTo(this.$result),this.$result.insertAfter(this.$(".header-search-el-wrap"))},booksChange:function(t){this.$bookresult.empty(),a.each(t.get("suggestBooks"),function(t,e){t.isbn=t.books[0].isbn13,t.slug=t.title.replace(/[^a-z0-9]/gi,"-"),t.cdn=cdnList[Math.floor(Math.random()*cdnList.length)];var n=this.stringLocalizer.localizeTemplate(o(t));this.$bookresult.append("<div class='suggestion suggest-book'>"+n+"</div>")},this),this._optionsChanged()},searchChange:function(t){this.$suggestresult.empty();var e=t.get("suggestSearch");e.length>0?(this.$result.removeClass("no-result"),this.showScreen()):(this.$result.addClass("no-result"),this.hideScreen()),a.each(e,function(t,e){var n=i("<a class='suggestion suggest-word'>"+t+"</a>");n.attr("href",this.stringLocalizer.localizedLink("/search?searchTerm="+d(n.text())+"&search=Find+book")),this.$suggestresult.append(n)},this),this._optionsChanged()},textChange:function(){this.model.get("keyword").length>1?this.model.fetch():this.reset()},_optionsChanged:function(){this.$options=this.$el.find(".suggest-result a, .book-result .suggestion"),this.$selectedOption=null},keypress:function(t){13==t.keyCode?this.$selectedOption&&(this.$selectedOption.is("a")?this.$selectedOption.click():this.$selectedOption.find("h4 a").first().click()):27==t.keyCode?this.reset():38==t.keyCode?this._moveToOption(-1):40==t.keyCode?this._moveToOption(1):this.model.set("keyword",this.$input.val())},_moveToOption:function(t){if((!(t<0)||this.$selectedOption)&&(this.$selectedOption&&this.$selectedOption.removeClass("selected"),this.$options)){var e=0;this.$selectedOption&&(e=this.$options.index(this.$selectedOption)+t),e<0?this._clearSelectedOption():e>=this.$options.size()?this._selectOption(i(this.$options.get(this.$options.size()-1))):this._selectOption(i(this.$options.get(e)))}},_selectOption:function(t){var e;this.$selectedOption=t,this.$selectedOption.addClass("selected"),e=this.$selectedOption.is("a")?this.$selectedOption.text():this.$selectedOption.find("h4 a").first().text(),this.$input.val(e.trim())},_clearSelectedOption:function(){this.$selectedOption&&(this.$selectedOption.removeClass("selected"),this.$selectedOption=null)}});t.exports=r}).call(e,n(1),n(2))},function(t,e){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}},function(module,exports,__webpack_require__){(function(_){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;function print(){__p+=__j.call(arguments,"")}with(obj)__p+='<div class="suggest-book-wrap link-to-localize" data-url="/'+__e(slug)+"/"+__e(isbn)+'">\n\t<div class="book-img-wrap">\n\t\t<a href="/'+__e(slug)+"/"+__e(isbn)+'" class="suggest-link-block link-to-localize">\n\t\t\t<img src="https://'+__e(cdn)+".cloudfront.net/assets/images/book/sml/"+__e(isbn.substr(0,4))+"/"+__e(isbn.substr(4,4))+"/"+__e(isbn)+'.jpg" alt="'+__e(title)+'">\n\t\t</a>\n\t</div>\n\t<div class="book-content-wrap">\n\t\t<h4><a href="/'+__e(slug)+"/"+__e(isbn)+'" class="link-to-localize">'+__e(title)+"</a></h4>\n\t\t",contributors.length>0&&(__p+='\n            <p class="author">by '+__e(contributors)+"</p>\n        "),__p+='\n\t\t<ul class="formats">\n\t\t\t',books.forEach(function(t){__p+='\n\t\t\t\t<li><a href="/'+__e(slug)+"/"+__e(t.isbn13)+'" class="link-to-localize">'+__e(t.format)+"</a></li>\n\t\t\t"}),__p+="\n\t\t</ul>\n\t</div>\n</div>";return __p}}).call(exports,__webpack_require__(3))},function(t,e,n){(function(e,i){n(40),n(43),n(19),n(4);var a=n(44),o=n(36),s=e.View.extend({events:{"blur .validate":"validateField"},emailRegex:"^[\\p{L}\\p{N}\\._%+-]+@[\\p{L}\\p{N}\\.\\-]+\\.[\\p{L}]{2,}$",fullNameRegex:"^(?=.*[\\p{L}])[\\p{L}\\s',.\\-]*$",initialize:function(t){this.counter=new o,this.stringLocalizer=t.stringLocalizer;var e=this.stringLocalizer.localizeString("bd_js_enter_valid_email_address","Please enter a valid email address"),n=this.stringLocalizer.localizeString("bd_js_too_long","Sorry, that's too long"),a=this.stringLocalizer.localizeString("bd_js_name_only_letters","Sorry, full name can only contain letters"),s=this.stringLocalizer.localizeString("bd_js_enter_first_last_name","Please enter a first and last name");this.emailValidations={},this.emailValidations.mandatory=!0,this.emailValidations.validation=[{regex:"emailAddress",message:e}],this.emailValidations.tooLongMessage=n,this.emailValidations.maxLength=50,this.fullNameValidation={},this.fullNameValidation.mandatory=!0,this.fullNameValidation.validation=[{regex:this.fullNameRegex,message:a}],this.fullNameValidation.fieldEmptyMessage=s,this.fullNameValidation.maxLength=50,i(".no-delivery-country-selected #hasSubmittedSameAddresses").click(function(t){t.preventDefault()})},validateField:function(t){var e=i(t.currentTarget),n=this._validate(e);this._clearMinimalAddresses(e),n.length>0?this._showErrors(e,n):(this._clearErrors(e),this._copyEmailAddress(e))},_clearErrors:function(t){t.removeClass("checkout-error"),t.next(".error-block").html("")},_showErrors:function(t,e){t.addClass("checkout-error"),t.next(".error-block").html(e.join(". "))},_validate:function(t){var e=[],n=this._getFieldValidations(t);return this._validateLength(t,n,e),0==e.length&&this._validateWWW(t,e),0==e.length&&this._validateFieldValue(t,n,e),e},_getFieldValidations:function(t){var e=t.data("field-name");return"emailAddr"==e?this.emailValidations:"fullName"==e?this.fullNameValidation:("delivery"==t.data("addr-type")?getDeliveryValidations():getBillingValidations())[e]},_validateLength:function(t,e,n){var a=this.stringLocalizer.localizeString("bd_js_please_enter_your","Please enter your"),o=this.stringLocalizer.localizeString("bd_js_too_long_for_shipping_label","Sorry, that's too long for our shipping labels"),s=t.val().trim();if(e.mandatory&&0==s.length){var d=i("label[for='"+t.attr("name")+"']");if(e.fieldEmptyMessage)n.push(e.fieldEmptyMessage);else{var r=this._getLabelForErrorMsg(d.text());n.push(a+" "+r)}}else e.maxLength&&s.length>e.maxLength&&(e.tooLongMessage?n.push(e.tooLongMessage):n.push(o),this.counter.count("clientSideValidationFieldTooLong"))},_getLabelForErrorMsg:function(t){return t.toLowerCase().replace("zip","ZIP")},_validateWWW:function(t,e){var n=t.val().trim();if(n.startsWith("www")||n.startsWith("http")){var a=i("label[for='"+t.attr("name")+"']");e.push(a.text()+" format is invalid")}},_validateFieldValue:function(t,e,n){var i=this,o=t.val().trim();if(o.length>0){var s=e.validation;s&&s.forEach(function(t){("emailAddress"==t.regex?a.cache(i.emailRegex):i._createRegex(t.regex)).test(o)||(this.counter.count("clientSideValidationInvalidField"),n.push(t.message))})}},_createRegex:function(t){return-1!=t.indexOf("(?i)")||-1!=t.indexOf("(?-i)")?a.cache(t.replace("(?i)","").replace("(?-i)",""),"i"):a.cache(t)},_clearMinimalAddresses:function(t){if(this._isMinimalAddress(t)){var e=this;this._fetchMinimalAddresses(t).map(function(n){var a=i("#"+n+" input");n==t.attr("name")||a.val()||e._clearErrors(a)})}},_isMinimalAddress:function(t){return this._getFieldValidations(t).minimalAddress},_fetchMinimalAddresses:function(t){return"delivery"==t.data("addr-type")?getDeliveryMinimalAddresses():getBillingMinimalAddresses()},_copyEmailAddress:function(t){if("emailAddr"==t.data("field-name")){var e=i("#delivery-emailAddress .validate");e.length&&0==e.val().length&&(e.val(t.val()),this._clearErrors(e))}}});t.exports=s}).call(e,n(1),n(2))},function(t,e){Array.prototype.forEach=function(t){if(void 0===this||null===this)throw new TypeError(this+"is not an object");if(!(t instanceof Function))throw new TypeError(t+" is not a function");for(var e=Object(this),n=arguments[1],i=e instanceof String?e.split(""):e,a=Math.max(Math.min(i.length,9007199254740991),0)||0,o=-1;++o<a;)o in i&&t.call(n,i[o],o,e)}},function(t,e,n){var i=n(45);n(46)(i),n(47)(i),n(48)(i),n(49)(i),n(50)(i),n(51)(i),n(52)(i),t.exports=i},function(t,e){
/*!
	 * XRegExp 3.1.1
	 * <xregexp.com>
	 * Steven Levithan (c) 2007-2016 MIT License
	 */
"use strict";var n="xregexp",i={astral:!1,natives:!1},a={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},o={},s={},d={},r=[],u="default",l="class",c={default:/\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u(?:[\dA-Fa-f]{4}|{[\dA-Fa-f]+})|c[A-Za-z]|[\s\S])|\(\?(?:[:=!]|<[=!])|[?*+]\?|{\d+(?:,\d*)?}\??|[\s\S]/,class:/\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u(?:[\dA-Fa-f]{4}|{[\dA-Fa-f]+})|c[A-Za-z]|[\s\S])|[\s\S]/},h=/\$(?:{([\w$]+)}|(\d\d?|[\s\S]))/g,f=void 0===a.exec.call(/()??/,"")[1],p=void 0!==/x/.flags,m={}.toString;function _(t){var e=!0;try{new RegExp("",t)}catch(t){e=!1}return e&&"y"===t?new RegExp("aa|.","y").test("b"):e}var g=_("u"),v=_("y"),b={g:!0,i:!0,m:!0,u:g,y:v};function y(t,e,i,a,o){var s;if(t[n]={captureNames:e},o)return t;if(t.__proto__)t.__proto__=O.prototype;else for(s in O.prototype)t[s]=O.prototype[s];return t[n].source=i,t[n].flags=a?a.split("").sort().join(""):a,t}function w(t){return a.replace.call(t,/([\s\S])(?=[\s\S]*\1)/g,"")}function x(t,e){if(!O.isRegExp(t))throw new TypeError("Type RegExp expected");var i=t[n]||{},o=function(t){return p?t.flags:a.exec.call(/\/([a-z]*)$/i,RegExp.prototype.toString.call(t))[1]}(t),s="",d="",r=null,u=null;return(e=e||{}).removeG&&(d+="g"),e.removeY&&(d+="y"),d&&(o=a.replace.call(o,new RegExp("["+d+"]+","g"),"")),e.addG&&(s+="g"),e.addY&&(s+="y"),s&&(o=w(o+s)),e.isInternalOnly||(void 0!==i.source&&(r=i.source),null!=i.flags&&(u=s?w(i.flags+s):i.flags)),t=y(new RegExp(t.source,o),function(t){return!(!t[n]||!t[n].captureNames)}(t)?i.captureNames.slice(0):null,r,u,e.isInternalOnly)}function L(t){return parseInt(t,16)}function P(t){return parseInt(t,10).toString(16)}function C(t,e){var n,i=t.length;for(n=0;n<i;++n)if(t[n]===e)return n;return-1}function S(t,e){return m.call(t)==="[object "+e+"]"}function E(t,e,n){return a.test.call(n.indexOf("x")>-1?/^(?:\s|#[^#\n]*|\(\?#[^)]*\))*(?:[?*+]|{\d+(?:,\d*)?})/:/^(?:\(\?#[^)]*\))*(?:[?*+]|{\d+(?:,\d*)?})/,t.slice(e))}function k(t){for(;t.length<4;)t="0"+t;return t}function T(t){var e={};return S(t,"String")?(O.forEach(t,/[^\s,]+/,function(t){e[t]=!0}),e):t}function I(t){if(!/^[\w$]$/.test(t))throw new Error("Flag must be a single character A-Za-z0-9_$");b[t]=!0}function M(t,e,n,i,a){for(var o,s,d=r.length,u=t.charAt(n),l=null;d--;)if(!((s=r[d]).leadChar&&s.leadChar!==u||s.scope!==i&&"all"!==s.scope||s.flag&&-1===e.indexOf(s.flag))&&(o=O.exec(t,s.regex,n,"sticky"))){l={matchLength:o[0].length,output:s.handler.call(a,o,i,e),reparse:s.reparse};break}return l}function D(t){i.astral=t}function A(t){RegExp.prototype.exec=(t?o:a).exec,RegExp.prototype.test=(t?o:a).test,String.prototype.match=(t?o:a).match,String.prototype.replace=(t?o:a).replace,String.prototype.split=(t?o:a).split,i.natives=t}function z(t){if(null==t)throw new TypeError("Cannot convert null or undefined to object");return t}function O(t,e){if(O.isRegExp(t)){if(void 0!==e)throw new TypeError("Cannot supply flags when copying a RegExp");return x(t)}if(t=void 0===t?"":String(t),e=void 0===e?"":String(e),O.isInstalled("astral")&&-1===e.indexOf("A")&&(e+="A"),d[t]||(d[t]={}),!d[t][e]){for(var n,i={hasNamedCapture:!1,captureNames:[]},o=u,s="",r=0,h=function(t,e){var n;if(w(e)!==e)throw new SyntaxError("Invalid duplicate regex flag "+e);for(t=a.replace.call(t,/^\(\?([\w$]+)\)/,function(t,n){if(a.test.call(/[gy]/,n))throw new SyntaxError("Cannot use flag g or y in mode modifier "+t);return e=w(e+n),""}),n=0;n<e.length;++n)if(!b[e.charAt(n)])throw new SyntaxError("Unknown regex flag "+e.charAt(n));return{pattern:t,flags:e}}(t,e),f=h.pattern,p=h.flags;r<f.length;){do{(n=M(f,p,r,o,i))&&n.reparse&&(f=f.slice(0,r)+n.output+f.slice(r+n.matchLength))}while(n&&n.reparse);if(n)s+=n.output,r+=n.matchLength||1;else{var m=O.exec(f,c[o],r,"sticky")[0];s+=m,r+=m.length,"["===m&&o===u?o=l:"]"===m&&o===l&&(o=u)}}d[t][e]={pattern:a.replace.call(s,/(?:\(\?:\))+/g,"(?:)"),flags:a.replace.call(p,/[^gimuy]+/g,""),captures:i.hasNamedCapture?i.captureNames:null}}var _=d[t][e];return y(new RegExp(_.pattern,_.flags),_.captures,t,e)}O.prototype=new RegExp,O.version="3.1.1",O._hasNativeFlag=_,O._dec=L,O._hex=P,O._pad4=k,O.addToken=function(t,e,n){var i,o=(n=n||{}).optionalFlags;if(n.flag&&I(n.flag),o)for(o=a.split.call(o,""),i=0;i<o.length;++i)I(o[i]);r.push({regex:x(t,{addG:!0,addY:v,isInternalOnly:!0}),handler:e,scope:n.scope||u,flag:n.flag,reparse:n.reparse,leadChar:n.leadChar}),O.cache.flush("patterns")},O.cache=function(t,e){return s[t]||(s[t]={}),s[t][e]||(s[t][e]=O(t,e))},O.cache.flush=function(t){"patterns"===t?d={}:s={}},O.escape=function(t){return a.replace.call(z(t),/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},O.exec=function(t,e,i,a){var s,d,r,u="g";return(s=v&&!!(a||e.sticky&&!1!==a))&&(u+="y"),e[n]=e[n]||{},(r=e[n][u]||(e[n][u]=x(e,{addG:!0,addY:s,removeY:!1===a,isInternalOnly:!0}))).lastIndex=i=i||0,d=o.exec.call(r,t),a&&d&&d.index!==i&&(d=null),e.global&&(e.lastIndex=d?r.lastIndex:0),d},O.forEach=function(t,e,n){for(var i,a=0,o=-1;i=O.exec(t,e,a);)n(i,++o,t,e),a=i.index+(i[0].length||1)},O.globalize=function(t){return x(t,{addG:!0})},O.install=function(t){t=T(t),!i.astral&&t.astral&&D(!0),!i.natives&&t.natives&&A(!0)},O.isInstalled=function(t){return!!i[t]},O.isRegExp=function(t){return"[object RegExp]"===m.call(t)},O.match=function(t,e,i){var o,s,d=e.global&&"one"!==i||"all"===i,r=(d?"g":"")+(e.sticky?"y":"")||"noGY";return e[n]=e[n]||{},s=e[n][r]||(e[n][r]=x(e,{addG:!!d,removeG:"one"===i,isInternalOnly:!0})),o=a.match.call(z(t),s),e.global&&(e.lastIndex="one"===i&&o?o.index+o[0].length:0),d?o||[]:o&&o[0]},O.matchChain=function(t,e){return function t(n,i){var a=e[i].regex?e[i]:{regex:e[i]},o=[];function s(t){if(a.backref){if(!(t.hasOwnProperty(a.backref)||+a.backref<t.length))throw new ReferenceError("Backreference to undefined group: "+a.backref);o.push(t[a.backref]||"")}else o.push(t[0])}for(var d=0;d<n.length;++d)O.forEach(n[d],a.regex,s);return i!==e.length-1&&o.length?t(o,i+1):o}([t],0)},O.replace=function(t,e,i,a){var s,d=O.isRegExp(e),r=e.global&&"one"!==a||"all"===a,u=(r?"g":"")+(e.sticky?"y":"")||"noGY",l=e;return d?(e[n]=e[n]||{},l=e[n][u]||(e[n][u]=x(e,{addG:!!r,removeG:"one"===a,isInternalOnly:!0}))):r&&(l=new RegExp(O.escape(String(e)),"g")),s=o.replace.call(z(t),l,i),d&&e.global&&(e.lastIndex=0),s},O.replaceEach=function(t,e){var n,i;for(n=0;n<e.length;++n)i=e[n],t=O.replace(t,i[0],i[1],i[2]);return t},O.split=function(t,e,n){return o.split.call(z(t),e,n)},O.test=function(t,e,n,i){return!!O.exec(t,e,n,i)},O.uninstall=function(t){t=T(t),i.astral&&t.astral&&D(!1),i.natives&&t.natives&&A(!1)},O.union=function(t,e){var i,o,s=0;function d(t,e,n){var a=o[s-i];if(e){if(++s,a)return"(?<"+a+">"}else if(n)return"\\"+(+n+i);return t}if(!S(t,"Array")||!t.length)throw new TypeError("Must provide a nonempty array of patterns to merge");for(var r,u=/(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*]/g,l=[],c=0;c<t.length;++c)r=t[c],O.isRegExp(r)?(i=s,o=r[n]&&r[n].captureNames||[],l.push(a.replace.call(O(r.source).source,u,d))):l.push(O.escape(r));return O(l.join("|"),e)},o.exec=function(t){var e,i,o,s=this.lastIndex,d=a.exec.apply(this,arguments);if(d){if(!f&&d.length>1&&C(d,"")>-1&&(i=x(this,{removeG:!0,isInternalOnly:!0}),a.replace.call(String(t).slice(d.index),i,function(){var t,e=arguments.length;for(t=1;t<e-2;++t)void 0===arguments[t]&&(d[t]=void 0)})),this[n]&&this[n].captureNames)for(o=1;o<d.length;++o)(e=this[n].captureNames[o-1])&&(d[e]=d[o]);this.global&&!d[0].length&&this.lastIndex>d.index&&(this.lastIndex=d.index)}return this.global||(this.lastIndex=s),d},o.test=function(t){return!!o.exec.call(this,t)},o.match=function(t){var e;if(O.isRegExp(t)){if(t.global)return e=a.match.apply(this,arguments),t.lastIndex=0,e}else t=new RegExp(t);return o.exec.call(t,z(this))},o.replace=function(t,e){var i,o,s,d=O.isRegExp(t);return d?(t[n]&&(o=t[n].captureNames),i=t.lastIndex):t+="",s=S(e,"Function")?a.replace.call(String(this),t,function(){var n,i=arguments;if(o)for(i[0]=new String(i[0]),n=0;n<o.length;++n)o[n]&&(i[0][o[n]]=i[n+1]);return d&&t.global&&(t.lastIndex=i[i.length-2]+i[0].length),e.apply(void 0,i)}):a.replace.call(null==this?this:String(this),t,function(){var t=arguments;return a.replace.call(String(e),h,function(e,n,i){var a;if(n){if((a=+n)<=t.length-3)return t[a]||"";if((a=o?C(o,n):-1)<0)throw new SyntaxError("Backreference to undefined group "+e);return t[a+1]||""}if("$"===i)return"$";if("&"===i||0==+i)return t[0];if("`"===i)return t[t.length-1].slice(0,t[t.length-2]);if("'"===i)return t[t.length-1].slice(t[t.length-2]+t[0].length);if(i=+i,!isNaN(i)){if(i>t.length-3)throw new SyntaxError("Backreference to undefined group "+e);return t[i]||""}throw new SyntaxError("Invalid token "+e)})}),d&&(t.global?t.lastIndex=0:t.lastIndex=i),s},o.split=function(t,e){if(!O.isRegExp(t))return a.split.apply(this,arguments);var n,i=String(this),o=[],s=t.lastIndex,d=0;return e=(void 0===e?-1:e)>>>0,O.forEach(i,t,function(t){t.index+t[0].length>d&&(o.push(i.slice(d,t.index)),t.length>1&&t.index<i.length&&Array.prototype.push.apply(o,t.slice(1)),n=t[0].length,d=t.index+n)}),d===i.length?a.test.call(t,"")&&!n||o.push(""):o.push(i.slice(d)),t.lastIndex=s,o.length>e?o.slice(0,e):o},O.addToken(/\\([ABCE-RTUVXYZaeg-mopqyz]|c(?![A-Za-z])|u(?![\dA-Fa-f]{4}|{[\dA-Fa-f]+})|x(?![\dA-Fa-f]{2}))/,function(t,e){if("B"===t[1]&&e===u)return t[0];throw new SyntaxError("Invalid escape "+t[0])},{scope:"all",leadChar:"\\"}),O.addToken(/\\u{([\dA-Fa-f]+)}/,function(t,e,n){var i=L(t[1]);if(i>1114111)throw new SyntaxError("Invalid Unicode code point "+t[0]);if(i<=65535)return"\\u"+k(P(i));if(g&&n.indexOf("u")>-1)return t[0];throw new SyntaxError("Cannot use Unicode code point above \\u{FFFF} without flag u")},{scope:"all",leadChar:"\\"}),O.addToken(/\[(\^?)]/,function(t){return t[1]?"[\\s\\S]":"\\b\\B"},{leadChar:"["}),O.addToken(/\(\?#[^)]*\)/,function(t,e,n){return E(t.input,t.index+t[0].length,n)?"":"(?:)"},{leadChar:"("}),O.addToken(/\s+|#[^\n]*\n?/,function(t,e,n){return E(t.input,t.index+t[0].length,n)?"":"(?:)"},{flag:"x"}),O.addToken(/\./,function(){return"[\\s\\S]"},{flag:"s",leadChar:"."}),O.addToken(/\\k<([\w$]+)>/,function(t){var e=isNaN(t[1])?C(this.captureNames,t[1])+1:+t[1],n=t.index+t[0].length;if(!e||e>this.captureNames.length)throw new SyntaxError("Backreference to undefined group "+t[0]);return"\\"+e+(n===t.input.length||isNaN(t.input.charAt(n))?"":"(?:)")},{leadChar:"\\"}),O.addToken(/\\(\d+)/,function(t,e){if(!(e===u&&/^[1-9]/.test(t[1])&&+t[1]<=this.captureNames.length)&&"0"!==t[1])throw new SyntaxError("Cannot use octal escape or backreference to undefined group "+t[0]);return t[0]},{scope:"all",leadChar:"\\"}),O.addToken(/\(\?P?<([\w$]+)>/,function(t){if(!isNaN(t[1]))throw new SyntaxError("Cannot use integer as capture name "+t[0]);if("length"===t[1]||"__proto__"===t[1])throw new SyntaxError("Cannot use reserved word as capture name "+t[0]);if(C(this.captureNames,t[1])>-1)throw new SyntaxError("Cannot use same name for multiple groups "+t[0]);return this.captureNames.push(t[1]),this.hasNamedCapture=!0,"("},{leadChar:"("}),O.addToken(/\((?!\?)/,function(t,e,n){return n.indexOf("n")>-1?"(?:":(this.captureNames.push(null),"(")},{optionalFlags:"n",leadChar:"("}),t.exports=O},function(t,e){
/*!
	 * XRegExp.build 3.1.1
	 * <xregexp.com>
	 * Steven Levithan (c) 2012-2016 MIT License
	 * Inspired by Lea Verou's RegExp.create <lea.verou.me>
	 */
t.exports=function(t){"use strict";var e="xregexp",n=/(\()(?!\?)|\\([1-9]\d*)|\\[\s\S]|\[(?:[^\\\]]|\\[\s\S])*]/g,i=t.union([/\({{([\w$]+)}}\)|{{([\w$]+)}}/,n],"g");function a(t){var e=/^(?:\(\?:\))*\^/,n=/\$(?:\(\?:\))*$/;return e.test(t)&&n.test(t)&&n.test(t.replace(/\\[\s\S]/g,""))?t.replace(e,"").replace(n,""):t}function o(n){return t.isRegExp(n)?n[e]&&n[e].captureNames?n:t(n.source):t(n)}t.build=function(s,d,r){var u,l,c,h,f=/^\(\?([\w$]+)\)/.exec(s),p={},m=0,_=0,g=[0];for(h in f&&(r=r||"",f[1].replace(/./g,function(t){r+=r.indexOf(t)>-1?"":t})),d)d.hasOwnProperty(h)&&(c=o(d[h]),p[h]={pattern:a(c.source),names:c[e].captureNames||[]});return s=o(s),l=s[e].captureNames||[],s=s.source.replace(i,function(t,e,i,a,o){var s,d,r,c=e||i;if(c){if(!p.hasOwnProperty(c))throw new ReferenceError("Undefined property "+t);return e?(s=l[_],g[++_]=++m,d="(?<"+(s||c)+">"):d="(?:",u=m,d+p[c].pattern.replace(n,function(t,e,n){if(e){if(s=p[c].names[m-u],++m,s)return"(?<"+s+">"}else if(n)return r=+n-1,p[c].names[r]?"\\k<"+p[c].names[r]+">":"\\"+(+n+u);return t})+")"}if(a){if(s=l[_],g[++_]=++m,s)return"(?<"+s+">"}else if(o)return l[r=+o-1]?"\\k<"+l[r]+">":"\\"+g[+o];return t}),t(s,r)}}},function(t,e){
/*!
	 * XRegExp.matchRecursive 3.1.1
	 * <xregexp.com>
	 * Steven Levithan (c) 2009-2016 MIT License
	 */
t.exports=function(t){"use strict";function e(t,e,n,i){return{name:t,value:e,start:n,end:i}}t.matchRecursive=function(n,i,a,o,s){o=o||"",s=s||{};var d,r,u,l,c,h=o.indexOf("g")>-1,f=o.indexOf("y")>-1,p=o.replace(/y/g,""),m=s.escapeChar,_=s.valueNames,g=[],v=0,b=0,y=0,w=0;if(i=t(i,p),a=t(a,p),m){if(m.length>1)throw new Error("Cannot use more than one escape character");m=t.escape(m),c=new RegExp("(?:"+m+"[\\S\\s]|(?:(?!"+t.union([i,a]).source+")[^"+m+"])+)+",o.replace(/[^imu]+/g,""))}for(;;){if(m&&(y+=(t.exec(n,c,y,"sticky")||[""])[0].length),u=t.exec(n,i,y),l=t.exec(n,a,y),u&&l&&(u.index<=l.index?l=null:u=null),u||l)y=(b=(u||l).index)+(u||l)[0].length;else if(!v)break;if(f&&!v&&b>w)break;if(u)v||(d=b,r=y),++v;else{if(!l||!v)throw new Error("Unbalanced delimiter found in string");if(!--v&&(_?(_[0]&&d>w&&g.push(e(_[0],n.slice(w,d),w,d)),_[1]&&g.push(e(_[1],n.slice(d,r),d,r)),_[2]&&g.push(e(_[2],n.slice(r,b),r,b)),_[3]&&g.push(e(_[3],n.slice(b,y),b,y))):g.push(n.slice(r,b)),w=y,!h))break}b===y&&++y}return h&&!f&&_&&_[0]&&n.length>w&&g.push(e(_[0],n.slice(w),w,n.length)),g}}},function(t,e){
/*!
	 * XRegExp Unicode Base 3.1.1
	 * <xregexp.com>
	 * Steven Levithan (c) 2008-2016 MIT License
	 */
t.exports=function(t){"use strict";var e={},n=t._dec,i=t._hex,a=t._pad4;function o(t){return t.replace(/[- _]+/g,"").toLowerCase()}function s(t){var e=/^\\[xu](.+)/.exec(t);return e?n(e[1]):t.charCodeAt("\\"===t.charAt(0)?1:0)}function d(n){var o,d,r;return e[n]["b!"]||(e[n]["b!"]=(o=e[n].bmp,d="",r=-1,t.forEach(o,/(\\x..|\\u....|\\?[\s\S])(?:-(\\x..|\\u....|\\?[\s\S]))?/,function(t){var e=s(t[1]);e>r+1&&(d+="\\u"+a(i(r+1)),e>r+2&&(d+="-\\u"+a(i(e-1)))),r=s(t[2]||t[1])}),r<65535&&(d+="\\u"+a(i(r+1)),r<65534&&(d+="-\\uFFFF")),d))}function r(t,n){var i=n?"a!":"a=";return e[t][i]||(e[t][i]=function(t,n){var i=e[t],a="";return i.bmp&&!i.isBmpLast&&(a="["+i.bmp+"]"+(i.astral?"|":"")),i.astral&&(a+=i.astral),i.isBmpLast&&i.bmp&&(a+=(i.astral?"|":"")+"["+i.bmp+"]"),n?"(?:(?!"+a+")(?:[\ud800-\udbff][\udc00-\udfff]|[\0-]))":"(?:"+a+")"}(t,n))}t.addToken(/\\([pP])(?:{(\^?)([^}]*)}|([A-Za-z]))/,function(t,n,i){var a="P"===t[1]||!!t[2],s=i.indexOf("A")>-1,u=o(t[4]||t[3]),l=e[u];if("P"===t[1]&&t[2])throw new SyntaxError("Invalid double negation "+t[0]);if(!e.hasOwnProperty(u))throw new SyntaxError("Unknown Unicode token "+t[0]);if(l.inverseOf){if(u=o(l.inverseOf),!e.hasOwnProperty(u))throw new ReferenceError("Unicode token missing data "+t[0]+" -> "+l.inverseOf);l=e[u],a=!a}if(!l.bmp&&!s)throw new SyntaxError("Astral mode required for Unicode token "+t[0]);if(s){if("class"===n)throw new SyntaxError("Astral mode does not support Unicode tokens within character classes");return r(u,a)}return"class"===n?a?d(u):l.bmp:(a?"[^":"[")+l.bmp+"]"},{scope:"all",optionalFlags:"A",leadChar:"\\"}),t.addUnicodeData=function(n){var i,a;for(a=0;a<n.length;++a){if(!(i=n[a]).name)throw new Error("Unicode token requires name");if(!(i.inverseOf||i.bmp||i.astral))throw new Error("Unicode token has no character data "+i.name);e[o(i.name)]=i,i.alias&&(e[o(i.alias)]=i)}t.cache.flush("patterns")}}},function(t,e){
/*!
	 * XRegExp Unicode Blocks 3.1.1
	 * <xregexp.com>
	 * Steven Levithan (c) 2010-2016 MIT License
	 * Unicode data by Mathias Bynens <mathiasbynens.be>
	 */
t.exports=function(t){"use strict";if(!t.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Blocks");t.addUnicodeData([{name:"InAegean_Numbers",astral:"\ud800[\udd00-\udd3f]"},{name:"InAhom",astral:"\ud805[\udf00-\udf3f]"},{name:"InAlchemical_Symbols",astral:"\ud83d[\udf00-\udf7f]"},{name:"InAlphabetic_Presentation_Forms",bmp:"-"},{name:"InAnatolian_Hieroglyphs",astral:"\ud811[\udc00-\ude7f]"},{name:"InAncient_Greek_Musical_Notation",astral:"\ud834[\ude00-\ude4f]"},{name:"InAncient_Greek_Numbers",astral:"\ud800[\udd40-\udd8f]"},{name:"InAncient_Symbols",astral:"\ud800[\udd90-\uddcf]"},{name:"InArabic",bmp:"-"},{name:"InArabic_Extended_A",bmp:"-"},{name:"InArabic_Mathematical_Alphabetic_Symbols",astral:"\ud83b[\ude00-\udeff]"},{name:"InArabic_Presentation_Forms_A",bmp:"-"},{name:"InArabic_Presentation_Forms_B",bmp:"-\ufeff"},{name:"InArabic_Supplement",bmp:"-"},{name:"InArmenian",bmp:"-"},{name:"InArrows",bmp:"-"},{name:"InAvestan",astral:"\ud802[\udf00-\udf3f]"},{name:"InBalinese",bmp:"-"},{name:"InBamum",bmp:"-"},{name:"InBamum_Supplement",astral:"\ud81a[\udc00-\ude3f]"},{name:"InBasic_Latin",bmp:"\0-"},{name:"InBassa_Vah",astral:"\ud81a[\uded0-\udeff]"},{name:"InBatak",bmp:"-"},{name:"InBengali",bmp:"-"},{name:"InBlock_Elements",bmp:"-"},{name:"InBopomofo",bmp:"-"},{name:"InBopomofo_Extended",bmp:"-"},{name:"InBox_Drawing",bmp:"-"},{name:"InBrahmi",astral:"\ud804[\udc00-\udc7f]"},{name:"InBraille_Patterns",bmp:"-"},{name:"InBuginese",bmp:"-"},{name:"InBuhid",bmp:"-"},{name:"InByzantine_Musical_Symbols",astral:"\ud834[\udc00-\udcff]"},{name:"InCJK_Compatibility",bmp:"-"},{name:"InCJK_Compatibility_Forms",bmp:"-"},{name:"InCJK_Compatibility_Ideographs",bmp:"-"},{name:"InCJK_Compatibility_Ideographs_Supplement",astral:"\ud87e[\udc00-\ude1f]"},{name:"InCJK_Radicals_Supplement",bmp:"-"},{name:"InCJK_Strokes",bmp:"-"},{name:"InCJK_Symbols_and_Punctuation",bmp:"-"},{name:"InCJK_Unified_Ideographs",bmp:"-"},{name:"InCJK_Unified_Ideographs_Extension_A",bmp:"-"},{name:"InCJK_Unified_Ideographs_Extension_B",astral:"[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\udedf]"},{name:"InCJK_Unified_Ideographs_Extension_C",astral:"\ud86d[\udc00-\udf3f]|[\ud86a-\ud86c][\udc00-\udfff]|\ud869[\udf00-\udfff]"},{name:"InCJK_Unified_Ideographs_Extension_D",astral:"\ud86d[\udf40-\udfff]|\ud86e[\udc00-\udc1f]"},{name:"InCJK_Unified_Ideographs_Extension_E",astral:"[\ud86f-\ud872][\udc00-\udfff]|\ud873[\udc00-\udeaf]|\ud86e[\udc20-\udfff]"},{name:"InCarian",astral:"\ud800[\udea0-\udedf]"},{name:"InCaucasian_Albanian",astral:"\ud801[\udd30-\udd6f]"},{name:"InChakma",astral:"\ud804[\udd00-\udd4f]"},{name:"InCham",bmp:"-"},{name:"InCherokee",bmp:"-"},{name:"InCherokee_Supplement",bmp:"-"},{name:"InCombining_Diacritical_Marks",bmp:"-"},{name:"InCombining_Diacritical_Marks_Extended",bmp:"-"},{name:"InCombining_Diacritical_Marks_Supplement",bmp:"-"},{name:"InCombining_Diacritical_Marks_for_Symbols",bmp:"-"},{name:"InCombining_Half_Marks",bmp:"-"},{name:"InCommon_Indic_Number_Forms",bmp:"-"},{name:"InControl_Pictures",bmp:"-"},{name:"InCoptic",bmp:"-"},{name:"InCoptic_Epact_Numbers",astral:"\ud800[\udee0-\udeff]"},{name:"InCounting_Rod_Numerals",astral:"\ud834[\udf60-\udf7f]"},{name:"InCuneiform",astral:"\ud808[\udc00-\udfff]"},{name:"InCuneiform_Numbers_and_Punctuation",astral:"\ud809[\udc00-\udc7f]"},{name:"InCurrency_Symbols",bmp:"-"},{name:"InCypriot_Syllabary",astral:"\ud802[\udc00-\udc3f]"},{name:"InCyrillic",bmp:"-"},{name:"InCyrillic_Extended_A",bmp:"-"},{name:"InCyrillic_Extended_B",bmp:"-"},{name:"InCyrillic_Supplement",bmp:"-"},{name:"InDeseret",astral:"\ud801[\udc00-\udc4f]"},{name:"InDevanagari",bmp:"-"},{name:"InDevanagari_Extended",bmp:"-"},{name:"InDingbats",bmp:"-"},{name:"InDomino_Tiles",astral:"\ud83c[\udc30-\udc9f]"},{name:"InDuployan",astral:"\ud82f[\udc00-\udc9f]"},{name:"InEarly_Dynastic_Cuneiform",astral:"\ud809[\udc80-\udd4f]"},{name:"InEgyptian_Hieroglyphs",astral:"\ud80c[\udc00-\udfff]|\ud80d[\udc00-\udc2f]"},{name:"InElbasan",astral:"\ud801[\udd00-\udd2f]"},{name:"InEmoticons",astral:"\ud83d[\ude00-\ude4f]"},{name:"InEnclosed_Alphanumeric_Supplement",astral:"\ud83c[\udd00-\uddff]"},{name:"InEnclosed_Alphanumerics",bmp:"-"},{name:"InEnclosed_CJK_Letters_and_Months",bmp:"-"},{name:"InEnclosed_Ideographic_Supplement",astral:"\ud83c[\ude00-\udeff]"},{name:"InEthiopic",bmp:"-"},{name:"InEthiopic_Extended",bmp:"-"},{name:"InEthiopic_Extended_A",bmp:"-"},{name:"InEthiopic_Supplement",bmp:"-"},{name:"InGeneral_Punctuation",bmp:"-"},{name:"InGeometric_Shapes",bmp:"-"},{name:"InGeometric_Shapes_Extended",astral:"\ud83d[\udf80-\udfff]"},{name:"InGeorgian",bmp:"-"},{name:"InGeorgian_Supplement",bmp:"-"},{name:"InGlagolitic",bmp:"-"},{name:"InGothic",astral:"\ud800[\udf30-\udf4f]"},{name:"InGrantha",astral:"\ud804[\udf00-\udf7f]"},{name:"InGreek_Extended",bmp:"-"},{name:"InGreek_and_Coptic",bmp:"-"},{name:"InGujarati",bmp:"-"},{name:"InGurmukhi",bmp:"-"},{name:"InHalfwidth_and_Fullwidth_Forms",bmp:"-"},{name:"InHangul_Compatibility_Jamo",bmp:"-"},{name:"InHangul_Jamo",bmp:"-"},{name:"InHangul_Jamo_Extended_A",bmp:"-"},{name:"InHangul_Jamo_Extended_B",bmp:"-"},{name:"InHangul_Syllables",bmp:"-"},{name:"InHanunoo",bmp:"-"},{name:"InHatran",astral:"\ud802[\udce0-\udcff]"},{name:"InHebrew",bmp:"-"},{name:"InHigh_Private_Use_Surrogates",bmp:"\udb80-\udbff"},{name:"InHigh_Surrogates",bmp:"\ud800-\udb7f"},{name:"InHiragana",bmp:"-"},{name:"InIPA_Extensions",bmp:"-"},{name:"InIdeographic_Description_Characters",bmp:"-"},{name:"InImperial_Aramaic",astral:"\ud802[\udc40-\udc5f]"},{name:"InInscriptional_Pahlavi",astral:"\ud802[\udf60-\udf7f]"},{name:"InInscriptional_Parthian",astral:"\ud802[\udf40-\udf5f]"},{name:"InJavanese",bmp:"-"},{name:"InKaithi",astral:"\ud804[\udc80-\udccf]"},{name:"InKana_Supplement",astral:"\ud82c[\udc00-\udcff]"},{name:"InKanbun",bmp:"-"},{name:"InKangxi_Radicals",bmp:"-"},{name:"InKannada",bmp:"-"},{name:"InKatakana",bmp:"-"},{name:"InKatakana_Phonetic_Extensions",bmp:"-"},{name:"InKayah_Li",bmp:"-"},{name:"InKharoshthi",astral:"\ud802[\ude00-\ude5f]"},{name:"InKhmer",bmp:"-"},{name:"InKhmer_Symbols",bmp:"-"},{name:"InKhojki",astral:"\ud804[\ude00-\ude4f]"},{name:"InKhudawadi",astral:"\ud804[\udeb0-\udeff]"},{name:"InLao",bmp:"-"},{name:"InLatin_Extended_Additional",bmp:"-"},{name:"InLatin_Extended_A",bmp:"-"},{name:"InLatin_Extended_B",bmp:"-"},{name:"InLatin_Extended_C",bmp:"-"},{name:"InLatin_Extended_D",bmp:"-"},{name:"InLatin_Extended_E",bmp:"-"},{name:"InLatin_1_Supplement",bmp:"-"},{name:"InLepcha",bmp:"-"},{name:"InLetterlike_Symbols",bmp:"-"},{name:"InLimbu",bmp:"-"},{name:"InLinear_A",astral:"\ud801[\ude00-\udf7f]"},{name:"InLinear_B_Ideograms",astral:"\ud800[\udc80-\udcff]"},{name:"InLinear_B_Syllabary",astral:"\ud800[\udc00-\udc7f]"},{name:"InLisu",bmp:"-"},{name:"InLow_Surrogates",bmp:"\udc00-\udfff"},{name:"InLycian",astral:"\ud800[\ude80-\ude9f]"},{name:"InLydian",astral:"\ud802[\udd20-\udd3f]"},{name:"InMahajani",astral:"\ud804[\udd50-\udd7f]"},{name:"InMahjong_Tiles",astral:"\ud83c[\udc00-\udc2f]"},{name:"InMalayalam",bmp:"-"},{name:"InMandaic",bmp:"-"},{name:"InManichaean",astral:"\ud802[\udec0-\udeff]"},{name:"InMathematical_Alphanumeric_Symbols",astral:"\ud835[\udc00-\udfff]"},{name:"InMathematical_Operators",bmp:"-"},{name:"InMeetei_Mayek",bmp:"-"},{name:"InMeetei_Mayek_Extensions",bmp:"-"},{name:"InMende_Kikakui",astral:"\ud83a[\udc00-\udcdf]"},{name:"InMeroitic_Cursive",astral:"\ud802[\udda0-\uddff]"},{name:"InMeroitic_Hieroglyphs",astral:"\ud802[\udd80-\udd9f]"},{name:"InMiao",astral:"\ud81b[\udf00-\udf9f]"},{name:"InMiscellaneous_Mathematical_Symbols_A",bmp:"-"},{name:"InMiscellaneous_Mathematical_Symbols_B",bmp:"-"},{name:"InMiscellaneous_Symbols",bmp:"-"},{name:"InMiscellaneous_Symbols_and_Arrows",bmp:"-"},{name:"InMiscellaneous_Symbols_and_Pictographs",astral:"\ud83d[\udc00-\uddff]|\ud83c[\udf00-\udfff]"},{name:"InMiscellaneous_Technical",bmp:"-"},{name:"InModi",astral:"\ud805[\ude00-\ude5f]"},{name:"InModifier_Tone_Letters",bmp:"-"},{name:"InMongolian",bmp:"-"},{name:"InMro",astral:"\ud81a[\ude40-\ude6f]"},{name:"InMultani",astral:"\ud804[\ude80-\udeaf]"},{name:"InMusical_Symbols",astral:"\ud834[\udd00-\uddff]"},{name:"InMyanmar",bmp:"-"},{name:"InMyanmar_Extended_A",bmp:"-"},{name:"InMyanmar_Extended_B",bmp:"-"},{name:"InNKo",bmp:"-"},{name:"InNabataean",astral:"\ud802[\udc80-\udcaf]"},{name:"InNew_Tai_Lue",bmp:"-"},{name:"InNumber_Forms",bmp:"-"},{name:"InOgham",bmp:"-"},{name:"InOl_Chiki",bmp:"-"},{name:"InOld_Hungarian",astral:"\ud803[\udc80-\udcff]"},{name:"InOld_Italic",astral:"\ud800[\udf00-\udf2f]"},{name:"InOld_North_Arabian",astral:"\ud802[\ude80-\ude9f]"},{name:"InOld_Permic",astral:"\ud800[\udf50-\udf7f]"},{name:"InOld_Persian",astral:"\ud800[\udfa0-\udfdf]"},{name:"InOld_South_Arabian",astral:"\ud802[\ude60-\ude7f]"},{name:"InOld_Turkic",astral:"\ud803[\udc00-\udc4f]"},{name:"InOptical_Character_Recognition",bmp:"-"},{name:"InOriya",bmp:"-"},{name:"InOrnamental_Dingbats",astral:"\ud83d[\ude50-\ude7f]"},{name:"InOsmanya",astral:"\ud801[\udc80-\udcaf]"},{name:"InPahawh_Hmong",astral:"\ud81a[\udf00-\udf8f]"},{name:"InPalmyrene",astral:"\ud802[\udc60-\udc7f]"},{name:"InPau_Cin_Hau",astral:"\ud806[\udec0-\udeff]"},{name:"InPhags_pa",bmp:"-"},{name:"InPhaistos_Disc",astral:"\ud800[\uddd0-\uddff]"},{name:"InPhoenician",astral:"\ud802[\udd00-\udd1f]"},{name:"InPhonetic_Extensions",bmp:"-"},{name:"InPhonetic_Extensions_Supplement",bmp:"-"},{name:"InPlaying_Cards",astral:"\ud83c[\udca0-\udcff]"},{name:"InPrivate_Use_Area",bmp:"-"},{name:"InPsalter_Pahlavi",astral:"\ud802[\udf80-\udfaf]"},{name:"InRejang",bmp:"-"},{name:"InRumi_Numeral_Symbols",astral:"\ud803[\ude60-\ude7f]"},{name:"InRunic",bmp:"-"},{name:"InSamaritan",bmp:"-"},{name:"InSaurashtra",bmp:"-"},{name:"InSharada",astral:"\ud804[\udd80-\udddf]"},{name:"InShavian",astral:"\ud801[\udc50-\udc7f]"},{name:"InShorthand_Format_Controls",astral:"\ud82f[\udca0-\udcaf]"},{name:"InSiddham",astral:"\ud805[\udd80-\uddff]"},{name:"InSinhala",bmp:"-"},{name:"InSinhala_Archaic_Numbers",astral:"\ud804[\udde0-\uddff]"},{name:"InSmall_Form_Variants",bmp:"-"},{name:"InSora_Sompeng",astral:"\ud804[\udcd0-\udcff]"},{name:"InSpacing_Modifier_Letters",bmp:"-"},{name:"InSpecials",bmp:"-"},{name:"InSundanese",bmp:"-"},{name:"InSundanese_Supplement",bmp:"-"},{name:"InSuperscripts_and_Subscripts",bmp:"-"},{name:"InSupplemental_Arrows_A",bmp:"-"},{name:"InSupplemental_Arrows_B",bmp:"-"},{name:"InSupplemental_Arrows_C",astral:"\ud83e[\udc00-\udcff]"},{name:"InSupplemental_Mathematical_Operators",bmp:"-"},{name:"InSupplemental_Punctuation",bmp:"-"},{name:"InSupplemental_Symbols_and_Pictographs",astral:"\ud83e[\udd00-\uddff]"},{name:"InSupplementary_Private_Use_Area_A",astral:"[\udb80-\udbbf][\udc00-\udfff]"},{name:"InSupplementary_Private_Use_Area_B",astral:"[\udbc0-\udbff][\udc00-\udfff]"},{name:"InSutton_SignWriting",astral:"\ud836[\udc00-\udeaf]"},{name:"InSyloti_Nagri",bmp:"-"},{name:"InSyriac",bmp:"-"},{name:"InTagalog",bmp:"-"},{name:"InTagbanwa",bmp:"-"},{name:"InTags",astral:"\udb40[\udc00-\udc7f]"},{name:"InTai_Le",bmp:"-"},{name:"InTai_Tham",bmp:"-"},{name:"InTai_Viet",bmp:"-"},{name:"InTai_Xuan_Jing_Symbols",astral:"\ud834[\udf00-\udf5f]"},{name:"InTakri",astral:"\ud805[\ude80-\udecf]"},{name:"InTamil",bmp:"-"},{name:"InTelugu",bmp:"-"},{name:"InThaana",bmp:"-"},{name:"InThai",bmp:"-"},{name:"InTibetan",bmp:"-"},{name:"InTifinagh",bmp:"-"},{name:"InTirhuta",astral:"\ud805[\udc80-\udcdf]"},{name:"InTransport_and_Map_Symbols",astral:"\ud83d[\ude80-\udeff]"},{name:"InUgaritic",astral:"\ud800[\udf80-\udf9f]"},{name:"InUnified_Canadian_Aboriginal_Syllabics",bmp:"-"},{name:"InUnified_Canadian_Aboriginal_Syllabics_Extended",bmp:"-"},{name:"InVai",bmp:"-"},{name:"InVariation_Selectors",bmp:"-"},{name:"InVariation_Selectors_Supplement",astral:"\udb40[\udd00-\uddef]"},{name:"InVedic_Extensions",bmp:"-"},{name:"InVertical_Forms",bmp:"-"},{name:"InWarang_Citi",astral:"\ud806[\udca0-\udcff]"},{name:"InYi_Radicals",bmp:"-"},{name:"InYi_Syllables",bmp:"-"},{name:"InYijing_Hexagram_Symbols",bmp:"-"}])}},function(t,e){
/*!
	 * XRegExp Unicode Categories 3.1.1
	 * <xregexp.com>
	 * Steven Levithan (c) 2010-2016 MIT License
	 * Unicode data by Mathias Bynens <mathiasbynens.be>
	 */
t.exports=function(t){"use strict";if(!t.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Categories");t.addUnicodeData([{name:"C",alias:"Other",isBmpLast:!0,bmp:"\0---------------------------------------------------------------------------------------------------------------------------------------------------------",astral:"\ud834[\udcf6-\udcff\udd27\udd28\udd73-\udd7a\udde9-\uddff\ude46-\udeff\udf57-\udf5f\udf72-\udfff]|\ud836[\ude8c-\ude9a\udea0\udeb0-\udfff]|\ud83c[\udc2c-\udc2f\udc94-\udc9f\udcaf\udcb0\udcc0\udcd0\udcf6-\udcff\udd0d-\udd0f\udd2f\udd6c-\udd6f\udd9b-\udde5\ude03-\ude0f\ude3b-\ude3f\ude49-\ude4f\ude52-\udeff]|\ud81a[\ude39-\ude3f\ude5f\ude6a-\ude6d\ude70-\udecf\udeee\udeef\udef6-\udeff\udf46-\udf4f\udf5a\udf62\udf78-\udf7c\udf90-\udfff]|\ud809[\udc6f\udc75-\udc7f\udd44-\udfff]|\ud81b[\udc00-\udeff\udf45-\udf4f\udf7f-\udf8e\udfa0-\udfff]|\ud86e[\udc1e\udc1f]|\ud83d[\udd7a\udda4\uded1-\udedf\udeed-\udeef\udef4-\udeff\udf74-\udf7f\udfd5-\udfff]|\ud801[\udc9e\udc9f\udcaa-\udcff\udd28-\udd2f\udd64-\udd6e\udd70-\uddff\udf37-\udf3f\udf56-\udf5f\udf68-\udfff]|\ud800[\udc0c\udc27\udc3b\udc3e\udc4e\udc4f\udc5e-\udc7f\udcfb-\udcff\udd03-\udd06\udd34-\udd36\udd8d-\udd8f\udd9c-\udd9f\udda1-\uddcf\uddfe-\ude7f\ude9d-\ude9f\uded1-\udedf\udefc-\udeff\udf24-\udf2f\udf4b-\udf4f\udf7b-\udf7f\udf9e\udfc4-\udfc7\udfd6-\udfff]|\ud869[\uded7-\udeff]|\ud83b[\udc00-\uddff\ude04\ude20\ude23\ude25\ude26\ude28\ude33\ude38\ude3a\ude3c-\ude41\ude43-\ude46\ude48\ude4a\ude4c\ude50\ude53\ude55\ude56\ude58\ude5a\ude5c\ude5e\ude60\ude63\ude65\ude66\ude6b\ude73\ude78\ude7d\ude7f\ude8a\ude9c-\udea0\udea4\udeaa\udebc-\udeef\udef2-\udfff]|\ud87e[\ude1e-\udfff]|\udb40[\udc00-\udcff\uddf0-\udfff]|\ud804[\udc4e-\udc51\udc70-\udc7e\udcbd\udcc2-\udccf\udce9-\udcef\udcfa-\udcff\udd35\udd44-\udd4f\udd77-\udd7f\uddce\uddcf\udde0\uddf5-\uddff\ude12\ude3e-\ude7f\ude87\ude89\ude8e\ude9e\udeaa-\udeaf\udeeb-\udeef\udefa-\udeff\udf04\udf0d\udf0e\udf11\udf12\udf29\udf31\udf34\udf3a\udf3b\udf45\udf46\udf49\udf4a\udf4e\udf4f\udf51-\udf56\udf58-\udf5c\udf64\udf65\udf6d-\udf6f\udf75-\udfff]|\ud83a[\udcc5\udcc6\udcd7-\udfff]|\ud80d[\udc2f-\udfff]|\ud86d[\udf35-\udf3f]|[\ud807\ud80a\ud80b\ud80e-\ud810\ud812-\ud819\ud81c-\ud82b\ud82d\ud82e\ud830-\ud833\ud837-\ud839\ud83f\ud874-\ud87d\ud87f-\udb3f\udb41-\udbff][\udc00-\udfff]|\ud806[\udc00-\udc9f\udcf3-\udcfe\udd00-\udebf\udef9-\udfff]|\ud803[\udc49-\udc7f\udcb3-\udcbf\udcf3-\udcf9\udd00-\ude5f\ude7f-\udfff]|\ud835[\udc55\udc9d\udca0\udca1\udca3\udca4\udca7\udca8\udcad\udcba\udcbc\udcc4\udd06\udd0b\udd0c\udd15\udd1d\udd3a\udd3f\udd45\udd47-\udd49\udd51\udea6\udea7\udfcc\udfcd]|\ud805[\udc00-\udc7f\udcc8-\udccf\udcda-\udd7f\uddb6\uddb7\uddde-\uddff\ude45-\ude4f\ude5a-\ude7f\udeb8-\udebf\udeca-\udeff\udf1a-\udf1c\udf2c-\udf2f\udf40-\udfff]|\ud802[\udc06\udc07\udc09\udc36\udc39-\udc3b\udc3d\udc3e\udc56\udc9f-\udca6\udcb0-\udcdf\udcf3\udcf6-\udcfa\udd1c-\udd1e\udd3a-\udd3e\udd40-\udd7f\uddb8-\uddbb\uddd0\uddd1\ude04\ude07-\ude0b\ude14\ude18\ude34-\ude37\ude3b-\ude3e\ude48-\ude4f\ude59-\ude5f\udea0-\udebf\udee7-\udeea\udef7-\udeff\udf36-\udf38\udf56\udf57\udf73-\udf77\udf92-\udf98\udf9d-\udfa8\udfb0-\udfff]|\ud808[\udf9a-\udfff]|\ud82f[\udc6b-\udc6f\udc7d-\udc7f\udc89-\udc8f\udc9a\udc9b\udca0-\udfff]|\ud82c[\udc02-\udfff]|\ud811[\ude47-\udfff]|\ud83e[\udc0c-\udc0f\udc48-\udc4f\udc5a-\udc5f\udc88-\udc8f\udcae-\udd0f\udd19-\udd7f\udd85-\uddbf\uddc1-\udfff]|\ud873[\udea2-\udfff]"},{name:"Cc",alias:"Control",bmp:"\0--"},{name:"Cf",alias:"Format",bmp:"-----\ufeff-",astral:"\udb40[\udc01\udc20-\udc7f]|\ud82f[\udca0-\udca3]|\ud834[\udd73-\udd7a]|"},{name:"Cn",alias:"Unassigned",bmp:"---------------------------------------------------------------------------------------------------------------------------------------------------",astral:"\udb40[\udc00\udc02-\udc1f\udc80-\udcff\uddf0-\udfff]|\ud834[\udcf6-\udcff\udd27\udd28\udde9-\uddff\ude46-\udeff\udf57-\udf5f\udf72-\udfff]|\ud83c[\udc2c-\udc2f\udc94-\udc9f\udcaf\udcb0\udcc0\udcd0\udcf6-\udcff\udd0d-\udd0f\udd2f\udd6c-\udd6f\udd9b-\udde5\ude03-\ude0f\ude3b-\ude3f\ude49-\ude4f\ude52-\udeff]|\ud81a[\ude39-\ude3f\ude5f\ude6a-\ude6d\ude70-\udecf\udeee\udeef\udef6-\udeff\udf46-\udf4f\udf5a\udf62\udf78-\udf7c\udf90-\udfff]|\ud809[\udc6f\udc75-\udc7f\udd44-\udfff]|\ud81b[\udc00-\udeff\udf45-\udf4f\udf7f-\udf8e\udfa0-\udfff]|\ud86e[\udc1e\udc1f]|\ud83d[\udd7a\udda4\uded1-\udedf\udeed-\udeef\udef4-\udeff\udf74-\udf7f\udfd5-\udfff]|\ud801[\udc9e\udc9f\udcaa-\udcff\udd28-\udd2f\udd64-\udd6e\udd70-\uddff\udf37-\udf3f\udf56-\udf5f\udf68-\udfff]|\ud800[\udc0c\udc27\udc3b\udc3e\udc4e\udc4f\udc5e-\udc7f\udcfb-\udcff\udd03-\udd06\udd34-\udd36\udd8d-\udd8f\udd9c-\udd9f\udda1-\uddcf\uddfe-\ude7f\ude9d-\ude9f\uded1-\udedf\udefc-\udeff\udf24-\udf2f\udf4b-\udf4f\udf7b-\udf7f\udf9e\udfc4-\udfc7\udfd6-\udfff]|\ud869[\uded7-\udeff]|\ud83b[\udc00-\uddff\ude04\ude20\ude23\ude25\ude26\ude28\ude33\ude38\ude3a\ude3c-\ude41\ude43-\ude46\ude48\ude4a\ude4c\ude50\ude53\ude55\ude56\ude58\ude5a\ude5c\ude5e\ude60\ude63\ude65\ude66\ude6b\ude73\ude78\ude7d\ude7f\ude8a\ude9c-\udea0\udea4\udeaa\udebc-\udeef\udef2-\udfff]|[\udbbf\udbff][\udffe\udfff]|\ud87e[\ude1e-\udfff]|\ud82f[\udc6b-\udc6f\udc7d-\udc7f\udc89-\udc8f\udc9a\udc9b\udca4-\udfff]|\ud83a[\udcc5\udcc6\udcd7-\udfff]|\ud80d[\udc2f-\udfff]|\ud86d[\udf35-\udf3f]|[\ud807\ud80a\ud80b\ud80e-\ud810\ud812-\ud819\ud81c-\ud82b\ud82d\ud82e\ud830-\ud833\ud837-\ud839\ud83f\ud874-\ud87d\ud87f-\udb3f\udb41-\udb7f][\udc00-\udfff]|\ud806[\udc00-\udc9f\udcf3-\udcfe\udd00-\udebf\udef9-\udfff]|\ud803[\udc49-\udc7f\udcb3-\udcbf\udcf3-\udcf9\udd00-\ude5f\ude7f-\udfff]|\ud835[\udc55\udc9d\udca0\udca1\udca3\udca4\udca7\udca8\udcad\udcba\udcbc\udcc4\udd06\udd0b\udd0c\udd15\udd1d\udd3a\udd3f\udd45\udd47-\udd49\udd51\udea6\udea7\udfcc\udfcd]|\ud836[\ude8c-\ude9a\udea0\udeb0-\udfff]|\ud805[\udc00-\udc7f\udcc8-\udccf\udcda-\udd7f\uddb6\uddb7\uddde-\uddff\ude45-\ude4f\ude5a-\ude7f\udeb8-\udebf\udeca-\udeff\udf1a-\udf1c\udf2c-\udf2f\udf40-\udfff]|\ud802[\udc06\udc07\udc09\udc36\udc39-\udc3b\udc3d\udc3e\udc56\udc9f-\udca6\udcb0-\udcdf\udcf3\udcf6-\udcfa\udd1c-\udd1e\udd3a-\udd3e\udd40-\udd7f\uddb8-\uddbb\uddd0\uddd1\ude04\ude07-\ude0b\ude14\ude18\ude34-\ude37\ude3b-\ude3e\ude48-\ude4f\ude59-\ude5f\udea0-\udebf\udee7-\udeea\udef7-\udeff\udf36-\udf38\udf56\udf57\udf73-\udf77\udf92-\udf98\udf9d-\udfa8\udfb0-\udfff]|\ud808[\udf9a-\udfff]|\ud804[\udc4e-\udc51\udc70-\udc7e\udcc2-\udccf\udce9-\udcef\udcfa-\udcff\udd35\udd44-\udd4f\udd77-\udd7f\uddce\uddcf\udde0\uddf5-\uddff\ude12\ude3e-\ude7f\ude87\ude89\ude8e\ude9e\udeaa-\udeaf\udeeb-\udeef\udefa-\udeff\udf04\udf0d\udf0e\udf11\udf12\udf29\udf31\udf34\udf3a\udf3b\udf45\udf46\udf49\udf4a\udf4e\udf4f\udf51-\udf56\udf58-\udf5c\udf64\udf65\udf6d-\udf6f\udf75-\udfff]|\ud82c[\udc02-\udfff]|\ud811[\ude47-\udfff]|\ud83e[\udc0c-\udc0f\udc48-\udc4f\udc5a-\udc5f\udc88-\udc8f\udcae-\udd0f\udd19-\udd7f\udd85-\uddbf\uddc1-\udfff]|\ud873[\udea2-\udfff]"},{name:"Co",alias:"Private_Use",bmp:"-",astral:"[\udb80-\udbbe\udbc0-\udbfe][\udc00-\udfff]|[\udbbf\udbff][\udc00-\udffd]"},{name:"Cs",alias:"Surrogate",bmp:"\ud800-\udfff"},{name:"L",alias:"Letter",bmp:"A-Za-z-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",astral:"\ud86e[\udc00-\udc1d\udc20-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|\ud803[\udc00-\udc48\udc80-\udcb2\udcc0-\udcf2]|\ud83a[\udc00-\udcc4]|\ud801[\udc00-\udc9d\udd00-\udd27\udd30-\udd63\ude00-\udf36\udf40-\udf55\udf60-\udf67]|\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa\ude80-\ude9c\udea0-\uded0\udf00-\udf1f\udf30-\udf40\udf42-\udf49\udf50-\udf75\udf80-\udf9d\udfa0-\udfc3\udfc8-\udfcf]|\ud80d[\udc00-\udc2e]|\ud87e[\udc00-\ude1d]|\ud81b[\udf00-\udf44\udf50\udf93-\udf9f]|[\ud80c\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872][\udc00-\udfff]|\ud805[\udc80-\udcaf\udcc4\udcc5\udcc7\udd80-\uddae\uddd8-\udddb\ude00-\ude2f\ude44\ude80-\udeaa\udf00-\udf19]|\ud81a[\udc00-\ude38\ude40-\ude5e\uded0-\udeed\udf00-\udf2f\udf40-\udf43\udf63-\udf77\udf7d-\udf8f]|\ud809[\udc80-\udd43]|\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f-\udc55\udc60-\udc76\udc80-\udc9e\udce0-\udcf2\udcf4\udcf5\udd00-\udd15\udd20-\udd39\udd80-\uddb7\uddbe\uddbf\ude00\ude10-\ude13\ude15-\ude17\ude19-\ude33\ude60-\ude7c\ude80-\ude9c\udec0-\udec7\udec9-\udee4\udf00-\udf35\udf40-\udf55\udf60-\udf72\udf80-\udf91]|\ud835[\udc00-\udc54\udc56-\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd1e-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd52-\udea5\udea8-\udec0\udec2-\udeda\udedc-\udefa\udefc-\udf14\udf16-\udf34\udf36-\udf4e\udf50-\udf6e\udf70-\udf88\udf8a-\udfa8\udfaa-\udfc2\udfc4-\udfcb]|\ud804[\udc03-\udc37\udc83-\udcaf\udcd0-\udce8\udd03-\udd26\udd50-\udd72\udd76\udd83-\uddb2\uddc1-\uddc4\uddda\udddc\ude00-\ude11\ude13-\ude2b\ude80-\ude86\ude88\ude8a-\ude8d\ude8f-\ude9d\ude9f-\udea8\udeb0-\udede\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3d\udf50\udf5d-\udf61]|\ud808[\udc00-\udf99]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb]|\ud806[\udca0-\udcdf\udcff\udec0-\udef8]|\ud811[\udc00-\ude46]|\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99]|\ud82c[\udc00\udc01]|\ud873[\udc00-\udea1]"},{name:"Ll",alias:"Lowercase_Letter",bmp:"a-z------------------------------------------------",astral:"\ud803[\udcc0-\udcf2]|\ud835[\udc1a-\udc33\udc4e-\udc54\udc56-\udc67\udc82-\udc9b\udcb6-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udccf\udcea-\udd03\udd1e-\udd37\udd52-\udd6b\udd86-\udd9f\uddba-\uddd3\uddee-\ude07\ude22-\ude3b\ude56-\ude6f\ude8a-\udea5\udec2-\udeda\udedc-\udee1\udefc-\udf14\udf16-\udf1b\udf36-\udf4e\udf50-\udf55\udf70-\udf88\udf8a-\udf8f\udfaa-\udfc2\udfc4-\udfc9\udfcb]|\ud801[\udc28-\udc4f]|\ud806[\udcc0-\udcdf]"},{name:"Lm",alias:"Modifier_Letter",bmp:"------------",astral:"\ud81a[\udf40-\udf43]|\ud81b[\udf93-\udf9f]"},{name:"Lo",alias:"Other_Letter",bmp:"-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",astral:"\ud86e[\udc00-\udc1d\udc20-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|\ud83a[\udc00-\udcc4]|\ud803[\udc00-\udc48]|\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa\ude80-\ude9c\udea0-\uded0\udf00-\udf1f\udf30-\udf40\udf42-\udf49\udf50-\udf75\udf80-\udf9d\udfa0-\udfc3\udfc8-\udfcf]|\ud80d[\udc00-\udc2e]|\ud87e[\udc00-\ude1d]|\ud81b[\udf00-\udf44\udf50]|[\ud80c\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872][\udc00-\udfff]|\ud805[\udc80-\udcaf\udcc4\udcc5\udcc7\udd80-\uddae\uddd8-\udddb\ude00-\ude2f\ude44\ude80-\udeaa\udf00-\udf19]|\ud806[\udcff\udec0-\udef8]|\ud809[\udc80-\udd43]|\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f-\udc55\udc60-\udc76\udc80-\udc9e\udce0-\udcf2\udcf4\udcf5\udd00-\udd15\udd20-\udd39\udd80-\uddb7\uddbe\uddbf\ude00\ude10-\ude13\ude15-\ude17\ude19-\ude33\ude60-\ude7c\ude80-\ude9c\udec0-\udec7\udec9-\udee4\udf00-\udf35\udf40-\udf55\udf60-\udf72\udf80-\udf91]|\ud804[\udc03-\udc37\udc83-\udcaf\udcd0-\udce8\udd03-\udd26\udd50-\udd72\udd76\udd83-\uddb2\uddc1-\uddc4\uddda\udddc\ude00-\ude11\ude13-\ude2b\ude80-\ude86\ude88\ude8a-\ude8d\ude8f-\ude9d\ude9f-\udea8\udeb0-\udede\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3d\udf50\udf5d-\udf61]|\ud808[\udc00-\udf99]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb]|\ud81a[\udc00-\ude38\ude40-\ude5e\uded0-\udeed\udf00-\udf2f\udf63-\udf77\udf7d-\udf8f]|\ud801[\udc50-\udc9d\udd00-\udd27\udd30-\udd63\ude00-\udf36\udf40-\udf55\udf60-\udf67]|\ud811[\udc00-\ude46]|\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99]|\ud82c[\udc00\udc01]|\ud873[\udc00-\udea1]"},{name:"Lt",alias:"Titlecase_Letter",bmp:"---"},{name:"Lu",alias:"Uppercase_Letter",bmp:"A-Z---------------------------------------",astral:"\ud806[\udca0-\udcbf]|\ud803[\udc80-\udcb2]|\ud801[\udc00-\udc27]|\ud835[\udc00-\udc19\udc34-\udc4d\udc68-\udc81\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb5\udcd0-\udce9\udd04\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd38\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd6c-\udd85\udda0-\uddb9\uddd4-\udded\ude08-\ude21\ude3c-\ude55\ude70-\ude89\udea8-\udec0\udee2-\udefa\udf1c-\udf34\udf56-\udf6e\udf90-\udfa8\udfca]"},{name:"M",alias:"Mark",bmp:"------------------------------------------------------------------------------------------------------------",astral:"\ud805[\udcb0-\udcc3\uddaf-\uddb5\uddb8-\uddc0\udddc\udddd\ude30-\ude40\udeab-\udeb7\udf1d-\udf2b]|\ud834[\udd65-\udd69\udd6d-\udd72\udd7b-\udd82\udd85-\udd8b\uddaa-\uddad\ude42-\ude44]|\ud804[\udc00-\udc02\udc38-\udc46\udc7f-\udc82\udcb0-\udcba\udd00-\udd02\udd27-\udd34\udd73\udd80-\udd82\uddb3-\uddc0\uddca-\uddcc\ude2c-\ude37\udedf-\udeea\udf00-\udf03\udf3c\udf3e-\udf44\udf47\udf48\udf4b-\udf4d\udf57\udf62\udf63\udf66-\udf6c\udf70-\udf74]|\ud81b[\udf51-\udf7e\udf8f-\udf92]|\ud81a[\udef0-\udef4\udf30-\udf36]|\ud82f[\udc9d\udc9e]|\ud800[\uddfd\udee0\udf76-\udf7a]|\ud836[\ude00-\ude36\ude3b-\ude6c\ude75\ude84\ude9b-\ude9f\udea1-\udeaf]|\ud802[\ude01-\ude03\ude05\ude06\ude0c-\ude0f\ude38-\ude3a\ude3f\udee5\udee6]|\ud83a[\udcd0-\udcd6]|\udb40[\udd00-\uddef]"},{name:"Mc",alias:"Spacing_Mark",bmp:"-----------------------------",astral:"\ud834[\udd65\udd66\udd6d-\udd72]|\ud804[\udc00\udc02\udc82\udcb0-\udcb2\udcb7\udcb8\udd2c\udd82\uddb3-\uddb5\uddbf\uddc0\ude2c-\ude2e\ude32\ude33\ude35\udee0-\udee2\udf02\udf03\udf3e\udf3f\udf41-\udf44\udf47\udf48\udf4b-\udf4d\udf57\udf62\udf63]|\ud805[\udcb0-\udcb2\udcb9\udcbb-\udcbe\udcc1\uddaf-\uddb1\uddb8-\uddbb\uddbe\ude30-\ude32\ude3b\ude3c\ude3e\udeac\udeae\udeaf\udeb6\udf20\udf21\udf26]|\ud81b[\udf51-\udf7e]"},{name:"Me",alias:"Enclosing_Mark",bmp:"---"},{name:"Mn",alias:"Nonspacing_Mark",bmp:"-------------------------------------------------------------------------------",astral:"\ud805[\udcb3-\udcb8\udcba\udcbf\udcc0\udcc2\udcc3\uddb2-\uddb5\uddbc\uddbd\uddbf\uddc0\udddc\udddd\ude33-\ude3a\ude3d\ude3f\ude40\udeab\udead\udeb0-\udeb5\udeb7\udf1d-\udf1f\udf22-\udf25\udf27-\udf2b]|\ud834[\udd67-\udd69\udd7b-\udd82\udd85-\udd8b\uddaa-\uddad\ude42-\ude44]|\ud81a[\udef0-\udef4\udf30-\udf36]|\ud81b[\udf8f-\udf92]|\ud82f[\udc9d\udc9e]|\ud800[\uddfd\udee0\udf76-\udf7a]|\ud836[\ude00-\ude36\ude3b-\ude6c\ude75\ude84\ude9b-\ude9f\udea1-\udeaf]|\ud802[\ude01-\ude03\ude05\ude06\ude0c-\ude0f\ude38-\ude3a\ude3f\udee5\udee6]|\ud804[\udc01\udc38-\udc46\udc7f-\udc81\udcb3-\udcb6\udcb9\udcba\udd00-\udd02\udd27-\udd2b\udd2d-\udd34\udd73\udd80\udd81\uddb6-\uddbe\uddca-\uddcc\ude2f-\ude31\ude34\ude36\ude37\udedf\udee3-\udeea\udf00\udf01\udf3c\udf40\udf66-\udf6c\udf70-\udf74]|\ud83a[\udcd0-\udcd6]|\udb40[\udd00-\uddef]"},{name:"N",alias:"Number",bmp:"0-9------------------------------------------------------------",astral:"\ud800[\udd07-\udd33\udd40-\udd78\udd8a\udd8b\udee1-\udefb\udf20-\udf23\udf41\udf4a\udfd1-\udfd5]|\ud801[\udca0-\udca9]|\ud803[\udcfa-\udcff\ude60-\ude7e]|\ud835[\udfce-\udfff]|\ud83a[\udcc7-\udccf]|\ud81a[\ude60-\ude69\udf50-\udf59\udf5b-\udf61]|\ud806[\udce0-\udcf2]|\ud804[\udc52-\udc6f\udcf0-\udcf9\udd36-\udd3f\uddd0-\uddd9\udde1-\uddf4\udef0-\udef9]|\ud834[\udf60-\udf71]|\ud83c[\udd00-\udd0c]|\ud809[\udc00-\udc6e]|\ud802[\udc58-\udc5f\udc79-\udc7f\udca7-\udcaf\udcfb-\udcff\udd16-\udd1b\uddbc\uddbd\uddc0-\uddcf\uddd2-\uddff\ude40-\ude47\ude7d\ude7e\ude9d-\ude9f\udeeb-\udeef\udf58-\udf5f\udf78-\udf7f\udfa9-\udfaf]|\ud805[\udcd0-\udcd9\ude50-\ude59\udec0-\udec9\udf30-\udf3b]"},{name:"Nd",alias:"Decimal_Number",bmp:"0-9------------------------------------",astral:"\ud801[\udca0-\udca9]|\ud835[\udfce-\udfff]|\ud805[\udcd0-\udcd9\ude50-\ude59\udec0-\udec9\udf30-\udf39]|\ud806[\udce0-\udce9]|\ud804[\udc66-\udc6f\udcf0-\udcf9\udd36-\udd3f\uddd0-\uddd9\udef0-\udef9]|\ud81a[\ude60-\ude69\udf50-\udf59]"},{name:"Nl",alias:"Letter_Number",bmp:"------",astral:"\ud809[\udc00-\udc6e]|\ud800[\udd40-\udd74\udf41\udf4a\udfd1-\udfd5]"},{name:"No",alias:"Other_Number",bmp:"----------------------",astral:"\ud804[\udc52-\udc65\udde1-\uddf4]|\ud803[\udcfa-\udcff\ude60-\ude7e]|\ud83c[\udd00-\udd0c]|\ud806[\udcea-\udcf2]|\ud83a[\udcc7-\udccf]|\ud802[\udc58-\udc5f\udc79-\udc7f\udca7-\udcaf\udcfb-\udcff\udd16-\udd1b\uddbc\uddbd\uddc0-\uddcf\uddd2-\uddff\ude40-\ude47\ude7d\ude7e\ude9d-\ude9f\udeeb-\udeef\udf58-\udf5f\udf78-\udf7f\udfa9-\udfaf]|\ud805[\udf3a\udf3b]|\ud81a[\udf5b-\udf61]|\ud834[\udf60-\udf71]|\ud800[\udd07-\udd33\udd75-\udd78\udd8a\udd8b\udee1-\udefb\udf20-\udf23]"},{name:"P",alias:"Punctuation",bmp:"!-#%-\\x2A,-/:;\\x3F@\\x5B-\\x5D_\\x7B}-------------------------------------------------",astral:"\ud802[\udc57\udd1f\udd3f\ude50-\ude58\ude7f\udef0-\udef6\udf39-\udf3f\udf99-\udf9c]|\ud809[\udc70-\udc74]|\ud805[\udcc6\uddc1-\uddd7\ude41-\ude43\udf3c-\udf3e]|\ud836[\ude87-\ude8b]|||\ud804[\udc47-\udc4d\udcbb\udcbc\udcbe-\udcc1\udd40-\udd43\udd74\udd75\uddc5-\uddc9\uddcd\udddb\udddd-\udddf\ude38-\ude3d\udea9]|\ud800[\udd00-\udd02\udf9f\udfd0]|\ud81a[\ude6e\ude6f\udef5\udf37-\udf3b\udf44]"},{name:"Pc",alias:"Connector_Punctuation",bmp:"_-"},{name:"Pd",alias:"Dash_Punctuation",bmp:"\\x2D-"},{name:"Pe",alias:"Close_Punctuation",bmp:"\\x29\\x5D}"},{name:"Pf",alias:"Final_Punctuation",bmp:""},{name:"Pi",alias:"Initial_Punctuation",bmp:""},{name:"Po",alias:"Other_Punctuation",bmp:"!-#%-'\\x2A,\\x2E/:;\\x3F@\\x5C----------------------------------------------",astral:"\ud802[\udc57\udd1f\udd3f\ude50-\ude58\ude7f\udef0-\udef6\udf39-\udf3f\udf99-\udf9c]|\ud809[\udc70-\udc74]|\ud805[\udcc6\uddc1-\uddd7\ude41-\ude43\udf3c-\udf3e]|\ud836[\ude87-\ude8b]|||\ud804[\udc47-\udc4d\udcbb\udcbc\udcbe-\udcc1\udd40-\udd43\udd74\udd75\uddc5-\uddc9\uddcd\udddb\udddd-\udddf\ude38-\ude3d\udea9]|\ud800[\udd00-\udd02\udf9f\udfd0]|\ud81a[\ude6e\ude6f\udef5\udf37-\udf3b\udf44]"},{name:"Ps",alias:"Open_Punctuation",bmp:"\\x28\\x5B\\x7B"},{name:"S",alias:"Symbol",bmp:"\\x24\\x2B<->\\x5E`\\x7C~-------------------------------------------------------------------------",astral:"\ud83e[\udc00-\udc0b\udc10-\udc47\udc50-\udc59\udc60-\udc87\udc90-\udcad\udd10-\udd18\udd80-\udd84\uddc0]|\ud83c[\udc00-\udc2b\udc30-\udc93\udca0-\udcae\udcb1-\udcbf\udcc1-\udccf\udcd1-\udcf5\udd10-\udd2e\udd30-\udd6b\udd70-\udd9a\udde6-\ude02\ude10-\ude3a\ude40-\ude48\ude50\ude51\udf00-\udfff]|\ud83d[\udc00-\udd79\udd7b-\udda3\udda5-\uded0\udee0-\udeec\udef0-\udef3\udf00-\udf73\udf80-\udfd4]|\ud835[\udec1\udedb\udefb\udf15\udf35\udf4f\udf6f\udf89\udfa9\udfc3]|\ud800[\udd37-\udd3f\udd79-\udd89\udd8c\udd90-\udd9b\udda0\uddd0-\uddfc]|||\ud802[\udc77\udc78\udec8]|\ud81a[\udf3c-\udf3f\udf45]|\ud836[\udc00-\uddff\ude37-\ude3a\ude6d-\ude74\ude76-\ude83\ude85\ude86]|\ud834[\udc00-\udcf5\udd00-\udd26\udd29-\udd64\udd6a-\udd6c\udd83\udd84\udd8c-\udda9\uddae-\udde8\ude00-\ude41\ude45\udf00-\udf56]|\ud83b[\udef0\udef1]"},{name:"Sc",alias:"Currency_Symbol",bmp:"\\x24--"},{name:"Sk",alias:"Modifier_Symbol",bmp:"\\x5E`----------",astral:"\ud83c[\udffb-\udfff]"},{name:"Sm",alias:"Math_Symbol",bmp:"\\x2B<->\\x7C~---------------------",astral:"\ud83b[\udef0\udef1]|\ud835[\udec1\udedb\udefb\udf15\udf35\udf4f\udf6f\udf89\udfa9\udfc3]"},{name:"So",alias:"Other_Symbol",bmp:"-----------------------------------------------------------",astral:"\ud83e[\udc00-\udc0b\udc10-\udc47\udc50-\udc59\udc60-\udc87\udc90-\udcad\udd10-\udd18\udd80-\udd84\uddc0]|\ud83d[\udc00-\udd79\udd7b-\udda3\udda5-\uded0\udee0-\udeec\udef0-\udef3\udf00-\udf73\udf80-\udfd4]|\ud83c[\udc00-\udc2b\udc30-\udc93\udca0-\udcae\udcb1-\udcbf\udcc1-\udccf\udcd1-\udcf5\udd10-\udd2e\udd30-\udd6b\udd70-\udd9a\udde6-\ude02\ude10-\ude3a\ude40-\ude48\ude50\ude51\udf00-\udffa]|\ud800[\udd37-\udd3f\udd79-\udd89\udd8c\udd90-\udd9b\udda0\uddd0-\uddfc]|||\ud802[\udc77\udc78\udec8]|\ud81a[\udf3c-\udf3f\udf45]|\ud836[\udc00-\uddff\ude37-\ude3a\ude6d-\ude74\ude76-\ude83\ude85\ude86]|\ud834[\udc00-\udcf5\udd00-\udd26\udd29-\udd64\udd6a-\udd6c\udd83\udd84\udd8c-\udda9\uddae-\udde8\ude00-\ude41\ude45\udf00-\udf56]"},{name:"Z",alias:"Separator",bmp:" -\u2028\u2029"},{name:"Zl",alias:"Line_Separator",bmp:"\u2028"},{name:"Zp",alias:"Paragraph_Separator",bmp:"\u2029"},{name:"Zs",alias:"Space_Separator",bmp:" -"}])}},function(t,e){
/*!
	 * XRegExp Unicode Properties 3.1.1
	 * <xregexp.com>
	 * Steven Levithan (c) 2012-2016 MIT License
	 * Unicode data by Mathias Bynens <mathiasbynens.be>
	 */
t.exports=function(t){"use strict";if(!t.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Properties");var e=[{name:"ASCII",bmp:"\0-"},{name:"Alphabetic",bmp:"A-Za-z-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",astral:"\ud86e[\udc00-\udc1d\udc20-\udfff]|\ud804[\udc00-\udc45\udc82-\udcb8\udcd0-\udce8\udd00-\udd32\udd50-\udd72\udd76\udd80-\uddbf\uddc1-\uddc4\uddda\udddc\ude00-\ude11\ude13-\ude34\ude37\ude80-\ude86\ude88\ude8a-\ude8d\ude8f-\ude9d\ude9f-\udea8\udeb0-\udee8\udf00-\udf03\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3d-\udf44\udf47\udf48\udf4b\udf4c\udf50\udf57\udf5d-\udf63]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|\ud803[\udc00-\udc48\udc80-\udcb2\udcc0-\udcf2]|\ud83a[\udc00-\udcc4]|\ud81a[\udc00-\ude38\ude40-\ude5e\uded0-\udeed\udf00-\udf36\udf40-\udf43\udf63-\udf77\udf7d-\udf8f]|\ud801[\udc00-\udc9d\udd00-\udd27\udd30-\udd63\ude00-\udf36\udf40-\udf55\udf60-\udf67]|\ud83c[\udd30-\udd49\udd50-\udd69\udd70-\udd89]|\ud80d[\udc00-\udc2e]|\ud87e[\udc00-\ude1d]|[\ud80c\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872][\udc00-\udfff]|\ud835[\udc00-\udc54\udc56-\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd1e-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd52-\udea5\udea8-\udec0\udec2-\udeda\udedc-\udefa\udefc-\udf14\udf16-\udf34\udf36-\udf4e\udf50-\udf6e\udf70-\udf88\udf8a-\udfa8\udfaa-\udfc2\udfc4-\udfcb]|\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99\udc9e]|\ud808[\udc00-\udf99]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb]|\ud805[\udc80-\udcc1\udcc4\udcc5\udcc7\udd80-\uddb5\uddb8-\uddbe\uddd8-\udddd\ude00-\ude3e\ude40\ude44\ude80-\udeb5\udf00-\udf19\udf1d-\udf2a]|\ud809[\udc00-\udc6e\udc80-\udd43]|\ud806[\udca0-\udcdf\udcff\udec0-\udef8]|\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa\udd40-\udd74\ude80-\ude9c\udea0-\uded0\udf00-\udf1f\udf30-\udf4a\udf50-\udf7a\udf80-\udf9d\udfa0-\udfc3\udfc8-\udfcf\udfd1-\udfd5]|\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f-\udc55\udc60-\udc76\udc80-\udc9e\udce0-\udcf2\udcf4\udcf5\udd00-\udd15\udd20-\udd39\udd80-\uddb7\uddbe\uddbf\ude00-\ude03\ude05\ude06\ude0c-\ude13\ude15-\ude17\ude19-\ude33\ude60-\ude7c\ude80-\ude9c\udec0-\udec7\udec9-\udee4\udf00-\udf35\udf40-\udf55\udf60-\udf72\udf80-\udf91]|\ud811[\udc00-\ude46]|\ud82c[\udc00\udc01]|\ud81b[\udf00-\udf44\udf50-\udf7e\udf93-\udf9f]|\ud873[\udc00-\udea1]"},{name:"Any",isBmpLast:!0,bmp:"\0-",astral:"[\ud800-\udbff][\udc00-\udfff]"},{name:"Default_Ignorable_Code_Point",bmp:"-----\ufeff-",astral:"[\udb40-\udb43][\udc00-\udfff]|\ud834[\udd73-\udd7a]|\ud82f[\udca0-\udca3]"},{name:"Lowercase",bmp:"a-z----------------------------------------------------",astral:"\ud803[\udcc0-\udcf2]|\ud835[\udc1a-\udc33\udc4e-\udc54\udc56-\udc67\udc82-\udc9b\udcb6-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udccf\udcea-\udd03\udd1e-\udd37\udd52-\udd6b\udd86-\udd9f\uddba-\uddd3\uddee-\ude07\ude22-\ude3b\ude56-\ude6f\ude8a-\udea5\udec2-\udeda\udedc-\udee1\udefc-\udf14\udf16-\udf1b\udf36-\udf4e\udf50-\udf55\udf70-\udf88\udf8a-\udf8f\udfaa-\udfc2\udfc4-\udfc9\udfcb]|\ud801[\udc28-\udc4f]|\ud806[\udcc0-\udcdf]"},{name:"Noncharacter_Code_Point",bmp:"-",astral:"[\udb3f\udb7f\udbbf\udbff\ud83f\ud87f\ud8bf\udaff\ud97f\ud9bf\ud9ff\uda3f\ud8ff\udabf\uda7f\ud93f][\udffe\udfff]"},{name:"Uppercase",bmp:"A-Z-----------------------------------------",astral:"\ud806[\udca0-\udcbf]|\ud803[\udc80-\udcb2]|\ud835[\udc00-\udc19\udc34-\udc4d\udc68-\udc81\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb5\udcd0-\udce9\udd04\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd38\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd6c-\udd85\udda0-\uddb9\uddd4-\udded\ude08-\ude21\ude3c-\ude55\ude70-\ude89\udea8-\udec0\udee2-\udefa\udf1c-\udf34\udf56-\udf6e\udf90-\udfa8\udfca]|\ud801[\udc00-\udc27]|\ud83c[\udd30-\udd49\udd50-\udd69\udd70-\udd89]"},{name:"White_Space",bmp:"\t-\r -\u2028\u2029"}];e.push({name:"Assigned",inverseOf:"Cn"}),t.addUnicodeData(e)}},function(t,e){
/*!
	 * XRegExp Unicode Scripts 3.1.1
	 * <xregexp.com>
	 * Steven Levithan (c) 2010-2016 MIT License
	 * Unicode data by Mathias Bynens <mathiasbynens.be>
	 */
t.exports=function(t){"use strict";if(!t.addUnicodeData)throw new ReferenceError("Unicode Base must be loaded before Unicode Scripts");t.addUnicodeData([{name:"Ahom",astral:"\ud805[\udf00-\udf19\udf1d-\udf2b\udf30-\udf3f]"},{name:"Anatolian_Hieroglyphs",astral:"\ud811[\udc00-\ude46]"},{name:"Arabic",bmp:"------------------",astral:"\ud803[\ude60-\ude7e]|\ud83b[\ude00-\ude03\ude05-\ude1f\ude21\ude22\ude24\ude27\ude29-\ude32\ude34-\ude37\ude39\ude3b\ude42\ude47\ude49\ude4b\ude4d-\ude4f\ude51\ude52\ude54\ude57\ude59\ude5b\ude5d\ude5f\ude61\ude62\ude64\ude67-\ude6a\ude6c-\ude72\ude74-\ude77\ude79-\ude7c\ude7e\ude80-\ude89\ude8b-\ude9b\udea1-\udea3\udea5-\udea9\udeab-\udebb\udef0\udef1]"},{name:"Armenian",bmp:"-----"},{name:"Avestan",astral:"\ud802[\udf00-\udf35\udf39-\udf3f]"},{name:"Balinese",bmp:"--"},{name:"Bamum",bmp:"-",astral:"\ud81a[\udc00-\ude38]"},{name:"Bassa_Vah",astral:"\ud81a[\uded0-\udeed\udef0-\udef5]"},{name:"Batak",bmp:"--"},{name:"Bengali",bmp:"---------"},{name:"Bopomofo",bmp:"--"},{name:"Brahmi",astral:"\ud804[\udc00-\udc4d\udc52-\udc6f\udc7f]"},{name:"Braille",bmp:"-"},{name:"Buginese",bmp:"-"},{name:"Buhid",bmp:"-"},{name:"Canadian_Aboriginal",bmp:"--"},{name:"Carian",astral:"\ud800[\udea0-\uded0]"},{name:"Caucasian_Albanian",astral:"\ud801[\udd30-\udd63\udd6f]"},{name:"Chakma",astral:"\ud804[\udd00-\udd34\udd36-\udd43]"},{name:"Cham",bmp:"----"},{name:"Cherokee",bmp:"---"},{name:"Common",bmp:"\0-@\\x5B-`\\x7B---------------------------------------------------\ufeff------",astral:"\ud83e[\udc00-\udc0b\udc10-\udc47\udc50-\udc59\udc60-\udc87\udc90-\udcad\udd10-\udd18\udd80-\udd84\uddc0]|\ud82f[\udca0-\udca3]|\ud835[\udc00-\udc54\udc56-\udc9c\udc9e\udc9f\udca2\udca5\udca6\udca9-\udcac\udcae-\udcb9\udcbb\udcbd-\udcc3\udcc5-\udd05\udd07-\udd0a\udd0d-\udd14\udd16-\udd1c\udd1e-\udd39\udd3b-\udd3e\udd40-\udd44\udd46\udd4a-\udd50\udd52-\udea5\udea8-\udfcb\udfce-\udfff]|\udb40[\udc01\udc20-\udc7f]|\ud83d[\udc00-\udd79\udd7b-\udda3\udda5-\uded0\udee0-\udeec\udef0-\udef3\udf00-\udf73\udf80-\udfd4]|\ud800[\udd00-\udd02\udd07-\udd33\udd37-\udd3f\udd90-\udd9b\uddd0-\uddfc\udee1-\udefb]|\ud834[\udc00-\udcf5\udd00-\udd26\udd29-\udd66\udd6a-\udd7a\udd83\udd84\udd8c-\udda9\uddae-\udde8\udf00-\udf56\udf60-\udf71]|\ud83c[\udc00-\udc2b\udc30-\udc93\udca0-\udcae\udcb1-\udcbf\udcc1-\udccf\udcd1-\udcf5\udd00-\udd0c\udd10-\udd2e\udd30-\udd6b\udd70-\udd9a\udde6-\uddff\ude01\ude02\ude10-\ude3a\ude40-\ude48\ude50\ude51\udf00-\udfff]"},{name:"Coptic",bmp:"---"},{name:"Cuneiform",astral:"\ud809[\udc00-\udc6e\udc70-\udc74\udc80-\udd43]|\ud808[\udc00-\udf99]"},{name:"Cypriot",astral:"\ud802[\udc00-\udc05\udc08\udc0a-\udc35\udc37\udc38\udc3c\udc3f]"},{name:"Cyrillic",bmp:"----"},{name:"Deseret",astral:"\ud801[\udc00-\udc4f]"},{name:"Devanagari",bmp:"----"},{name:"Duployan",astral:"\ud82f[\udc00-\udc6a\udc70-\udc7c\udc80-\udc88\udc90-\udc99\udc9c-\udc9f]"},{name:"Egyptian_Hieroglyphs",astral:"\ud80c[\udc00-\udfff]|\ud80d[\udc00-\udc2e]"},{name:"Elbasan",astral:"\ud801[\udd00-\udd27]"},{name:"Ethiopic",bmp:"------------------------------"},{name:"Georgian",bmp:"----"},{name:"Glagolitic",bmp:"--"},{name:"Gothic",astral:"\ud800[\udf30-\udf4a]"},{name:"Grantha",astral:"\ud804[\udf00-\udf03\udf05-\udf0c\udf0f\udf10\udf13-\udf28\udf2a-\udf30\udf32\udf33\udf35-\udf39\udf3c-\udf44\udf47\udf48\udf4b-\udf4d\udf50\udf57\udf5d-\udf63\udf66-\udf6c\udf70-\udf74]"},{name:"Greek",bmp:"-----------------------",astral:"\ud800[\udd40-\udd8c\udda0]|\ud834[\ude00-\ude45]"},{name:"Gujarati",bmp:"-----------"},{name:"Gurmukhi",bmp:"--------"},{name:"Han",bmp:"---------",astral:"\ud86e[\udc00-\udc1d\udc20-\udfff]|[\ud840-\ud868\ud86a-\ud86c\ud86f-\ud872][\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud87e[\udc00-\ude1d]|\ud869[\udc00-\uded6\udf00-\udfff]|\ud873[\udc00-\udea1]"},{name:"Hangul",bmp:"-------------"},{name:"Hanunoo",bmp:"-"},{name:"Hatran",astral:"\ud802[\udce0-\udcf2\udcf4\udcf5\udcfb-\udcff]"},{name:"Hebrew",bmp:"------"},{name:"Hiragana",bmp:"--",astral:"|"},{name:"Imperial_Aramaic",astral:"\ud802[\udc40-\udc55\udc57-\udc5f]"},{name:"Inherited",bmp:"------------",astral:"\ud834[\udd67-\udd69\udd7b-\udd82\udd85-\udd8b\uddaa-\uddad]|\ud800[\uddfd\udee0]|\udb40[\udd00-\uddef]"},{name:"Inscriptional_Pahlavi",astral:"\ud802[\udf60-\udf72\udf78-\udf7f]"},{name:"Inscriptional_Parthian",astral:"\ud802[\udf40-\udf55\udf58-\udf5f]"},{name:"Javanese",bmp:"--"},{name:"Kaithi",astral:"\ud804[\udc80-\udcc1]"},{name:"Kannada",bmp:"-----------"},{name:"Katakana",bmp:"-------",astral:""},{name:"Kayah_Li",bmp:"-"},{name:"Kharoshthi",astral:"\ud802[\ude00-\ude03\ude05\ude06\ude0c-\ude13\ude15-\ude17\ude19-\ude33\ude38-\ude3a\ude3f-\ude47\ude50-\ude58]"},{name:"Khmer",bmp:"----"},{name:"Khojki",astral:"\ud804[\ude00-\ude11\ude13-\ude3d]"},{name:"Khudawadi",astral:"\ud804[\udeb0-\udeea\udef0-\udef9]"},{name:"Lao",bmp:"---------"},{name:"Latin",bmp:"A-Za-z----------------------"},{name:"Lepcha",bmp:"---"},{name:"Limbu",bmp:"----"},{name:"Linear_A",astral:"\ud801[\ude00-\udf36\udf40-\udf55\udf60-\udf67]"},{name:"Linear_B",astral:"\ud800[\udc00-\udc0b\udc0d-\udc26\udc28-\udc3a\udc3c\udc3d\udc3f-\udc4d\udc50-\udc5d\udc80-\udcfa]"},{name:"Lisu",bmp:"-"},{name:"Lycian",astral:"\ud800[\ude80-\ude9c]"},{name:"Lydian",astral:"\ud802[\udd20-\udd39\udd3f]"},{name:"Mahajani",astral:"\ud804[\udd50-\udd76]"},{name:"Malayalam",bmp:"----------"},{name:"Mandaic",bmp:"-"},{name:"Manichaean",astral:"\ud802[\udec0-\udee6\udeeb-\udef6]"},{name:"Meetei_Mayek",bmp:"---"},{name:"Mende_Kikakui",astral:"\ud83a[\udc00-\udcc4\udcc7-\udcd6]"},{name:"Meroitic_Cursive",astral:"\ud802[\udda0-\uddb7\uddbc-\uddcf\uddd2-\uddff]"},{name:"Meroitic_Hieroglyphs",astral:"\ud802[\udd80-\udd9f]"},{name:"Miao",astral:"\ud81b[\udf00-\udf44\udf50-\udf7e\udf8f-\udf9f]"},{name:"Modi",astral:"\ud805[\ude00-\ude44\ude50-\ude59]"},{name:"Mongolian",bmp:"----"},{name:"Mro",astral:"\ud81a[\ude40-\ude5e\ude60-\ude69\ude6e\ude6f]"},{name:"Multani",astral:"\ud804[\ude80-\ude86\ude88\ude8a-\ude8d\ude8f-\ude9d\ude9f-\udea9]"},{name:"Myanmar",bmp:"---"},{name:"Nabataean",astral:"\ud802[\udc80-\udc9e\udca7-\udcaf]"},{name:"New_Tai_Lue",bmp:"---"},{name:"Nko",bmp:"-"},{name:"Ogham",bmp:"-"},{name:"Ol_Chiki",bmp:"-"},{name:"Old_Hungarian",astral:"\ud803[\udc80-\udcb2\udcc0-\udcf2\udcfa-\udcff]"},{name:"Old_Italic",astral:"\ud800[\udf00-\udf23]"},{name:"Old_North_Arabian",astral:"\ud802[\ude80-\ude9f]"},{name:"Old_Permic",astral:"\ud800[\udf50-\udf7a]"},{name:"Old_Persian",astral:"\ud800[\udfa0-\udfc3\udfc8-\udfd5]"},{name:"Old_South_Arabian",astral:"\ud802[\ude60-\ude7f]"},{name:"Old_Turkic",astral:"\ud803[\udc00-\udc48]"},{name:"Oriya",bmp:"---------"},{name:"Osmanya",astral:"\ud801[\udc80-\udc9d\udca0-\udca9]"},{name:"Pahawh_Hmong",astral:"\ud81a[\udf00-\udf45\udf50-\udf59\udf5b-\udf61\udf63-\udf77\udf7d-\udf8f]"},{name:"Palmyrene",astral:"\ud802[\udc60-\udc7f]"},{name:"Pau_Cin_Hau",astral:"\ud806[\udec0-\udef8]"},{name:"Phags_Pa",bmp:"-"},{name:"Phoenician",astral:"\ud802[\udd00-\udd1b\udd1f]"},{name:"Psalter_Pahlavi",astral:"\ud802[\udf80-\udf91\udf99-\udf9c\udfa9-\udfaf]"},{name:"Rejang",bmp:"-"},{name:"Runic",bmp:"--"},{name:"Samaritan",bmp:"--"},{name:"Saurashtra",bmp:"--"},{name:"Sharada",astral:"\ud804[\udd80-\uddcd\uddd0-\udddf]"},{name:"Shavian",astral:"\ud801[\udc50-\udc7f]"},{name:"Siddham",astral:"\ud805[\udd80-\uddb5\uddb8-\udddd]"},{name:"SignWriting",astral:"\ud836[\udc00-\ude8b\ude9b-\ude9f\udea1-\udeaf]"},{name:"Sinhala",bmp:"--------",astral:"\ud804[\udde1-\uddf4]"},{name:"Sora_Sompeng",astral:"\ud804[\udcd0-\udce8\udcf0-\udcf9]"},{name:"Sundanese",bmp:"--"},{name:"Syloti_Nagri",bmp:"-"},{name:"Syriac",bmp:"---"},{name:"Tagalog",bmp:"--"},{name:"Tagbanwa",bmp:"--"},{name:"Tai_Le",bmp:"--"},{name:"Tai_Tham",bmp:"-----"},{name:"Tai_Viet",bmp:"--"},{name:"Takri",astral:"\ud805[\ude80-\udeb7\udec0-\udec9]"},{name:"Tamil",bmp:"---------"},{name:"Telugu",bmp:"------------"},{name:"Thaana",bmp:"-"},{name:"Thai",bmp:"--"},{name:"Tibetan",bmp:"------"},{name:"Tifinagh",bmp:"-"},{name:"Tirhuta",astral:"\ud805[\udc80-\udcc7\udcd0-\udcd9]"},{name:"Ugaritic",astral:"\ud800[\udf80-\udf9d\udf9f]"},{name:"Vai",bmp:"-"},{name:"Warang_Citi",astral:"\ud806[\udca0-\udcf2\udcff]"},{name:"Yi",bmp:"--"}])}},function(t,e,n){(function(e,i,a){n(40),n(54);var o=n(55),s=n(57),d=n(58),r=n(36),u=e.View.extend({events:{"keyup [data-field-name=addressSearch]":"keypress","keydown [data-field-name=addressSearch]":"keydown","click [data-field-name=addressSearch]":"anchorAndShowCloseBtn","click .suggest-result .suggestion":"clickOnSuggestion","click .address-bg-screen":"reset","click button.manual-address-entry":"clickManualEntryBtn","click span.manual-address-entry":"clickManualEntryOnDropdown","click .icon-close":"clearAndReset","submit #address-form":"handleFormSubmit",'change .delivery-form input[type="text"][name^="delivery-"]':"addressFieldChange"},initialize:function(t){this.counter=new r,this.app=t.app,this.stringLocalizer=t.stringLocalizer,this.$input=this.$("[data-field-name=addressSearch]"),this.suggestionsModel=new s,this.chosenAddressModel=new d,this.autoCompleteModel=new o({},{stringLocalizer:t.stringLocalizer}),this._setupCSMNames(),this._setupListeners(),this.authToken=this.$("input[name=experianToken]").val(),this._screen=this.$el.append("<div class='address-bg-screen'></div>"),this.render()},keypress:function(t){27==t.keyCode?this.clearAndReset():38==t.keyCode?this._moveToOption(-1):40==t.keyCode?this._moveToOption(1):this.suggestionsModel.set("keyword",this.$input.val())},keydown:function(t){13==t.keyCode&&this._clickOnSelectedOption(t)},textChange:function(){var t=this.suggestionsModel.get("keyword");if(this.latestExperianSearchRequest&&this.latestExperianSearchRequest.abort(),t.trim().length>0){this._logStartCall(this.experianSearchScope),this.$closeIcon.show();var e={"auth-token":this.authToken,query:t,country:i("#address-form").data("country-code")};this.latestExperianSearchRequest=this.suggestionsModel.doWrappedFetch(e)}else this.suggestionsModel.set("results",null),this.reset()},handleSuggestionsResponse:function(){if(this.suggestionsModel.isStatusSuccess()&&(this._manualAddressEntryFontWeightNormal(),this.counter.count(this.experianSuccessSearchAddress),this._logEndCall(this.experianSearchScope),this.showSuggestions()),this.suggestionsModel.isStatusFailureGeneric()){var t=this.suggestionsModel.get("responseStatus");this.counter.count(this.experianSearchError);var e=t?"."+t:".unknown";this.counter.count(this.experianSearchError+e),this._showErrorMessage(this.addressFinderUnavailableErrorMsg)}this.suggestionsModel.isStatusFailureTimeout()&&(this.counter.count(this.experianSearchTimeout),this._showErrorMessage(this.addressFinderUnavailableErrorMsg))},render:function(){var t=this.$("[data-field-name=addressSearch]");this.$suggestresult=i("<div class='suggest-result'></div>"),this.$result=i("<div class='result-wrap no-result'></div>"),this.$suggestresult.appendTo(this.$result),this.$result.insertAfter(t.parent()),this.$closeIcon=i("<i class='icon-close'/>"),this.$closeIcon.insertAfter(t),this._appendHelpText(),this._appendEnterManualAddress()},reset:function(){this.$suggestresult.empty(),this.$options&&(this.$options.not(".manual-address-entry").empty(),this._manualAddressEntryFontWeightNormal()),this._clearSelectedOption(),this._hideScreen(),this.$result.addClass("no-result"),0==this.$input.val().length&&this.$closeIcon.hide()},clearAndReset:function(){this.counter.count(this.clearedAddress),this.suggestionsModel.set("keyword",""),this.$input.val(""),this.reset(),this.$input.focus()},handleFormSubmit:function(t){if(!this.$result.hasClass("no-result"))return!1},showSuggestions:function(){this.$suggestresult.empty(),this._clearSelectedOption(),this._showHelpText();var t=this.suggestionsModel.get("results"),e=this.suggestionsModel.get("call_data"),n=e?e.query:"";t&&(1==t.length&&void 0!==t[0].Error?(this.counter.count(this.experianSearchResultsError),this._showErrorMessage(this.addressFinderUnavailableErrorMsg)):(0==t.length&&n.length>=5?(this.counter.count("experianNoResults"),this._showErrorMessage(this.noResultsErrorMsg)):(this.$result.removeClass("no-result"),this._showScreen(),a.each(t,function(t,e){var n=i("<span class='suggestion suggest-word'></span>").attr("data-format",t.format).text(" "+t.suggestion);this.$suggestresult.append(n),i(n).dotdotdot({height:50,ellipsis:"...",wrap:"word",tolerance:0})},this)),this._optionsChanged()))},clickOnSuggestion:function(t){var e=i(t.target).html().trim();this.reset(),this._showLoadingIndicator();var n=i(t.target).data("format");this.counter.count(this.userClickedOnExperianSuggestion),this._logStartCall(this.experianCaputureScope);var a={"auth-token":this.authToken,call_url:n,selected_address:e};this.chosenAddressModel.doWrappedFetch(a),t.preventDefault()},handleChosenAddressResponse:function(){if(this.chosenAddressModel.isStatusSuccess()){var t=this.chosenAddressModel.get("address");if(t&&t.length>0){var e=this.chosenAddressModel.get("selected_address");this._mapFields(t),this.$input.val(e),this.counter.count(this.experianSuccessCaptureAddress),this.anchorOnSearchField()}}this.chosenAddressModel.isStatusFailureGeneric()&&(this.counter.count(this.experianFormatError),this._showErrorMessage(this.addressFinderUnavailableErrorMsg),this._hideLoadingIndicator()),this._logEndCall(this.experianCaputureScope)},clickManualEntryOnDropdown:function(){this.counter.count(this.manualAddressEntryOnDropdown),this.manualEntry()},clickManualEntryBtn:function(){this.counter.count(this.manualAddressEntryBtn),this.manualEntry()},manualEntry:function(){this.suggestionsModel.set("keyword",""),this.$input.val(""),this.reset(),this.anchorOnSearchField(),this._displayDeliveryForm(),i("#your-delivery-address").hide(),i("#enter-your-address").show()},anchorOnSearchField:function(){if(!app.isMobile()){var t=i("#delivery-addressSearch label");i("html,body").animate({scrollTop:i(t.get()).offset().top-10},"slow")}},anchorAndShowCloseBtn:function(t){this.anchorOnSearchField(),this.$input.val().length>0?this.$closeIcon.show():this.$closeIcon.hide(),this.showSuggestions(),t.preventDefault(),t.stopPropagation()},_hideHelpText:function(){i(".suggestion.suggest-word.help-text").hide()},_showHelpText:function(){i(".suggestion.suggest-word.help-text").show()},handleAutoCompleteResponse:function(){if(this.suggestionsModel.isStatusSuccess()){var t=this.autoCompleteModel.result;this.autocompleteMappingResponse=t,this._displayDeliveryForm(),a.each(Object.keys(t),function(e){var n=i('[name="delivery-'+e+'"]');n.val(t[e]),n.blur()}),i("#your-delivery-address").show(),i("#enter-your-address").hide(),this._hideLoadingIndicator(),this._logEndCall(self.kerouacMapScope)}this.suggestionsModel.isStatusFailureGeneric()&&(this.counter.count(self.kerouacMappingError),this._showErrorMessage(self.addressFinderUnavailableErrorMsg),this._hideLoadingIndicator())},_displayDeliveryForm:function(){var t=i(".delivery-form");t.removeClass("delivery-form-hidden"),t.find("input").removeAttr("autocomplete"),t.find("input[name='delivery-addressLine1']").attr("autocomplete","street-address"),i("button.manual-address-entry").hide(),this._resetAddressFields()},_mapFields:function(t){t.push({deliveryCountry:i("#deliveryCountryDropdown").val()});var e={};a.each(t,function(t){i.extend(e,t)},this),this._logStartCall(this.kerouacMapScope),this.autoCompleteModel.doWrappedFormPost(e,{})},_showLoadingIndicator:function(){i(".address-search-loading").removeClass("hidden")},_hideLoadingIndicator:function(){i(".address-search-loading").addClass("hidden")},_optionsChanged:function(){this.$options=this.$el.find(".suggest-result span, .suggestion-error.manual-address-entry"),this.$selectedOption=null},_moveToOption:function(t){if((!(t<0)||this.$selectedOption)&&(this.$selectedOption&&this.$selectedOption.removeClass("selected"),this.$options)){var e=0;this.$selectedOption&&(e=this.$options.index(this.$selectedOption)+t),e<0?this._clearSelectedOption():e>=this.$options.size()?this._selectOption(i(this.$options.get(this.$options.size()-1))):this._selectOption(i(this.$options.get(e)))}},_clickOnSelectedOption:function(t){this.$selectedOption&&this.$selectedOption.click(),t.preventDefault(),t.stopPropagation()},_selectOption:function(t){this.$selectedOption=t,this.$selectedOption.addClass("selected");var e=this.$suggestresult.offset().top,n=this.$suggestresult.offset().top+this.$suggestresult.outerHeight(),i=this.$suggestresult.scrollTop(),a=this.$selectedOption.offset().top,o=this.$selectedOption.offset().top+this.$selectedOption.outerHeight(),s=this.$selectedOption.outerHeight();o+s>n?this.$suggestresult.scrollTop(i+s):a-s<e&&this.$suggestresult.scrollTop(i-s)},_clearSelectedOption:function(){this.$selectedOption&&(this.$selectedOption.removeClass("selected"),this.$selectedOption=null)},_showErrorMessage:function(t){this._hideHelpText(),this.$suggestresult.empty();var e=i("<span class='suggestion-error'>"+t+"</span>");this.$suggestresult.append(e),this.$result.removeClass("no-result"),this._showScreen(),this._manualAddressEntryFontWeightBold()},_manualAddressEntryFontWeightBold:function(){i(".suggestion-error.manual-address-entry").addClass("bold-text")},_manualAddressEntryFontWeightNormal:function(){i(".suggestion-error.manual-address-entry").removeClass("bold-text")},_appendEnterManualAddress:function(){var t="<span class='suggestion-error manual-address-entry'>"+this.stringLocalizer.localizeString("bd_js_enter_address_manually","Enter address manually")+"</span>";this.$result.append(t)},_appendHelpText:function(){var t=this.stringLocalizer.localizeString("bd_js_keep_typing_to_refine_search_results","Keep typing to refine the search results"),e=i("<span class='suggestion suggest-word help-text'>"+t+"</span>");this.$result.prepend(e)},_resetAddressFields:function(){i(".delivery-form input").val("")},_logStartCall:function(t){window.uet&&(uet("tc",t,{wb:1}),ues("t0",t,new Date),ues("ctb",t,"1"))},_logEndCall:function(t){window.uex&&(uet("be",t),uex("ld",t,{wb:1}))},_showScreen:function(){this.$(".address-bg-screen").hasClass("active")||this.$(".address-bg-screen").addClass("active")},_hideScreen:function(){this.$(".address-bg-screen").hasClass("active")&&this.$(".address-bg-screen").removeClass("active")},_setupCSMNames:function(){this.experianSearchScope="experianSearchAddress",this.experianCaputureScope="experianCaptureAddress",this.kerouacMapScope="kerouacMapAddress",this.experianSuccessSearchAddress="experianSuccessSearchAddress",this.experianSuccessCaptureAddress="experianSuccessCaptureAddress",this.experianSearchError="experianSearchError",this.experianFormatError="experianFormatError",this.experianSearchResultsError="experianSearchResultsError",this.experianSearchTimeout="experianSearchTimeout",this.userClickedOnExperianSuggestion="userClickedOnExperianSuggestion",this.kerouacMappingError="kerouacMappingError",this.manualAddressEntryOnDropdown="manualAddressEntryOnDropdown",this.manualAddressEntryBtn="manualAddressEntryBtn",this.clearedAddress="clearedAddress",this.addressFinderUnavailableErrorMsg=this.stringLocalizer.localizeString("bd_js_unable_get_address_enter_manually","Sorry, we are unable to get the address. Please enter manually:"),this.noResultsErrorMsg=this.stringLocalizer.localizeString("bd_js_could_not_find_address_try_again","Sorry, we couldn't find the address. Please try again")},_setupListeners:function(){this.listenTo(this.suggestionsModel,"change:keyword",a.throttle(this.textChange,500)),this.listenTo(this.suggestionsModel,"change:call_status",this.handleSuggestionsResponse),this.listenTo(this.chosenAddressModel,"change:call_status",this.handleChosenAddressResponse),this.listenTo(this.autoCompleteModel,"change:call_status",this.handleAutoCompleteResponse)},addressFieldChange:function(t){var e=i("[name=delivery-addressCode]");if(e&&e.length>0)if(null!=this.autocompleteMappingResponse){var n=t.currentTarget.name,a=t.currentTarget.value,o=n.replace("delivery-",""),s=this.autocompleteMappingResponse[o];if(s&&s==a){var d=this.autocompleteMappingResponse.addressCode;d&&e.val(d)}else e.val("")}else e.val("")}});t.exports=u}).call(e,n(1),n(2),n(3))},function(t,e){Object.keys=function(){"use strict";var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=n.length;return function(a){if("object"!=typeof a&&("function"!=typeof a||null===a))throw new TypeError("Object.keys called on non-object");var o,s,d=[];for(o in a)t.call(a,o)&&d.push(o);if(e)for(s=0;s<i;s++)t.call(a,n[s])&&d.push(n[s]);return d}}()},function(t,e,n){var i=n(56).extend({selected_address:null,initialize:function(t,e){this.constructor.__super__.initialize.apply(this,arguments),this.call_url=e.stringLocalizer.localizedLink("/checkout-autocomplete-mapping"),this.result=null},_prepareDataForCall:function(t){return this.result=null,t},_processSuccessResponse:function(t,e,n){return this.result=t,!0}});t.exports=i},function(t,e,n){(function(e,n,i){var a=e.Model.extend({call_url:"",call_status:null,call_data:null,model_options:null,_prepareDataForCall:function(t){return t},_addExtraCallOptions:function(t){return t},_handleSpecificError:function(t,e,n){return!1},_processSuccessResponse:function(t,e,n){return!0},doWrappedFetch:function(t){var e=this._setupWrappedCall(t);return this.fetch(e)},doWrappedFormPost:function(t,e){var a=n.extend({data:i.param(t),processData:!1,contentType:"application/x-www-form-urlencoded;charset=UTF-8"},e);return a=this._setupWrappedCall(a),this.sync("create",this,a)},_setupWrappedCall:function(t){this.set("call_data",this._prepareDataForCall(t)),this.set("call_status",this.CALL_IN_PROGRESS,{silent:!0});var e=this,i=n.extend({data:this.get("call_data"),success:function(t,n,i){e._handleCallSuccess(t,n,i)},error:function(t,n,i){e._handleCallError(t,n,i)}},t);return i=this._addExtraCallOptions(i)},isStatusSuccess:function(){return this.get("call_status")==this.CALL_SUCCESS},isStatusInProgress:function(){return this.get("call_status")==this.CALL_IN_PROGRESS},isStatusFailureGeneric:function(){return this.get("call_status")==this.CALL_FAILURE_GENERIC},isStatusFailureTimeout:function(){return this.get("call_status")==this.CALL_FAILURE_TIMEOUT},url:function(){return this.get("call_url")?this.get("call_url"):this.call_url},constructor:function(t){this.model_options=t,e.Model.apply(this,arguments)},initialize:function(t,e){e&&e.call_url&&(this.call_url=call_url),this.CALL_TIMEOUT_MILLISECONDS=5e3,this.CALL_SUCCESS=1,this.CALL_IN_PROGRESS=0,this.CALL_ABORT=-1,this.CALL_FAILURE_TIMEOUT=-2,this.CALL_FAILURE_GENERIC=-3},_handleCallError:function(t,e,n){this._handleSpecificError(t,e,n)||this.set("call_status",this.CALL_FAILURE_GENERIC),e&&e.status&&this.set("responseStatus",e.status)},_handleCallSuccess:function(t,e,n){this._processSuccessResponse(t,e,n),this.set("call_status",this.CALL_SUCCESS)}});t.exports=a}).call(e,n(1),n(3),n(2))},function(t,e,n){var i=n(56).extend({keyword:"",_prepareDataForCall:function(t){return t.take=20,this.set("call_url","https://api.edq.com/capture/address/v2/search"),t},_addExtraOptions:function(t){return t.timeout=this.CALL_TIMEOUT_MILLISECONDS,t},_handleSpecificError:function(t,e,n){var i=!1;return"abort"==e.statusText?(this.set("call_status",this.CALL_ABORT),i=!0):"timeout"==e.statusText&&(this.set("call_status",this.CALL_FAILURE_TIMEOUT),i=!0),i}});t.exports=i},function(t,e,n){n(43),n(54);var i=n(56).extend({selected_address:null,getDpid:function(t){var e=null,n=this.get("address");n&&n.length>0&&(e=n[n.length-1].deliveryPointId1);return e},_prepareDataForCall:function(t){return this.set("call_url",t.call_url),delete t.call_url,this.set("selected_address",t.selected_address),delete t.selected_address,t},_processSuccessResponse:function(t,e,n){var i=this.get("components"),a=this.get("address");return a&&a.length>0&&(i&&i.length>1&&i.forEach(function(t){"deliveryPointId1"==Object.keys(t)&&(a=a.concat(t))}),this.set("address",a)),!0}});t.exports=i},function(t,e,n){(function(e,i,a){n(60);var o=n(61),s=n(62),d=e.View.extend({_postdata:{testid:null,testtype:"js",ctime:null,mode:null,ppipe:null,ppal:null,screen:null,window:null},_submitted:!1,events:{"click .start-test":"startTest"},initialize:function(){this.action_url=this.$(".test-form").attr("action")+"?asJson=true",this._postdata.testid=this.$("#testid").val(),this._postdata.mode=document.compatMode,this._postdata.screen=window.screen.width+"w "+window.screen.height+"h "+window.screen.pixelDepth+"pp",this._postdata.window=window.screen.availWidth+"w "+window.screen.availHeight+"h";var t=this;i.each(navigator.plugins,function(e,n){t._postdata["pname"+n]=e.name,t._postdata["pfname"+n]=e.filename,t._postdata["pdesc"+n]=e.description,t._postdata["pver"+n]=""})},startTest:function(t){t.preventDefault(),a(t.currentTarget).addClass("loading"),a(t.currentTarget).html("Running tests...");var e=this;return this._testChase(function(t){e._postdata.ppipe=t,e.submitResults.apply(e)}),this._testPaypal(function(t){e._postdata.ppal=t,e.submitResults.apply(e)}),setTimeout(function(){null===e._postdata.ppipe&&(e._postdata.ppipe="Failed"),null===e._postdata.ppal&&(e._postdata.ppal="Failed"),e.submitResults.apply(e)},1e4),!1},showResults:function(t){this.$(".start-test").remove();var e=i.reduce(t,function(t,e){return t+o(e)},"<h2>Diagnostics results</h2>");i.all(t,function(t){return"Success"===t.r})&&(e=s()+e),this.$(".tech-test-results").html(e)},submitResults:function(){if(!1===this._submitted&&null!==this._postdata.ppipe&&null!==this._postdata.ppal){var t=this;this._submitted=!0,this._postdata.ctime=(new Date).getTime(),a.ajax({url:this.action_url,data:this._postdata,method:"POST",success:function(e){t.showResults.call(t,e.results)}})}},_testChase:function(t){var e=new Image;e.onerror=function(){t("Failed")},e.onload=function(){t("Loaded")},e.src="https://ppipe.net/hpp/resource/image/sprite.png?"+(new Date).getTime(),e.className="zero",this.el.appendChild(e)},_testPaypal:function(t){var e=new Image;e.onerror=function(){t("Failed")},e.onload=function(){t("Loaded")},e.className="zero",e.src="https://www.paypal.com/en_US/i/scr/scr_grayDotRepeatBg_3x1.gif?"+(new Date).getTime(),this.el.appendChild(e)}});t.exports=d}).call(e,n(1),n(3),n(2))},function(t,e){Array.prototype.reduce=function(t){if(void 0===this||null===this)throw new TypeError(this+"is not an object");if(!(t instanceof Function))throw new TypeError(t+" is not a function");var e,n=Object(this),i=(arguments[1],n instanceof String?n.split(""):n),a=Math.max(Math.min(i.length,9007199254740991),0)||0,o=-1;if(1 in arguments)e=arguments[1];else{for(;++o<a&&!(o in i););if(o>=a)throw new TypeError("Reduce of empty array with no initial value");e=i[o]}for(;++o<a;)o in i&&(e=t(e,i[o],o,n));return e}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="result-item">\n\t<h3>'+(null==(__t=t)?"":__t)+'</h3>\n\t<p class="'+(null==(__t=r.toLowerCase())?"":__t)+'">'+(null==(__t=r+(m.length>0?": ":"")+m)?"":__t)+"</p>\n</div>";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+="<h2>No issues found</h2>\n<p>All the tests passed. If you're still having issues please contact customer services for further help.</p>\n";return __p}},function(t,e,n){(function(e,i,a){n(60);var o=e.View.extend({ppipe:null,ppal:null,submitted:!1,events:{"click .start-test":"startTest","click .copy-to-clipboard":"copyToClipboard"},startTest:function(t){t.preventDefault(),i(t.currentTarget).addClass("loading"),i(t.currentTarget).html("Running tests...");var e=this;return this._testChase(function(t){e.ppipe=t,e.submitResults.apply(e)}),this._testPaypal(function(t){e.ppal=t,e.submitResults.apply(e)}),setTimeout(function(){null===e.ppipe&&(e.ppipe="Failed"),null===e.ppal&&(e.ppal="Failed"),e.submitResults.apply(e)},1e4),!1},submitResults:function(){if(!1===this.submitted&&null!==this.ppipe&&null!==this.ppal){this.submitted=!0;var t=[];t.push({testName:"Browser version",value:navigator.userAgent}),t.push({testName:"compatMode",value:document.compatMode}),t.push({testName:"Screen size and colour depth",value:window.screen.width+"w "+window.screen.height+"h "+window.screen.pixelDepth+"pp"}),t.push({testName:"Window size",value:window.screen.availWidth+"w "+window.screen.availHeight+"h"}),t.push({testName:"Installed browser plugins",value:a.pluck(navigator.plugins,"name").join(", ")}),t.push({testName:"Connectivity to payment provider",value:this.ppipe}),t.push({testName:"Connectivity to PayPal",value:this.ppal}),t.push({testName:"Local time",value:(new Date).getTime()}),this.$(".start-test").remove();var e=a.reduce(t,function(t,e){return t+e.testName+": "+e.value+"\n"},"");this.$(".tech-help-results").html(e),this.$(".btn.copy-to-clipboard").css("visibility","visible")}},_testChase:function(t){var e=new Image;e.onerror=function(){t("Failed")},e.onload=function(){t("Loaded")},e.src="https://ppipe.net/hpp/resource/image/sprite.png?"+(new Date).getTime(),e.className="zero",this.el.appendChild(e)},_testPaypal:function(t){var e=new Image;e.onerror=function(){t("Failed")},e.onload=function(){t("Loaded")},e.className="zero",e.src="https://www.paypal.com/en_US/i/scr/scr_grayDotRepeatBg_3x1.gif?"+(new Date).getTime(),this.el.appendChild(e)},copyToClipboard:function(){var t=this.$(".tech-help-results").html();this.copyTextToClipboard(t)},copyTextToClipboard:function(t){var e=document.createElement("textarea");document.body.appendChild(e),e.value=t,e.select(),document.execCommand("copy"),document.body.removeChild(e)}});t.exports=o}).call(e,n(1),n(2),n(3))},function(t,e,n){(function(e,n){var i=e.View.extend({tagName:"div",className:"jacket-img-lightbox",id:"jacket-img-lightbox-target",events:{"click .lightbox-close":"closeLightbox"},initialize:function(t){1==t.length&&(this.jacket_img=t,this.render())},render:function(){var t=n("<a>").addClass("lightbox-close").attr("href","#_").append(n("<i>").addClass("icon-close"));this.$el.append(t),this.$el.append(n("<div>").addClass("img-wrapper").append(this.jacket_img.clone())),n("body").append(this.$el)},closeLightbox:function(){n("body").removeClass("lightbox-show")}});t.exports=i}).call(e,n(1),n(2))}]);